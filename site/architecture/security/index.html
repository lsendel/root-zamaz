<!DOCTYPE html>
<html class="no-js" lang="en"> <head><meta charset="utf-8"/><meta content="width=device-width,initial-scale=1" name="viewport"/><meta content="Comprehensive documentation for the Zamaz Zero Trust Authentication Platform with Service Discovery, Istio Service Mesh, and Modern CI/CD" name="description"/><meta content="Zamaz Development Team" name="author"/><link href="https://zamaz.github.io/root-zamaz/architecture/security/" rel="canonical"/><link href="../overview/" rel="prev"/><link href="../zero-trust/" rel="next"/><link href="../../assets/images/favicon.png" rel="icon"/><meta content="mkdocs-1.5.3, mkdocs-material-9.5.3" name="generator"/><title>Security - Zamaz Zero Trust Platform</title><link href="../../assets/stylesheets/main.50c56a3b.min.css" rel="stylesheet"/><link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/><link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link href="../../css/timeago.css" rel="stylesheet"/><link href="../../assets/stylesheets/extra.css" rel="stylesheet"/><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script> <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></link></head> <body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr"> <input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/> <input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a class="md-skip" href="#security-architecture-guide"> Skip to content </a> </div> <div data-md-component="announce"> </div> <div data-md-color-scheme="default" data-md-component="outdated" hidden=""> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component="header"> <nav aria-label="Header" class="md-header__inner md-grid"> <a aria-label="Zamaz Zero Trust Platform" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Zamaz Zero Trust Platform"> <img alt="logo" src="../../assets/images/logo.svg"/> </a> <label class="md-header__button md-icon" for="__drawer"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> Zamaz Zero Trust Platform </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> Security </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"></path></svg> </label> <input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="blue" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="blue-grey" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> <input aria-label="Switch to system preference" class="md-option" data-md-color-accent="blue" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="blue-grey" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/> <label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to system preference"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"></path></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/> <label class="md-search__icon md-icon" for="__search"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg> </label> <nav aria-label="Search" class="md-search__options"> <a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="Share"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"></path></svg> </a> <button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg> </button> </nav> <div class="md-search__suggest" data-md-component="search-suggest"></div> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" data-md-scrollfix=""> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a class="md-source" data-md-component="source" href="https://github.com/zamaz/root-zamaz" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </div> <div class="md-source__repository"> zamaz/root-zamaz </div> </a> </div> </nav> <nav aria-label="Tabs" class="md-tabs" data-md-component="tabs"> <div class="md-grid"> <ul class="md-tabs__list"> <li class="md-tabs__item"> <a class="md-tabs__link" href="../.."> Home </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../getting-started/quick-start/"> Getting Started </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a class="md-tabs__link" href="../overview/"> Architecture </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../api/"> API Documentation </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../development/"> Development </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../deployment/README.md"> Deployment </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../security/README.md"> Security </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../troubleshooting/"> Operations </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../testing/e2e-testing-guide/"> Testing </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../sdk/go/"> SDKs </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../cli/"> CLI </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../examples/"> Examples </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../schema/"> Schema </a> </li> <li class="md-tabs__item"> <a class="md-tabs__link" href="../../reference/tags/"> Reference </a> </li> </ul> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a aria-label="Zamaz Zero Trust Platform" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Zamaz Zero Trust Platform"> <img alt="logo" src="../../assets/images/logo.svg"/> </a> Zamaz Zero Trust Platform </label> <div class="md-nav__source"> <a class="md-source" data-md-component="source" href="https://github.com/zamaz/root-zamaz" title="Go to repository"> <div class="md-source__icon md-icon"> <svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </div> <div class="md-source__repository"> zamaz/root-zamaz </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../.."> <span class="md-ellipsis"> Home </span> </a> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/> <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex=""> <span class="md-ellipsis"> Getting Started </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_2"> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../getting-started/quick-start/"> <span class="md-ellipsis"> Quick Start </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../getting-started/installation/"> <span class="md-ellipsis"> Installation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../getting-started/configuration/"> <span class="md-ellipsis"> Configuration </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input checked="" class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/> <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex=""> <span class="md-ellipsis"> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="true" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_3"> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../overview/"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/> <label class="md-nav__link md-nav__link--active" for="__toc"> <span class="md-ellipsis"> Security </span> <span class="md-nav__icon md-icon"></span> </label> <a class="md-nav__link md-nav__link--active" href="./"> <span class="md-ellipsis"> Security </span> </a> <nav aria-label="Page contents" class="md-nav md-nav--secondary"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Page contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="#zero-trust-security-model"> <span class="md-ellipsis"> üîê Zero Trust Security Model </span> </a> <nav aria-label="üîê Zero Trust Security Model" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#core-principles"> <span class="md-ellipsis"> Core Principles </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#security-layers"> <span class="md-ellipsis"> Security Layers </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#authentication-architecture"> <span class="md-ellipsis"> üîë Authentication Architecture </span> </a> <nav aria-label="üîë Authentication Architecture" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#multi-factor-authentication-flow"> <span class="md-ellipsis"> Multi-Factor Authentication Flow </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#authentication-methods"> <span class="md-ellipsis"> Authentication Methods </span> </a> <nav aria-label="Authentication Methods" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#1-primary-authentication"> <span class="md-ellipsis"> 1. Primary Authentication </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#2-device-authentication"> <span class="md-ellipsis"> 2. Device Authentication </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#3-continuous-authentication"> <span class="md-ellipsis"> 3. Continuous Authentication </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#jwt-token-structure"> <span class="md-ellipsis"> JWT Token Structure </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#token-management"> <span class="md-ellipsis"> Token Management </span> </a> <nav aria-label="Token Management" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#access-tokens"> <span class="md-ellipsis"> Access Tokens </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#refresh-tokens"> <span class="md-ellipsis"> Refresh Tokens </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#token-security"> <span class="md-ellipsis"> Token Security </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#authorization-model"> <span class="md-ellipsis"> üõ°Ô∏è Authorization Model </span> </a> <nav aria-label="üõ°Ô∏è Authorization Model" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#role-based-access-control-rbac"> <span class="md-ellipsis"> Role-Based Access Control (RBAC) </span> </a> <nav aria-label="Role-Based Access Control (RBAC)" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#role-hierarchy"> <span class="md-ellipsis"> Role Hierarchy </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#permission-matrix"> <span class="md-ellipsis"> Permission Matrix </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#attribute-based-access-control-abac"> <span class="md-ellipsis"> Attribute-Based Access Control (ABAC) </span> </a> <nav aria-label="Attribute-Based Access Control (ABAC)" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#context-attributes"> <span class="md-ellipsis"> Context Attributes </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#policy-examples"> <span class="md-ellipsis"> Policy Examples </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#dynamic-authorization"> <span class="md-ellipsis"> Dynamic Authorization </span> </a> <nav aria-label="Dynamic Authorization" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#trust-score-calculation"> <span class="md-ellipsis"> Trust Score Calculation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#encryption-and-data-protection"> <span class="md-ellipsis"> üîí Encryption and Data Protection </span> </a> <nav aria-label="üîí Encryption and Data Protection" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#encryption-at-rest"> <span class="md-ellipsis"> Encryption at Rest </span> </a> <nav aria-label="Encryption at Rest" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#database-encryption"> <span class="md-ellipsis"> Database Encryption </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#file-system-encryption"> <span class="md-ellipsis"> File System Encryption </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#encryption-in-transit"> <span class="md-ellipsis"> Encryption in Transit </span> </a> <nav aria-label="Encryption in Transit" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#tls-configuration"> <span class="md-ellipsis"> TLS Configuration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#certificate-management"> <span class="md-ellipsis"> Certificate Management </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#key-management"> <span class="md-ellipsis"> Key Management </span> </a> <nav aria-label="Key Management" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#key-hierarchy"> <span class="md-ellipsis"> Key Hierarchy </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#key-rotation-policy"> <span class="md-ellipsis"> Key Rotation Policy </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#device-trust-and-attestation"> <span class="md-ellipsis"> üõ°Ô∏è Device Trust and Attestation </span> </a> <nav aria-label="üõ°Ô∏è Device Trust and Attestation" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#device-registration-process"> <span class="md-ellipsis"> Device Registration Process </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#hardware-attestation"> <span class="md-ellipsis"> Hardware Attestation </span> </a> <nav aria-label="Hardware Attestation" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#tpm-based-attestation"> <span class="md-ellipsis"> TPM-based Attestation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#mobile-device-attestation"> <span class="md-ellipsis"> Mobile Device Attestation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#trust-level-assessment"> <span class="md-ellipsis"> Trust Level Assessment </span> </a> <nav aria-label="Trust Level Assessment" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#device-trust-factors"> <span class="md-ellipsis"> Device Trust Factors </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#security-monitoring-and-auditing"> <span class="md-ellipsis"> üîç Security Monitoring and Auditing </span> </a> <nav aria-label="üîç Security Monitoring and Auditing" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#security-events"> <span class="md-ellipsis"> Security Events </span> </a> <nav aria-label="Security Events" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#event-types"> <span class="md-ellipsis"> Event Types </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#security-event-structure"> <span class="md-ellipsis"> Security Event Structure </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#real-time-monitoring"> <span class="md-ellipsis"> Real-time Monitoring </span> </a> <nav aria-label="Real-time Monitoring" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#anomaly-detection"> <span class="md-ellipsis"> Anomaly Detection </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#alert-management"> <span class="md-ellipsis"> Alert Management </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#audit-trail"> <span class="md-ellipsis"> Audit Trail </span> </a> <nav aria-label="Audit Trail" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#comprehensive-logging"> <span class="md-ellipsis"> Comprehensive Logging </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#tamper-evident-logging"> <span class="md-ellipsis"> Tamper-Evident Logging </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#incident-response"> <span class="md-ellipsis"> üö® Incident Response </span> </a> <nav aria-label="üö® Incident Response" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#automated-response-actions"> <span class="md-ellipsis"> Automated Response Actions </span> </a> <nav aria-label="Automated Response Actions" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#security-automation"> <span class="md-ellipsis"> Security Automation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#security-playbooks"> <span class="md-ellipsis"> Security Playbooks </span> </a> <nav aria-label="Security Playbooks" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#incident-response-workflow"> <span class="md-ellipsis"> Incident Response Workflow </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#security-configuration"> <span class="md-ellipsis"> üîß Security Configuration </span> </a> <nav aria-label="üîß Security Configuration" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#security-headers"> <span class="md-ellipsis"> Security Headers </span> </a> <nav aria-label="Security Headers" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#http-security-headers"> <span class="md-ellipsis"> HTTP Security Headers </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#rate-limiting"> <span class="md-ellipsis"> Rate Limiting </span> </a> <nav aria-label="Rate Limiting" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#advanced-rate-limiting"> <span class="md-ellipsis"> Advanced Rate Limiting </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#input-validation"> <span class="md-ellipsis"> Input Validation </span> </a> <nav aria-label="Input Validation" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#comprehensive-input-validation"> <span class="md-ellipsis"> Comprehensive Input Validation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#security-compliance"> <span class="md-ellipsis"> üìã Security Compliance </span> </a> <nav aria-label="üìã Security Compliance" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#compliance-frameworks"> <span class="md-ellipsis"> Compliance Frameworks </span> </a> <nav aria-label="Compliance Frameworks" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#implementation-mapping"> <span class="md-ellipsis"> Implementation Mapping </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#gdpr-compliance"> <span class="md-ellipsis"> GDPR Compliance </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#security-metrics"> <span class="md-ellipsis"> Security Metrics </span> </a> <nav aria-label="Security Metrics" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#key-performance-indicators"> <span class="md-ellipsis"> Key Performance Indicators </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#security-configuration-management"> <span class="md-ellipsis"> üîß Security Configuration Management </span> </a> <nav aria-label="üîß Security Configuration Management" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#environment-specific-security"> <span class="md-ellipsis"> Environment-specific Security </span> </a> <nav aria-label="Environment-specific Security" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#development-security"> <span class="md-ellipsis"> Development Security </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#production-security"> <span class="md-ellipsis"> Production Security </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#security-documentation-and-training"> <span class="md-ellipsis"> üìö Security Documentation and Training </span> </a> <nav aria-label="üìö Security Documentation and Training" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#security-procedures"> <span class="md-ellipsis"> Security Procedures </span> </a> <nav aria-label="Security Procedures" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#security-incident-response-procedures"> <span class="md-ellipsis"> Security Incident Response Procedures </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#security-training"> <span class="md-ellipsis"> Security Training </span> </a> <nav aria-label="Security Training" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#required-training-programs"> <span class="md-ellipsis"> Required Training Programs </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#security-references"> <span class="md-ellipsis"> Security References </span> </a> <nav aria-label="Security References" class="md-nav"> <ul class="md-nav__list"> <li class="md-nav__item"> <a class="md-nav__link" href="#external-resources"> <span class="md-ellipsis"> External Resources </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="#internal-documentation"> <span class="md-ellipsis"> Internal Documentation </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../zero-trust/"> <span class="md-ellipsis"> Zero Trust </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../observability/"> <span class="md-ellipsis"> Observability </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../service-discovery/"> <span class="md-ellipsis"> Service Discovery </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../security-diagrams/"> <span class="md-ellipsis"> Security Diagrams </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_4" type="checkbox"/> <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex=""> <span class="md-ellipsis"> API Documentation </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_4"> <span class="md-nav__icon md-icon"></span> API Documentation </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../api/"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../api/authentication/"> <span class="md-ellipsis"> Authentication </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../api/devices/"> <span class="md-ellipsis"> Devices </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../api/openapi.yaml"> <span class="md-ellipsis"> OpenAPI Spec </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_5" type="checkbox"/> <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex=""> <span class="md-ellipsis"> Development </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_5"> <span class="md-nav__icon md-icon"></span> Development </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../development/"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../development/setup/"> <span class="md-ellipsis"> Setup </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../development/testing/"> <span class="md-ellipsis"> Testing </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../development/contributing/"> <span class="md-ellipsis"> Contributing </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../development/code-style/"> <span class="md-ellipsis"> Code Style </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../development/cli/"> <span class="md-ellipsis"> CLI </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../development/project-structure/"> <span class="md-ellipsis"> Project Structure </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../development/api-documentation/"> <span class="md-ellipsis"> API Documentation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../development/sdk_generation/"> <span class="md-ellipsis"> SDK Generation </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_6" type="checkbox"/> <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex=""> <span class="md-ellipsis"> Deployment </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_6"> <span class="md-nav__icon md-icon"></span> Deployment </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../deployment/README.md"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../deployment/docker/"> <span class="md-ellipsis"> Docker </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../deployment/kubernetes/"> <span class="md-ellipsis"> Kubernetes </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../deployment/production/"> <span class="md-ellipsis"> Production </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../deployment/security/"> <span class="md-ellipsis"> Security </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../deployment/gitops.md"> <span class="md-ellipsis"> GitOps </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../deployment/DEPLOYMENT_RUNBOOK/"> <span class="md-ellipsis"> Runbook </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_7" type="checkbox"/> <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex=""> <span class="md-ellipsis"> Security </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_7"> <span class="md-nav__icon md-icon"></span> Security </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../security/README.md"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../security/threat-model/"> <span class="md-ellipsis"> Threat Model </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../security/policies/"> <span class="md-ellipsis"> Policies </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../security/incident-response/"> <span class="md-ellipsis"> Incident Response </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../security/security-scanning-setup/"> <span class="md-ellipsis"> Security Scanning </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../security/SECURITY-SCANNING-QUICK-REFERENCE/"> <span class="md-ellipsis"> Quick Reference </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../security/playbooks/"> <span class="md-ellipsis"> Playbooks </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_8" type="checkbox"/> <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex=""> <span class="md-ellipsis"> Operations </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_8"> <span class="md-nav__icon md-icon"></span> Operations </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../troubleshooting/"> <span class="md-ellipsis"> Troubleshooting </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../GITOPS_IMPLEMENTATION_PLAN/"> <span class="md-ellipsis"> GitOps Implementation </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../GITOPS_QUICKSTART/"> <span class="md-ellipsis"> GitOps Quickstart </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../PRODUCTION_READINESS_CHECKLIST/"> <span class="md-ellipsis"> Production Readiness </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../ISTIO_MIGRATION_GUIDE/"> <span class="md-ellipsis"> Istio Migration </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../HELM_CHARTS_REFERENCE/"> <span class="md-ellipsis"> Helm Charts </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../CI_CD_PIPELINE/"> <span class="md-ellipsis"> CI/CD Pipeline </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_9" type="checkbox"/> <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex=""> <span class="md-ellipsis"> Testing </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_9_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_9"> <span class="md-nav__icon md-icon"></span> Testing </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../testing/e2e-testing-guide/"> <span class="md-ellipsis"> E2E Testing </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../../tests/test-scenarios.md"> <span class="md-ellipsis"> Test Scenarios </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_10" type="checkbox"/> <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex=""> <span class="md-ellipsis"> SDKs </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_10_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_10"> <span class="md-nav__icon md-icon"></span> SDKs </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../sdk/go/"> <span class="md-ellipsis"> Go SDK </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../sdk/javascript/"> <span class="md-ellipsis"> JavaScript SDK </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../sdk/python/"> <span class="md-ellipsis"> Python SDK </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_11" type="checkbox"/> <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex=""> <span class="md-ellipsis"> CLI </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_11_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_11"> <span class="md-nav__icon md-icon"></span> CLI </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../cli/"> <span class="md-ellipsis"> Overview </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_12" type="checkbox"/> <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex=""> <span class="md-ellipsis"> Examples </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_12_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_12"> <span class="md-nav__icon md-icon"></span> Examples </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/"> <span class="md-ellipsis"> Overview </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/backend/go-fiber/"> <span class="md-ellipsis"> Backend Examples </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/frontend/react-spa/"> <span class="md-ellipsis"> Frontend Examples </span> </a> </li> <li class="md-nav__item"> <a class="md-nav__link" href="../../examples/infrastructure/kubernetes/"> <span class="md-ellipsis"> Infrastructure Examples </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_13" type="checkbox"/> <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex=""> <span class="md-ellipsis"> Schema </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_13_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_13"> <span class="md-nav__icon md-icon"></span> Schema </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../schema/"> <span class="md-ellipsis"> Database Schema </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_14" type="checkbox"/> <label class="md-nav__link" for="__nav_14" id="__nav_14_label" tabindex=""> <span class="md-ellipsis"> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav aria-expanded="false" aria-labelledby="__nav_14_label" class="md-nav" data-md-level="1"> <label class="md-nav__title" for="__nav_14"> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class="md-nav__list" data-md-scrollfix=""> <li class="md-nav__item"> <a class="md-nav__link" href="../../reference/tags/"> <span class="md-ellipsis"> Tags </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <a class="md-content__button md-icon" href="https://github.com/zamaz/root-zamaz/edit/main/docs/architecture/security.md" title="Edit this page"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"></path></svg> </a> <a class="md-content__button md-icon" href="https://github.com/zamaz/root-zamaz/raw/main/docs/architecture/security.md" title="View source of this page"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0 8a5 5 0 0 1-5-5 5 5 0 0 1 5-5 5 5 0 0 1 5 5 5 5 0 0 1-5 5m0-12.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5Z"></path></svg> </a> <h1 id="security-architecture-guide">Security Architecture Guide<a class="headerlink" href="#security-architecture-guide" title="Permanent link">¬∂</a></h1> <p>This document outlines the comprehensive security architecture of the Zero Trust Auth MVP, covering authentication mechanisms, authorization models, encryption, and security best practices.</p> <h2 id="zero-trust-security-model">üîê Zero Trust Security Model<a class="headerlink" href="#zero-trust-security-model" title="Permanent link">¬∂</a></h2> <h3 id="core-principles">Core Principles<a class="headerlink" href="#core-principles" title="Permanent link">¬∂</a></h3> <p>The MVP implements a <strong>Zero Trust Architecture</strong> based on these fundamental principles:</p> <ol> <li><strong>Never Trust, Always Verify</strong>: Every request is authenticated and authorized</li> <li><strong>Least Privilege Access</strong>: Users and services get minimal required permissions</li> <li><strong>Assume Breach</strong>: Design assumes the network is already compromised</li> <li><strong>Verify Explicitly</strong>: Use all available data points for access decisions</li> <li><strong>Continuous Monitoring</strong>: Real-time security monitoring and alerting</li> </ol> <h3 id="security-layers">Security Layers<a class="headerlink" href="#security-layers" title="Permanent link">¬∂</a></h3> <pre class="mermaid"><code>graph TB
    Internet[Internet] --&gt; WAF[Web Application Firewall]
    WAF --&gt; LB[Load Balancer + TLS]
    LB --&gt; Envoy[Envoy Proxy]
    Envoy --&gt; AuthZ[Authorization Middleware]
    AuthZ --&gt; App[Application Layer]

    subgraph "Security Controls"
        Identity[Identity Verification]
        Device[Device Attestation]
        Network[Network Segmentation]
        Encryption[End-to-End Encryption]
        Monitoring[Security Monitoring]
    end

    subgraph "Trust Evaluation"
        Context[Context Analysis]
        Risk[Risk Assessment]
        Policy[Policy Engine]
        Decision[Access Decision]
    end</code></pre> <h2 id="authentication-architecture">üîë Authentication Architecture<a class="headerlink" href="#authentication-architecture" title="Permanent link">¬∂</a></h2> <h3 id="multi-factor-authentication-flow">Multi-Factor Authentication Flow<a class="headerlink" href="#multi-factor-authentication-flow" title="Permanent link">¬∂</a></h3> <pre class="mermaid"><code>sequenceDiagram
    participant User
    participant Frontend
    participant AuthService
    participant DeviceService
    participant SPIRE
    participant Database

    User-&gt;&gt;Frontend: Login Request
    Frontend-&gt;&gt;AuthService: Credentials + Device Info
    AuthService-&gt;&gt;Database: Validate User Credentials
    Database--&gt;&gt;AuthService: User Record
    AuthService-&gt;&gt;DeviceService: Request Device Attestation
    DeviceService-&gt;&gt;SPIRE: Verify Device Identity
    SPIRE--&gt;&gt;DeviceService: Device Certificate
    DeviceService--&gt;&gt;AuthService: Attestation Result
    AuthService-&gt;&gt;AuthService: Calculate Trust Score
    AuthService--&gt;&gt;Frontend: JWT Token + Trust Level
    Frontend--&gt;&gt;User: Authentication Success</code></pre> <h3 id="authentication-methods">Authentication Methods<a class="headerlink" href="#authentication-methods" title="Permanent link">¬∂</a></h3> <h4 id="1-primary-authentication">1. Primary Authentication<a class="headerlink" href="#1-primary-authentication" title="Permanent link">¬∂</a></h4> <ul> <li><strong>Username/Password</strong>: PBKDF2 with salt for password hashing</li> <li><strong>Multi-Factor Authentication</strong>: TOTP (Time-based One-Time Password)</li> <li><strong>Biometric Authentication</strong>: WebAuthn for fingerprint/face recognition</li> <li><strong>Certificate-based</strong>: X.509 client certificates for automated systems</li> </ul> <h4 id="2-device-authentication">2. Device Authentication<a class="headerlink" href="#2-device-authentication" title="Permanent link">¬∂</a></h4> <ul> <li><strong>Device Registration</strong>: Unique device fingerprinting</li> <li><strong>Hardware Attestation</strong>: TPM-based device verification</li> <li><strong>SPIFFE/SPIRE Integration</strong>: Workload identity verification</li> <li><strong>Certificate Pinning</strong>: Public key pinning for mobile apps</li> </ul> <h4 id="3-continuous-authentication">3. Continuous Authentication<a class="headerlink" href="#3-continuous-authentication" title="Permanent link">¬∂</a></h4> <ul> <li><strong>Behavioral Analysis</strong>: User behavior pattern recognition</li> <li><strong>Geolocation Verification</strong>: Location-based risk assessment</li> <li><strong>Session Monitoring</strong>: Real-time session anomaly detection</li> <li><strong>Adaptive Authentication</strong>: Dynamic authentication requirements</li> </ul> <h3 id="jwt-token-structure">JWT Token Structure<a class="headerlink" href="#jwt-token-structure" title="Permanent link">¬∂</a></h3> <div class="language-json highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="p">{</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">  </span><span class="nt">"header"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">    </span><span class="nt">"alg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HS256"</span><span class="p">,</span>
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">    </span><span class="nt">"typ"</span><span class="p">:</span><span class="w"> </span><span class="s2">"JWT"</span><span class="p">,</span>
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="w">    </span><span class="nt">"kid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key-id-2024"</span>
</span><span id="__span-0-6"><a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-0-7"><a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a><span class="w">  </span><span class="nt">"payload"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-8"><a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a><span class="w">    </span><span class="nt">"sub"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user-id"</span><span class="p">,</span>
</span><span id="__span-0-9"><a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a><span class="w">    </span><span class="nt">"username"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin"</span><span class="p">,</span>
</span><span id="__span-0-10"><a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a><span class="w">    </span><span class="nt">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin@company.com"</span><span class="p">,</span>
</span><span id="__span-0-11"><a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="w">    </span><span class="nt">"roles"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"admin"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user"</span><span class="p">],</span>
</span><span id="__span-0-12"><a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a><span class="w">    </span><span class="nt">"permissions"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"system:admin"</span><span class="p">,</span><span class="w"> </span><span class="s2">"device:verify"</span><span class="p">,</span><span class="w"> </span><span class="s2">"user:read"</span><span class="p">],</span>
</span><span id="__span-0-13"><a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="w">    </span><span class="nt">"device_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"device-12345"</span><span class="p">,</span>
</span><span id="__span-0-14"><a href="#__codelineno-0-14" id="__codelineno-0-14" name="__codelineno-0-14"></a><span class="w">    </span><span class="nt">"trust_level"</span><span class="p">:</span><span class="w"> </span><span class="s2">"high"</span><span class="p">,</span>
</span><span id="__span-0-15"><a href="#__codelineno-0-15" id="__codelineno-0-15" name="__codelineno-0-15"></a><span class="w">    </span><span class="nt">"session_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"session-abcdef"</span><span class="p">,</span>
</span><span id="__span-0-16"><a href="#__codelineno-0-16" id="__codelineno-0-16" name="__codelineno-0-16"></a><span class="w">    </span><span class="nt">"iat"</span><span class="p">:</span><span class="w"> </span><span class="mi">1640995200</span><span class="p">,</span>
</span><span id="__span-0-17"><a href="#__codelineno-0-17" id="__codelineno-0-17" name="__codelineno-0-17"></a><span class="w">    </span><span class="nt">"exp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1641081600</span><span class="p">,</span>
</span><span id="__span-0-18"><a href="#__codelineno-0-18" id="__codelineno-0-18" name="__codelineno-0-18"></a><span class="w">    </span><span class="nt">"iss"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mvp-zero-trust-auth"</span><span class="p">,</span>
</span><span id="__span-0-19"><a href="#__codelineno-0-19" id="__codelineno-0-19" name="__codelineno-0-19"></a><span class="w">    </span><span class="nt">"aud"</span><span class="p">:</span><span class="w"> </span><span class="s2">"mvp-client-app"</span><span class="p">,</span>
</span><span id="__span-0-20"><a href="#__codelineno-0-20" id="__codelineno-0-20" name="__codelineno-0-20"></a><span class="w">    </span><span class="nt">"context"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-21"><a href="#__codelineno-0-21" id="__codelineno-0-21" name="__codelineno-0-21"></a><span class="w">      </span><span class="nt">"ip_address"</span><span class="p">:</span><span class="w"> </span><span class="s2">"192.168.1.100"</span><span class="p">,</span>
</span><span id="__span-0-22"><a href="#__codelineno-0-22" id="__codelineno-0-22" name="__codelineno-0-22"></a><span class="w">      </span><span class="nt">"user_agent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Mozilla/5.0..."</span><span class="p">,</span>
</span><span id="__span-0-23"><a href="#__codelineno-0-23" id="__codelineno-0-23" name="__codelineno-0-23"></a><span class="w">      </span><span class="nt">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"US-CA-SF"</span><span class="p">,</span>
</span><span id="__span-0-24"><a href="#__codelineno-0-24" id="__codelineno-0-24" name="__codelineno-0-24"></a><span class="w">      </span><span class="nt">"risk_score"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.2</span>
</span><span id="__span-0-25"><a href="#__codelineno-0-25" id="__codelineno-0-25" name="__codelineno-0-25"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-26"><a href="#__codelineno-0-26" id="__codelineno-0-26" name="__codelineno-0-26"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-0-27"><a href="#__codelineno-0-27" id="__codelineno-0-27" name="__codelineno-0-27"></a><span class="w">  </span><span class="nt">"signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"HMACSHA256(...)"</span>
</span><span id="__span-0-28"><a href="#__codelineno-0-28" id="__codelineno-0-28" name="__codelineno-0-28"></a><span class="p">}</span>
</span></code></pre></div> <h3 id="token-management">Token Management<a class="headerlink" href="#token-management" title="Permanent link">¬∂</a></h3> <h4 id="access-tokens">Access Tokens<a class="headerlink" href="#access-tokens" title="Permanent link">¬∂</a></h4> <ul> <li><strong>Short-lived</strong>: 1 hour expiration for production</li> <li><strong>Stateless</strong>: Self-contained with user context</li> <li><strong>Scoped</strong>: Specific permissions and resources</li> <li><strong>Revocable</strong>: Centralized revocation list</li> </ul> <h4 id="refresh-tokens">Refresh Tokens<a class="headerlink" href="#refresh-tokens" title="Permanent link">¬∂</a></h4> <ul> <li><strong>Long-lived</strong>: 24 hours expiration</li> <li><strong>Rotating</strong>: New refresh token on each use</li> <li><strong>Secure Storage</strong>: HttpOnly, Secure cookies</li> <li><strong>Device-bound</strong>: Tied to specific device fingerprint</li> </ul> <h4 id="token-security">Token Security<a class="headerlink" href="#token-security" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="c1">// Token configuration</span>
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="kd">type</span><span class="w"> </span><span class="nx">JWTConfig</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-1-3"><a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">    </span><span class="nx">Secret</span><span class="w">                </span><span class="kt">string</span><span class="w">        </span><span class="s">`env:"JWT_SECRET"`</span>
</span><span id="__span-1-4"><a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="w">    </span><span class="nx">AccessTokenTTL</span><span class="w">        </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w"> </span><span class="s">`env:"JWT_ACCESS_TOKEN_TTL" default:"1h"`</span>
</span><span id="__span-1-5"><a href="#__codelineno-1-5" id="__codelineno-1-5" name="__codelineno-1-5"></a><span class="w">    </span><span class="nx">RefreshTokenTTL</span><span class="w">       </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w"> </span><span class="s">`env:"JWT_REFRESH_TOKEN_TTL" default:"24h"`</span>
</span><span id="__span-1-6"><a href="#__codelineno-1-6" id="__codelineno-1-6" name="__codelineno-1-6"></a><span class="w">    </span><span class="nx">Issuer</span><span class="w">                </span><span class="kt">string</span><span class="w">        </span><span class="s">`env:"JWT_ISSUER" default:"mvp-zero-trust-auth"`</span>
</span><span id="__span-1-7"><a href="#__codelineno-1-7" id="__codelineno-1-7" name="__codelineno-1-7"></a><span class="w">    </span><span class="nx">Audience</span><span class="w">              </span><span class="kt">string</span><span class="w">        </span><span class="s">`env:"JWT_AUDIENCE" default:"mvp-client"`</span>
</span><span id="__span-1-8"><a href="#__codelineno-1-8" id="__codelineno-1-8" name="__codelineno-1-8"></a><span class="w">    </span><span class="nx">Algorithm</span><span class="w">             </span><span class="kt">string</span><span class="w">        </span><span class="s">`env:"JWT_ALGORITHM" default:"HS256"`</span>
</span><span id="__span-1-9"><a href="#__codelineno-1-9" id="__codelineno-1-9" name="__codelineno-1-9"></a><span class="w">    </span><span class="nx">ClockSkewTolerance</span><span class="w">    </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w"> </span><span class="s">`env:"JWT_CLOCK_SKEW" default:"30s"`</span>
</span><span id="__span-1-10"><a href="#__codelineno-1-10" id="__codelineno-1-10" name="__codelineno-1-10"></a><span class="w">    </span><span class="nx">RefreshTokenRotation</span><span class="w">  </span><span class="kt">bool</span><span class="w">          </span><span class="s">`env:"JWT_REFRESH_ROTATION" default:"true"`</span>
</span><span id="__span-1-11"><a href="#__codelineno-1-11" id="__codelineno-1-11" name="__codelineno-1-11"></a><span class="w">    </span><span class="nx">RevokedTokenCacheSize</span><span class="w"> </span><span class="kt">int</span><span class="w">           </span><span class="s">`env:"JWT_REVOCATION_CACHE_SIZE" default:"10000"`</span>
</span><span id="__span-1-12"><a href="#__codelineno-1-12" id="__codelineno-1-12" name="__codelineno-1-12"></a><span class="p">}</span>
</span></code></pre></div> <h2 id="authorization-model">üõ°Ô∏è Authorization Model<a class="headerlink" href="#authorization-model" title="Permanent link">¬∂</a></h2> <h3 id="role-based-access-control-rbac">Role-Based Access Control (RBAC)<a class="headerlink" href="#role-based-access-control-rbac" title="Permanent link">¬∂</a></h3> <h4 id="role-hierarchy">Role Hierarchy<a class="headerlink" href="#role-hierarchy" title="Permanent link">¬∂</a></h4> <div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a>Super Admin
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>‚îú‚îÄ‚îÄ System Admin
</span><span id="__span-2-3"><a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a>‚îÇ   ‚îú‚îÄ‚îÄ User Admin
</span><span id="__span-2-4"><a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a>‚îÇ   ‚îî‚îÄ‚îÄ Device Admin
</span><span id="__span-2-5"><a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a>‚îú‚îÄ‚îÄ Security Officer
</span><span id="__span-2-6"><a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a>‚îÇ   ‚îú‚îÄ‚îÄ Auditor
</span><span id="__span-2-7"><a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a>‚îÇ   ‚îî‚îÄ‚îÄ Analyst
</span><span id="__span-2-8"><a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a>‚îî‚îÄ‚îÄ Regular User
</span><span id="__span-2-9"><a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a>    ‚îú‚îÄ‚îÄ Device Owner
</span><span id="__span-2-10"><a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a>    ‚îî‚îÄ‚îÄ Guest User
</span></code></pre></div> <h4 id="permission-matrix">Permission Matrix<a class="headerlink" href="#permission-matrix" title="Permanent link">¬∂</a></h4> <table> <thead> <tr> <th>Resource</th> <th>Create</th> <th>Read</th> <th>Update</th> <th>Delete</th> <th>Verify</th> <th>Admin</th> </tr> </thead> <tbody> <tr> <td>Users</td> <td>‚úì SA</td> <td>‚úì UA</td> <td>‚úì UA</td> <td>‚úì SA</td> <td>‚úì SO</td> <td>‚úì SA</td> </tr> <tr> <td>Devices</td> <td>‚úì U</td> <td>‚úì U</td> <td>‚úì DO</td> <td>‚úì DA</td> <td>‚úì SO</td> <td>‚úì DA</td> </tr> <tr> <td>Policies</td> <td>‚úó</td> <td>‚úì SO</td> <td>‚úó</td> <td>‚úó</td> <td>‚úó</td> <td>‚úì SA</td> </tr> <tr> <td>Audit</td> <td>‚úó</td> <td>‚úì A</td> <td>‚úó</td> <td>‚úó</td> <td>‚úó</td> <td>‚úì SO</td> </tr> </tbody> </table> <p><em>Legend: SA=Super Admin, UA=User Admin, DA=Device Admin, SO=Security Officer, A=Auditor, U=User, DO=Device Owner</em></p> <h3 id="attribute-based-access-control-abac">Attribute-Based Access Control (ABAC)<a class="headerlink" href="#attribute-based-access-control-abac" title="Permanent link">¬∂</a></h3> <h4 id="context-attributes">Context Attributes<a class="headerlink" href="#context-attributes" title="Permanent link">¬∂</a></h4> <div class="language-json highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="p">{</span>
</span><span id="__span-3-2"><a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">  </span><span class="nt">"subject"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-3"><a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">    </span><span class="nt">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user-123"</span><span class="p">,</span>
</span><span id="__span-3-4"><a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">    </span><span class="nt">"roles"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"admin"</span><span class="p">],</span>
</span><span id="__span-3-5"><a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">    </span><span class="nt">"clearance_level"</span><span class="p">:</span><span class="w"> </span><span class="s2">"secret"</span><span class="p">,</span>
</span><span id="__span-3-6"><a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="w">    </span><span class="nt">"department"</span><span class="p">:</span><span class="w"> </span><span class="s2">"engineering"</span>
</span><span id="__span-3-7"><a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-3-8"><a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a><span class="w">  </span><span class="nt">"resource"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-9"><a href="#__codelineno-3-9" id="__codelineno-3-9" name="__codelineno-3-9"></a><span class="w">    </span><span class="nt">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"device"</span><span class="p">,</span>
</span><span id="__span-3-10"><a href="#__codelineno-3-10" id="__codelineno-3-10" name="__codelineno-3-10"></a><span class="w">    </span><span class="nt">"classification"</span><span class="p">:</span><span class="w"> </span><span class="s2">"confidential"</span><span class="p">,</span>
</span><span id="__span-3-11"><a href="#__codelineno-3-11" id="__codelineno-3-11" name="__codelineno-3-11"></a><span class="w">    </span><span class="nt">"owner"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user-456"</span><span class="p">,</span>
</span><span id="__span-3-12"><a href="#__codelineno-3-12" id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="w">    </span><span class="nt">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"datacenter-1"</span>
</span><span id="__span-3-13"><a href="#__codelineno-3-13" id="__codelineno-3-13" name="__codelineno-3-13"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-3-14"><a href="#__codelineno-3-14" id="__codelineno-3-14" name="__codelineno-3-14"></a><span class="w">  </span><span class="nt">"environment"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-15"><a href="#__codelineno-3-15" id="__codelineno-3-15" name="__codelineno-3-15"></a><span class="w">    </span><span class="nt">"time"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2024-01-15T14:30:00Z"</span><span class="p">,</span>
</span><span id="__span-3-16"><a href="#__codelineno-3-16" id="__codelineno-3-16" name="__codelineno-3-16"></a><span class="w">    </span><span class="nt">"location"</span><span class="p">:</span><span class="w"> </span><span class="s2">"office-network"</span><span class="p">,</span>
</span><span id="__span-3-17"><a href="#__codelineno-3-17" id="__codelineno-3-17" name="__codelineno-3-17"></a><span class="w">    </span><span class="nt">"risk_level"</span><span class="p">:</span><span class="w"> </span><span class="s2">"low"</span><span class="p">,</span>
</span><span id="__span-3-18"><a href="#__codelineno-3-18" id="__codelineno-3-18" name="__codelineno-3-18"></a><span class="w">    </span><span class="nt">"security_posture"</span><span class="p">:</span><span class="w"> </span><span class="s2">"compliant"</span>
</span><span id="__span-3-19"><a href="#__codelineno-3-19" id="__codelineno-3-19" name="__codelineno-3-19"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-3-20"><a href="#__codelineno-3-20" id="__codelineno-3-20" name="__codelineno-3-20"></a><span class="w">  </span><span class="nt">"action"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-21"><a href="#__codelineno-3-21" id="__codelineno-3-21" name="__codelineno-3-21"></a><span class="w">    </span><span class="nt">"operation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"read"</span><span class="p">,</span>
</span><span id="__span-3-22"><a href="#__codelineno-3-22" id="__codelineno-3-22" name="__codelineno-3-22"></a><span class="w">    </span><span class="nt">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"API"</span><span class="p">,</span>
</span><span id="__span-3-23"><a href="#__codelineno-3-23" id="__codelineno-3-23" name="__codelineno-3-23"></a><span class="w">    </span><span class="nt">"urgency"</span><span class="p">:</span><span class="w"> </span><span class="s2">"normal"</span>
</span><span id="__span-3-24"><a href="#__codelineno-3-24" id="__codelineno-3-24" name="__codelineno-3-24"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-3-25"><a href="#__codelineno-3-25" id="__codelineno-3-25" name="__codelineno-3-25"></a><span class="p">}</span>
</span></code></pre></div> <h4 id="policy-examples">Policy Examples<a class="headerlink" href="#policy-examples" title="Permanent link">¬∂</a></h4> <div class="language-json highlight"><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="p">{</span>
</span><span id="__span-4-2"><a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w">  </span><span class="nt">"policy_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"device-access-policy"</span><span class="p">,</span>
</span><span id="__span-4-3"><a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Device Access Control"</span><span class="p">,</span>
</span><span id="__span-4-4"><a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">  </span><span class="nt">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Controls device access based on user role and device trust level"</span><span class="p">,</span>
</span><span id="__span-4-5"><a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="w">  </span><span class="nt">"rules"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-4-6"><a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-4-7"><a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="w">      </span><span class="nt">"effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ALLOW"</span><span class="p">,</span>
</span><span id="__span-4-8"><a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="w">      </span><span class="nt">"condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-9"><a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="w">        </span><span class="nt">"AND"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-4-10"><a href="#__codelineno-4-10" id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="w">          </span><span class="p">{</span><span class="nt">"subject.roles"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"contains"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin"</span><span class="p">}},</span>
</span><span id="__span-4-11"><a href="#__codelineno-4-11" id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="w">          </span><span class="p">{</span><span class="nt">"resource.type"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"equals"</span><span class="p">:</span><span class="w"> </span><span class="s2">"device"</span><span class="p">}},</span>
</span><span id="__span-4-12"><a href="#__codelineno-4-12" id="__codelineno-4-12" name="__codelineno-4-12"></a><span class="w">          </span><span class="p">{</span><span class="nt">"environment.location"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"in"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"office-network"</span><span class="p">,</span><span class="w"> </span><span class="s2">"vpn"</span><span class="p">]}}</span>
</span><span id="__span-4-13"><a href="#__codelineno-4-13" id="__codelineno-4-13" name="__codelineno-4-13"></a><span class="w">        </span><span class="p">]</span>
</span><span id="__span-4-14"><a href="#__codelineno-4-14" id="__codelineno-4-14" name="__codelineno-4-14"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-4-15"><a href="#__codelineno-4-15" id="__codelineno-4-15" name="__codelineno-4-15"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-4-16"><a href="#__codelineno-4-16" id="__codelineno-4-16" name="__codelineno-4-16"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-4-17"><a href="#__codelineno-4-17" id="__codelineno-4-17" name="__codelineno-4-17"></a><span class="w">      </span><span class="nt">"effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"DENY"</span><span class="p">,</span>
</span><span id="__span-4-18"><a href="#__codelineno-4-18" id="__codelineno-4-18" name="__codelineno-4-18"></a><span class="w">      </span><span class="nt">"condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-4-19"><a href="#__codelineno-4-19" id="__codelineno-4-19" name="__codelineno-4-19"></a><span class="w">        </span><span class="nt">"OR"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-4-20"><a href="#__codelineno-4-20" id="__codelineno-4-20" name="__codelineno-4-20"></a><span class="w">          </span><span class="p">{</span><span class="nt">"environment.risk_level"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"equals"</span><span class="p">:</span><span class="w"> </span><span class="s2">"high"</span><span class="p">}},</span>
</span><span id="__span-4-21"><a href="#__codelineno-4-21" id="__codelineno-4-21" name="__codelineno-4-21"></a><span class="w">          </span><span class="p">{</span><span class="nt">"resource.classification"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nt">"equals"</span><span class="p">:</span><span class="w"> </span><span class="s2">"top-secret"</span><span class="p">}}</span>
</span><span id="__span-4-22"><a href="#__codelineno-4-22" id="__codelineno-4-22" name="__codelineno-4-22"></a><span class="w">        </span><span class="p">]</span>
</span><span id="__span-4-23"><a href="#__codelineno-4-23" id="__codelineno-4-23" name="__codelineno-4-23"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-4-24"><a href="#__codelineno-4-24" id="__codelineno-4-24" name="__codelineno-4-24"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-4-25"><a href="#__codelineno-4-25" id="__codelineno-4-25" name="__codelineno-4-25"></a><span class="w">  </span><span class="p">]</span>
</span><span id="__span-4-26"><a href="#__codelineno-4-26" id="__codelineno-4-26" name="__codelineno-4-26"></a><span class="p">}</span>
</span></code></pre></div> <h3 id="dynamic-authorization">Dynamic Authorization<a class="headerlink" href="#dynamic-authorization" title="Permanent link">¬∂</a></h3> <h4 id="trust-score-calculation">Trust Score Calculation<a class="headerlink" href="#trust-score-calculation" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-5-1"><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">TrustCalculator</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-2"><a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="w">    </span><span class="nx">DeviceScore</span><span class="w">      </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"device_score"`</span><span class="w">      </span><span class="c1">// 0.0 - 1.0</span>
</span><span id="__span-5-3"><a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">    </span><span class="nx">LocationScore</span><span class="w">    </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"location_score"`</span><span class="w">    </span><span class="c1">// 0.0 - 1.0</span>
</span><span id="__span-5-4"><a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="w">    </span><span class="nx">BehaviorScore</span><span class="w">    </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"behavior_score"`</span><span class="w">    </span><span class="c1">// 0.0 - 1.0</span>
</span><span id="__span-5-5"><a href="#__codelineno-5-5" id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="w">    </span><span class="nx">TimeScore</span><span class="w">        </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"time_score"`</span><span class="w">        </span><span class="c1">// 0.0 - 1.0</span>
</span><span id="__span-5-6"><a href="#__codelineno-5-6" id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="w">    </span><span class="nx">NetworkScore</span><span class="w">     </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"network_score"`</span><span class="w">     </span><span class="c1">// 0.0 - 1.0</span>
</span><span id="__span-5-7"><a href="#__codelineno-5-7" id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="p">}</span>
</span><span id="__span-5-8"><a href="#__codelineno-5-8" id="__codelineno-5-8" name="__codelineno-5-8"></a>
</span><span id="__span-5-9"><a href="#__codelineno-5-9" id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">tc</span><span class="w"> </span><span class="o">*</span><span class="nx">TrustCalculator</span><span class="p">)</span><span class="w"> </span><span class="nx">CalculateOverallTrust</span><span class="p">()</span><span class="w"> </span><span class="nx">TrustLevel</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-10"><a href="#__codelineno-5-10" id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="w">    </span><span class="nx">weights</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">float64</span><span class="p">{</span>
</span><span id="__span-5-11"><a href="#__codelineno-5-11" id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="w">        </span><span class="s">"device"</span><span class="p">:</span><span class="w">   </span><span class="mf">0.3</span><span class="p">,</span>
</span><span id="__span-5-12"><a href="#__codelineno-5-12" id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="w">        </span><span class="s">"location"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.2</span><span class="p">,</span>
</span><span id="__span-5-13"><a href="#__codelineno-5-13" id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="w">        </span><span class="s">"behavior"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.25</span><span class="p">,</span>
</span><span id="__span-5-14"><a href="#__codelineno-5-14" id="__codelineno-5-14" name="__codelineno-5-14"></a><span class="w">        </span><span class="s">"time"</span><span class="p">:</span><span class="w">     </span><span class="mf">0.1</span><span class="p">,</span>
</span><span id="__span-5-15"><a href="#__codelineno-5-15" id="__codelineno-5-15" name="__codelineno-5-15"></a><span class="w">        </span><span class="s">"network"</span><span class="p">:</span><span class="w">  </span><span class="mf">0.15</span><span class="p">,</span>
</span><span id="__span-5-16"><a href="#__codelineno-5-16" id="__codelineno-5-16" name="__codelineno-5-16"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-17"><a href="#__codelineno-5-17" id="__codelineno-5-17" name="__codelineno-5-17"></a>
</span><span id="__span-5-18"><a href="#__codelineno-5-18" id="__codelineno-5-18" name="__codelineno-5-18"></a><span class="w">    </span><span class="nx">score</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">tc</span><span class="p">.</span><span class="nx">DeviceScore</span><span class="o">*</span><span class="nx">weights</span><span class="p">[</span><span class="s">"device"</span><span class="p">]</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-5-19"><a href="#__codelineno-5-19" id="__codelineno-5-19" name="__codelineno-5-19"></a><span class="w">             </span><span class="nx">tc</span><span class="p">.</span><span class="nx">LocationScore</span><span class="o">*</span><span class="nx">weights</span><span class="p">[</span><span class="s">"location"</span><span class="p">]</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-5-20"><a href="#__codelineno-5-20" id="__codelineno-5-20" name="__codelineno-5-20"></a><span class="w">             </span><span class="nx">tc</span><span class="p">.</span><span class="nx">BehaviorScore</span><span class="o">*</span><span class="nx">weights</span><span class="p">[</span><span class="s">"behavior"</span><span class="p">]</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-5-21"><a href="#__codelineno-5-21" id="__codelineno-5-21" name="__codelineno-5-21"></a><span class="w">             </span><span class="nx">tc</span><span class="p">.</span><span class="nx">TimeScore</span><span class="o">*</span><span class="nx">weights</span><span class="p">[</span><span class="s">"time"</span><span class="p">]</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-5-22"><a href="#__codelineno-5-22" id="__codelineno-5-22" name="__codelineno-5-22"></a><span class="w">             </span><span class="nx">tc</span><span class="p">.</span><span class="nx">NetworkScore</span><span class="o">*</span><span class="nx">weights</span><span class="p">[</span><span class="s">"network"</span><span class="p">]</span>
</span><span id="__span-5-23"><a href="#__codelineno-5-23" id="__codelineno-5-23" name="__codelineno-5-23"></a>
</span><span id="__span-5-24"><a href="#__codelineno-5-24" id="__codelineno-5-24" name="__codelineno-5-24"></a><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-25"><a href="#__codelineno-5-25" id="__codelineno-5-25" name="__codelineno-5-25"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="nx">score</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0.8</span><span class="p">:</span>
</span><span id="__span-5-26"><a href="#__codelineno-5-26" id="__codelineno-5-26" name="__codelineno-5-26"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">TrustLevelHigh</span>
</span><span id="__span-5-27"><a href="#__codelineno-5-27" id="__codelineno-5-27" name="__codelineno-5-27"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="nx">score</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0.6</span><span class="p">:</span>
</span><span id="__span-5-28"><a href="#__codelineno-5-28" id="__codelineno-5-28" name="__codelineno-5-28"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">TrustLevelMedium</span>
</span><span id="__span-5-29"><a href="#__codelineno-5-29" id="__codelineno-5-29" name="__codelineno-5-29"></a><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="nx">score</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mf">0.4</span><span class="p">:</span>
</span><span id="__span-5-30"><a href="#__codelineno-5-30" id="__codelineno-5-30" name="__codelineno-5-30"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">TrustLevelLow</span>
</span><span id="__span-5-31"><a href="#__codelineno-5-31" id="__codelineno-5-31" name="__codelineno-5-31"></a><span class="w">    </span><span class="k">default</span><span class="p">:</span>
</span><span id="__span-5-32"><a href="#__codelineno-5-32" id="__codelineno-5-32" name="__codelineno-5-32"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">TrustLevelDeny</span>
</span><span id="__span-5-33"><a href="#__codelineno-5-33" id="__codelineno-5-33" name="__codelineno-5-33"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-34"><a href="#__codelineno-5-34" id="__codelineno-5-34" name="__codelineno-5-34"></a><span class="p">}</span>
</span></code></pre></div> <h2 id="encryption-and-data-protection">üîí Encryption and Data Protection<a class="headerlink" href="#encryption-and-data-protection" title="Permanent link">¬∂</a></h2> <h3 id="encryption-at-rest">Encryption at Rest<a class="headerlink" href="#encryption-at-rest" title="Permanent link">¬∂</a></h3> <h4 id="database-encryption">Database Encryption<a class="headerlink" href="#database-encryption" title="Permanent link">¬∂</a></h4> <ul> <li><strong>Field-level Encryption</strong>: PII and sensitive data encrypted</li> <li><strong>Transparent Data Encryption</strong>: PostgreSQL encryption</li> <li><strong>Key Management</strong>: Separate encryption keys per data type</li> <li><strong>Key Rotation</strong>: Automated quarterly key rotation</li> </ul> <div class="language-go highlight"><pre><span></span><code><span id="__span-6-1"><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">EncryptedField</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-2"><a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="w">    </span><span class="nx">Value</span><span class="w">     </span><span class="kt">string</span><span class="w">    </span><span class="s">`json:"-"`</span><span class="w">                    </span><span class="c1">// Never serialized</span>
</span><span id="__span-6-3"><a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">    </span><span class="nx">Encrypted</span><span class="w"> </span><span class="kt">string</span><span class="w">    </span><span class="s">`json:"encrypted"`</span><span class="w">            </span><span class="c1">// Base64 encoded</span>
</span><span id="__span-6-4"><a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="w">    </span><span class="nx">KeyID</span><span class="w">     </span><span class="kt">string</span><span class="w">    </span><span class="s">`json:"key_id"`</span><span class="w">              </span><span class="c1">// Key identifier</span>
</span><span id="__span-6-5"><a href="#__codelineno-6-5" id="__codelineno-6-5" name="__codelineno-6-5"></a><span class="w">    </span><span class="nx">Algorithm</span><span class="w"> </span><span class="kt">string</span><span class="w">    </span><span class="s">`json:"algorithm"`</span><span class="w">            </span><span class="c1">// Encryption algorithm</span>
</span><span id="__span-6-6"><a href="#__codelineno-6-6" id="__codelineno-6-6" name="__codelineno-6-6"></a><span class="w">    </span><span class="nx">CreatedAt</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="w"> </span><span class="s">`json:"created_at"`</span><span class="w">          </span><span class="c1">// Encryption timestamp</span>
</span><span id="__span-6-7"><a href="#__codelineno-6-7" id="__codelineno-6-7" name="__codelineno-6-7"></a><span class="p">}</span>
</span><span id="__span-6-8"><a href="#__codelineno-6-8" id="__codelineno-6-8" name="__codelineno-6-8"></a>
</span><span id="__span-6-9"><a href="#__codelineno-6-9" id="__codelineno-6-9" name="__codelineno-6-9"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="w"> </span><span class="o">*</span><span class="nx">EncryptedField</span><span class="p">)</span><span class="w"> </span><span class="nx">Encrypt</span><span class="p">(</span><span class="nx">plaintext</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">keyID</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-10"><a href="#__codelineno-6-10" id="__codelineno-6-10" name="__codelineno-6-10"></a><span class="w">    </span><span class="nx">key</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">e</span><span class="p">.</span><span class="nx">keyManager</span><span class="p">.</span><span class="nx">GetKey</span><span class="p">(</span><span class="nx">keyID</span><span class="p">)</span>
</span><span id="__span-6-11"><a href="#__codelineno-6-11" id="__codelineno-6-11" name="__codelineno-6-11"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-12"><a href="#__codelineno-6-12" id="__codelineno-6-12" name="__codelineno-6-12"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">err</span>
</span><span id="__span-6-13"><a href="#__codelineno-6-13" id="__codelineno-6-13" name="__codelineno-6-13"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-6-14"><a href="#__codelineno-6-14" id="__codelineno-6-14" name="__codelineno-6-14"></a>
</span><span id="__span-6-15"><a href="#__codelineno-6-15" id="__codelineno-6-15" name="__codelineno-6-15"></a><span class="w">    </span><span class="c1">// Use AES-256-GCM for authenticated encryption</span>
</span><span id="__span-6-16"><a href="#__codelineno-6-16" id="__codelineno-6-16" name="__codelineno-6-16"></a><span class="w">    </span><span class="nx">block</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">aes</span><span class="p">.</span><span class="nx">NewCipher</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span>
</span><span id="__span-6-17"><a href="#__codelineno-6-17" id="__codelineno-6-17" name="__codelineno-6-17"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-18"><a href="#__codelineno-6-18" id="__codelineno-6-18" name="__codelineno-6-18"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">err</span>
</span><span id="__span-6-19"><a href="#__codelineno-6-19" id="__codelineno-6-19" name="__codelineno-6-19"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-6-20"><a href="#__codelineno-6-20" id="__codelineno-6-20" name="__codelineno-6-20"></a>
</span><span id="__span-6-21"><a href="#__codelineno-6-21" id="__codelineno-6-21" name="__codelineno-6-21"></a><span class="w">    </span><span class="nx">gcm</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">cipher</span><span class="p">.</span><span class="nx">NewGCM</span><span class="p">(</span><span class="nx">block</span><span class="p">)</span>
</span><span id="__span-6-22"><a href="#__codelineno-6-22" id="__codelineno-6-22" name="__codelineno-6-22"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-23"><a href="#__codelineno-6-23" id="__codelineno-6-23" name="__codelineno-6-23"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">err</span>
</span><span id="__span-6-24"><a href="#__codelineno-6-24" id="__codelineno-6-24" name="__codelineno-6-24"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-6-25"><a href="#__codelineno-6-25" id="__codelineno-6-25" name="__codelineno-6-25"></a>
</span><span id="__span-6-26"><a href="#__codelineno-6-26" id="__codelineno-6-26" name="__codelineno-6-26"></a><span class="w">    </span><span class="nx">nonce</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span><span class="w"> </span><span class="nx">gcm</span><span class="p">.</span><span class="nx">NonceSize</span><span class="p">())</span>
</span><span id="__span-6-27"><a href="#__codelineno-6-27" id="__codelineno-6-27" name="__codelineno-6-27"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">_</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">rand</span><span class="p">.</span><span class="nx">Read</span><span class="p">(</span><span class="nx">nonce</span><span class="p">);</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-6-28"><a href="#__codelineno-6-28" id="__codelineno-6-28" name="__codelineno-6-28"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">err</span>
</span><span id="__span-6-29"><a href="#__codelineno-6-29" id="__codelineno-6-29" name="__codelineno-6-29"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-6-30"><a href="#__codelineno-6-30" id="__codelineno-6-30" name="__codelineno-6-30"></a>
</span><span id="__span-6-31"><a href="#__codelineno-6-31" id="__codelineno-6-31" name="__codelineno-6-31"></a><span class="w">    </span><span class="nx">ciphertext</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">gcm</span><span class="p">.</span><span class="nx">Seal</span><span class="p">(</span><span class="nx">nonce</span><span class="p">,</span><span class="w"> </span><span class="nx">nonce</span><span class="p">,</span><span class="w"> </span><span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">plaintext</span><span class="p">),</span><span class="w"> </span><span class="kc">nil</span><span class="p">)</span>
</span><span id="__span-6-32"><a href="#__codelineno-6-32" id="__codelineno-6-32" name="__codelineno-6-32"></a><span class="w">    </span><span class="nx">e</span><span class="p">.</span><span class="nx">Encrypted</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">base64</span><span class="p">.</span><span class="nx">StdEncoding</span><span class="p">.</span><span class="nx">EncodeToString</span><span class="p">(</span><span class="nx">ciphertext</span><span class="p">)</span>
</span><span id="__span-6-33"><a href="#__codelineno-6-33" id="__codelineno-6-33" name="__codelineno-6-33"></a><span class="w">    </span><span class="nx">e</span><span class="p">.</span><span class="nx">KeyID</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">keyID</span>
</span><span id="__span-6-34"><a href="#__codelineno-6-34" id="__codelineno-6-34" name="__codelineno-6-34"></a><span class="w">    </span><span class="nx">e</span><span class="p">.</span><span class="nx">Algorithm</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"AES-256-GCM"</span>
</span><span id="__span-6-35"><a href="#__codelineno-6-35" id="__codelineno-6-35" name="__codelineno-6-35"></a><span class="w">    </span><span class="nx">e</span><span class="p">.</span><span class="nx">CreatedAt</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Now</span><span class="p">()</span>
</span><span id="__span-6-36"><a href="#__codelineno-6-36" id="__codelineno-6-36" name="__codelineno-6-36"></a>
</span><span id="__span-6-37"><a href="#__codelineno-6-37" id="__codelineno-6-37" name="__codelineno-6-37"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span>
</span><span id="__span-6-38"><a href="#__codelineno-6-38" id="__codelineno-6-38" name="__codelineno-6-38"></a><span class="p">}</span>
</span></code></pre></div> <h4 id="file-system-encryption">File System Encryption<a class="headerlink" href="#file-system-encryption" title="Permanent link">¬∂</a></h4> <ul> <li><strong>Volume Encryption</strong>: LUKS for Linux, FileVault for macOS</li> <li><strong>Application Data</strong>: Encrypted application logs and temporary files</li> <li><strong>Backup Encryption</strong>: All backups encrypted with separate keys</li> </ul> <h3 id="encryption-in-transit">Encryption in Transit<a class="headerlink" href="#encryption-in-transit" title="Permanent link">¬∂</a></h3> <h4 id="tls-configuration">TLS Configuration<a class="headerlink" href="#tls-configuration" title="Permanent link">¬∂</a></h4> <div class="language-yaml highlight"><pre><span></span><code><span id="__span-7-1"><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="c1"># TLS security configuration</span>
</span><span id="__span-7-2"><a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="nt">tls</span><span class="p">:</span>
</span><span id="__span-7-3"><a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">"1.3"</span><span class="w">                    </span><span class="c1"># Minimum TLS version</span>
</span><span id="__span-7-4"><a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="w">  </span><span class="nt">cipher_suites</span><span class="p">:</span>
</span><span id="__span-7-5"><a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">"TLS_AES_256_GCM_SHA384"</span>
</span><span id="__span-7-6"><a href="#__codelineno-7-6" id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">"TLS_CHACHA20_POLY1305_SHA256"</span>
</span><span id="__span-7-7"><a href="#__codelineno-7-7" id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">"TLS_AES_128_GCM_SHA256"</span>
</span><span id="__span-7-8"><a href="#__codelineno-7-8" id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="w">  </span><span class="nt">curves</span><span class="p">:</span>
</span><span id="__span-7-9"><a href="#__codelineno-7-9" id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">"P-256"</span>
</span><span id="__span-7-10"><a href="#__codelineno-7-10" id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">"P-384"</span>
</span><span id="__span-7-11"><a href="#__codelineno-7-11" id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">"X25519"</span>
</span><span id="__span-7-12"><a href="#__codelineno-7-12" id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="w">  </span><span class="nt">prefer_server_cipher_suites</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-7-13"><a href="#__codelineno-7-13" id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="w">  </span><span class="nt">session_timeout</span><span class="p">:</span><span class="w"> </span><span class="s">"24h"</span>
</span><span id="__span-7-14"><a href="#__codelineno-7-14" id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="w">  </span><span class="nt">session_cache_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span>
</span><span id="__span-7-15"><a href="#__codelineno-7-15" id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="w">  </span><span class="nt">hsts</span><span class="p">:</span>
</span><span id="__span-7-16"><a href="#__codelineno-7-16" id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-7-17"><a href="#__codelineno-7-17" id="__codelineno-7-17" name="__codelineno-7-17"></a><span class="w">    </span><span class="nt">max_age</span><span class="p">:</span><span class="w"> </span><span class="s">"31536000"</span>
</span><span id="__span-7-18"><a href="#__codelineno-7-18" id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="w">    </span><span class="nt">include_subdomains</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-7-19"><a href="#__codelineno-7-19" id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="w">    </span><span class="nt">preload</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span></code></pre></div> <h4 id="certificate-management">Certificate Management<a class="headerlink" href="#certificate-management" title="Permanent link">¬∂</a></h4> <ul> <li><strong>Certificate Authority</strong>: Internal CA for service-to-service communication</li> <li><strong>Certificate Pinning</strong>: Pin certificates in mobile applications</li> <li><strong>Certificate Transparency</strong>: Monitor certificate issuance</li> <li><strong>Automated Renewal</strong>: Automated certificate renewal with Let's Encrypt</li> </ul> <h3 id="key-management">Key Management<a class="headerlink" href="#key-management" title="Permanent link">¬∂</a></h3> <h4 id="key-hierarchy">Key Hierarchy<a class="headerlink" href="#key-hierarchy" title="Permanent link">¬∂</a></h4> <div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a>Root Key (HSM)
</span><span id="__span-8-2"><a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a>‚îú‚îÄ‚îÄ Domain Encryption Key
</span><span id="__span-8-3"><a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a>‚îÇ   ‚îú‚îÄ‚îÄ Database Encryption Key
</span><span id="__span-8-4"><a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a>‚îÇ   ‚îú‚îÄ‚îÄ Application Encryption Key
</span><span id="__span-8-5"><a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a>‚îÇ   ‚îî‚îÄ‚îÄ Backup Encryption Key
</span><span id="__span-8-6"><a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a>‚îú‚îÄ‚îÄ JWT Signing Key
</span><span id="__span-8-7"><a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a>‚îÇ   ‚îú‚îÄ‚îÄ Access Token Key
</span><span id="__span-8-8"><a href="#__codelineno-8-8" id="__codelineno-8-8" name="__codelineno-8-8"></a>‚îÇ   ‚îî‚îÄ‚îÄ Refresh Token Key
</span><span id="__span-8-9"><a href="#__codelineno-8-9" id="__codelineno-8-9" name="__codelineno-8-9"></a>‚îî‚îÄ‚îÄ TLS Certificate Key
</span><span id="__span-8-10"><a href="#__codelineno-8-10" id="__codelineno-8-10" name="__codelineno-8-10"></a>    ‚îú‚îÄ‚îÄ Server Certificate
</span><span id="__span-8-11"><a href="#__codelineno-8-11" id="__codelineno-8-11" name="__codelineno-8-11"></a>    ‚îî‚îÄ‚îÄ Client Certificate
</span></code></pre></div> <h4 id="key-rotation-policy">Key Rotation Policy<a class="headerlink" href="#key-rotation-policy" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-9-1"><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">KeyRotationPolicy</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-2"><a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a><span class="w">    </span><span class="nx">KeyType</span><span class="w">        </span><span class="kt">string</span><span class="w">        </span><span class="s">`json:"key_type"`</span>
</span><span id="__span-9-3"><a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a><span class="w">    </span><span class="nx">RotationPeriod</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w"> </span><span class="s">`json:"rotation_period"`</span>
</span><span id="__span-9-4"><a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a><span class="w">    </span><span class="nx">GracePeriod</span><span class="w">    </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w"> </span><span class="s">`json:"grace_period"`</span>
</span><span id="__span-9-5"><a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a><span class="w">    </span><span class="nx">MaxKeyAge</span><span class="w">      </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w"> </span><span class="s">`json:"max_key_age"`</span>
</span><span id="__span-9-6"><a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a><span class="w">    </span><span class="nx">NotifyBefore</span><span class="w">   </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w"> </span><span class="s">`json:"notify_before"`</span>
</span><span id="__span-9-7"><a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="p">}</span>
</span><span id="__span-9-8"><a href="#__codelineno-9-8" id="__codelineno-9-8" name="__codelineno-9-8"></a>
</span><span id="__span-9-9"><a href="#__codelineno-9-9" id="__codelineno-9-9" name="__codelineno-9-9"></a><span class="kd">var</span><span class="w"> </span><span class="nx">DefaultKeyPolicies</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">KeyRotationPolicy</span><span class="p">{</span>
</span><span id="__span-9-10"><a href="#__codelineno-9-10" id="__codelineno-9-10" name="__codelineno-9-10"></a><span class="w">    </span><span class="s">"jwt_signing"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-11"><a href="#__codelineno-9-11" id="__codelineno-9-11" name="__codelineno-9-11"></a><span class="w">        </span><span class="nx">KeyType</span><span class="p">:</span><span class="w">        </span><span class="s">"jwt_signing"</span><span class="p">,</span>
</span><span id="__span-9-12"><a href="#__codelineno-9-12" id="__codelineno-9-12" name="__codelineno-9-12"></a><span class="w">        </span><span class="nx">RotationPeriod</span><span class="p">:</span><span class="w"> </span><span class="mi">90</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Hour</span><span class="p">,</span><span class="w">  </span><span class="c1">// 90 days</span>
</span><span id="__span-9-13"><a href="#__codelineno-9-13" id="__codelineno-9-13" name="__codelineno-9-13"></a><span class="w">        </span><span class="nx">GracePeriod</span><span class="p">:</span><span class="w">    </span><span class="mi">7</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Hour</span><span class="p">,</span><span class="w">   </span><span class="c1">// 7 days</span>
</span><span id="__span-9-14"><a href="#__codelineno-9-14" id="__codelineno-9-14" name="__codelineno-9-14"></a><span class="w">        </span><span class="nx">MaxKeyAge</span><span class="p">:</span><span class="w">      </span><span class="mi">180</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Hour</span><span class="p">,</span><span class="w"> </span><span class="c1">// 180 days</span>
</span><span id="__span-9-15"><a href="#__codelineno-9-15" id="__codelineno-9-15" name="__codelineno-9-15"></a><span class="w">        </span><span class="nx">NotifyBefore</span><span class="p">:</span><span class="w">   </span><span class="mi">14</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Hour</span><span class="p">,</span><span class="w">  </span><span class="c1">// 14 days</span>
</span><span id="__span-9-16"><a href="#__codelineno-9-16" id="__codelineno-9-16" name="__codelineno-9-16"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-9-17"><a href="#__codelineno-9-17" id="__codelineno-9-17" name="__codelineno-9-17"></a><span class="w">    </span><span class="s">"database_encryption"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-18"><a href="#__codelineno-9-18" id="__codelineno-9-18" name="__codelineno-9-18"></a><span class="w">        </span><span class="nx">KeyType</span><span class="p">:</span><span class="w">        </span><span class="s">"database_encryption"</span><span class="p">,</span>
</span><span id="__span-9-19"><a href="#__codelineno-9-19" id="__codelineno-9-19" name="__codelineno-9-19"></a><span class="w">        </span><span class="nx">RotationPeriod</span><span class="p">:</span><span class="w"> </span><span class="mi">365</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Hour</span><span class="p">,</span><span class="w"> </span><span class="c1">// 1 year</span>
</span><span id="__span-9-20"><a href="#__codelineno-9-20" id="__codelineno-9-20" name="__codelineno-9-20"></a><span class="w">        </span><span class="nx">GracePeriod</span><span class="p">:</span><span class="w">    </span><span class="mi">30</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Hour</span><span class="p">,</span><span class="w">  </span><span class="c1">// 30 days</span>
</span><span id="__span-9-21"><a href="#__codelineno-9-21" id="__codelineno-9-21" name="__codelineno-9-21"></a><span class="w">        </span><span class="nx">MaxKeyAge</span><span class="p">:</span><span class="w">      </span><span class="mi">730</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Hour</span><span class="p">,</span><span class="w"> </span><span class="c1">// 2 years</span>
</span><span id="__span-9-22"><a href="#__codelineno-9-22" id="__codelineno-9-22" name="__codelineno-9-22"></a><span class="w">        </span><span class="nx">NotifyBefore</span><span class="p">:</span><span class="w">   </span><span class="mi">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Hour</span><span class="p">,</span><span class="w">  </span><span class="c1">// 60 days</span>
</span><span id="__span-9-23"><a href="#__codelineno-9-23" id="__codelineno-9-23" name="__codelineno-9-23"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-9-24"><a href="#__codelineno-9-24" id="__codelineno-9-24" name="__codelineno-9-24"></a><span class="p">}</span>
</span></code></pre></div> <h2 id="device-trust-and-attestation">üõ°Ô∏è Device Trust and Attestation<a class="headerlink" href="#device-trust-and-attestation" title="Permanent link">¬∂</a></h2> <h3 id="device-registration-process">Device Registration Process<a class="headerlink" href="#device-registration-process" title="Permanent link">¬∂</a></h3> <pre class="mermaid"><code>sequenceDiagram
    participant Device
    participant App
    participant DeviceService
    participant SPIRE
    participant TPM
    participant CA

    Device-&gt;&gt;App: Device Registration Request
    App-&gt;&gt;TPM: Generate Key Pair
    TPM--&gt;&gt;App: Public/Private Key
    App-&gt;&gt;DeviceService: Registration Request + Public Key
    DeviceService-&gt;&gt;DeviceService: Validate Device Info
    DeviceService-&gt;&gt;SPIRE: Request SVID
    SPIRE-&gt;&gt;CA: Sign Certificate
    CA--&gt;&gt;SPIRE: Device Certificate
    SPIRE--&gt;&gt;DeviceService: SVID + Certificate
    DeviceService--&gt;&gt;App: Registration Success + Certificate
    App--&gt;&gt;Device: Device Registered</code></pre> <h3 id="hardware-attestation">Hardware Attestation<a class="headerlink" href="#hardware-attestation" title="Permanent link">¬∂</a></h3> <h4 id="tpm-based-attestation">TPM-based Attestation<a class="headerlink" href="#tpm-based-attestation" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-10-1"><a href="#__codelineno-10-1" id="__codelineno-10-1" name="__codelineno-10-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">AttestationRequest</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-2"><a href="#__codelineno-10-2" id="__codelineno-10-2" name="__codelineno-10-2"></a><span class="w">    </span><span class="nx">DeviceID</span><span class="w">        </span><span class="kt">string</span><span class="w">    </span><span class="s">`json:"device_id"`</span>
</span><span id="__span-10-3"><a href="#__codelineno-10-3" id="__codelineno-10-3" name="__codelineno-10-3"></a><span class="w">    </span><span class="nx">Platform</span><span class="w">        </span><span class="kt">string</span><span class="w">    </span><span class="s">`json:"platform"`</span><span class="w">          </span><span class="c1">// Windows, macOS, Linux, iOS, Android</span>
</span><span id="__span-10-4"><a href="#__codelineno-10-4" id="__codelineno-10-4" name="__codelineno-10-4"></a><span class="w">    </span><span class="nx">TPMVersion</span><span class="w">      </span><span class="kt">string</span><span class="w">    </span><span class="s">`json:"tpm_version"`</span><span class="w">        </span><span class="c1">// TPM 2.0</span>
</span><span id="__span-10-5"><a href="#__codelineno-10-5" id="__codelineno-10-5" name="__codelineno-10-5"></a><span class="w">    </span><span class="nx">PCRMeasurements</span><span class="w"> </span><span class="p">[]</span><span class="nx">PCR</span><span class="w">     </span><span class="s">`json:"pcr_measurements"`</span><span class="w">   </span><span class="c1">// Platform Configuration Registers</span>
</span><span id="__span-10-6"><a href="#__codelineno-10-6" id="__codelineno-10-6" name="__codelineno-10-6"></a><span class="w">    </span><span class="nx">Quote</span><span class="w">           </span><span class="kt">string</span><span class="w">    </span><span class="s">`json:"quote"`</span><span class="w">              </span><span class="c1">// TPM Quote</span>
</span><span id="__span-10-7"><a href="#__codelineno-10-7" id="__codelineno-10-7" name="__codelineno-10-7"></a><span class="w">    </span><span class="nx">Signature</span><span class="w">       </span><span class="kt">string</span><span class="w">    </span><span class="s">`json:"signature"`</span><span class="w">          </span><span class="c1">// Quote signature</span>
</span><span id="__span-10-8"><a href="#__codelineno-10-8" id="__codelineno-10-8" name="__codelineno-10-8"></a><span class="w">    </span><span class="nx">Certificate</span><span class="w">     </span><span class="kt">string</span><span class="w">    </span><span class="s">`json:"certificate"`</span><span class="w">        </span><span class="c1">// AIK certificate</span>
</span><span id="__span-10-9"><a href="#__codelineno-10-9" id="__codelineno-10-9" name="__codelineno-10-9"></a><span class="w">    </span><span class="nx">Timestamp</span><span class="w">       </span><span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="w"> </span><span class="s">`json:"timestamp"`</span>
</span><span id="__span-10-10"><a href="#__codelineno-10-10" id="__codelineno-10-10" name="__codelineno-10-10"></a><span class="p">}</span>
</span><span id="__span-10-11"><a href="#__codelineno-10-11" id="__codelineno-10-11" name="__codelineno-10-11"></a>
</span><span id="__span-10-12"><a href="#__codelineno-10-12" id="__codelineno-10-12" name="__codelineno-10-12"></a><span class="kd">type</span><span class="w"> </span><span class="nx">PCR</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-13"><a href="#__codelineno-10-13" id="__codelineno-10-13" name="__codelineno-10-13"></a><span class="w">    </span><span class="nx">Index</span><span class="w">  </span><span class="kt">int</span><span class="w">    </span><span class="s">`json:"index"`</span>
</span><span id="__span-10-14"><a href="#__codelineno-10-14" id="__codelineno-10-14" name="__codelineno-10-14"></a><span class="w">    </span><span class="nx">Value</span><span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"value"`</span><span class="w">  </span><span class="c1">// SHA-256 hash</span>
</span><span id="__span-10-15"><a href="#__codelineno-10-15" id="__codelineno-10-15" name="__codelineno-10-15"></a><span class="w">    </span><span class="nx">Bank</span><span class="w">   </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"bank"`</span><span class="w">   </span><span class="c1">// Hash algorithm</span>
</span><span id="__span-10-16"><a href="#__codelineno-10-16" id="__codelineno-10-16" name="__codelineno-10-16"></a><span class="p">}</span>
</span><span id="__span-10-17"><a href="#__codelineno-10-17" id="__codelineno-10-17" name="__codelineno-10-17"></a>
</span><span id="__span-10-18"><a href="#__codelineno-10-18" id="__codelineno-10-18" name="__codelineno-10-18"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">a</span><span class="w"> </span><span class="o">*</span><span class="nx">AttestationService</span><span class="p">)</span><span class="w"> </span><span class="nx">VerifyTPMAttestation</span><span class="p">(</span><span class="nx">req</span><span class="w"> </span><span class="o">*</span><span class="nx">AttestationRequest</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="nx">AttestationResult</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-19"><a href="#__codelineno-10-19" id="__codelineno-10-19" name="__codelineno-10-19"></a><span class="w">    </span><span class="c1">// 1. Verify TPM quote signature</span>
</span><span id="__span-10-20"><a href="#__codelineno-10-20" id="__codelineno-10-20" name="__codelineno-10-20"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">verifyQuoteSignature</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">Quote</span><span class="p">,</span><span class="w"> </span><span class="nx">req</span><span class="p">.</span><span class="nx">Signature</span><span class="p">,</span><span class="w"> </span><span class="nx">req</span><span class="p">.</span><span class="nx">Certificate</span><span class="p">);</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-21"><a href="#__codelineno-10-21" id="__codelineno-10-21" name="__codelineno-10-21"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">"invalid quote signature: %w"</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
</span><span id="__span-10-22"><a href="#__codelineno-10-22" id="__codelineno-10-22" name="__codelineno-10-22"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-10-23"><a href="#__codelineno-10-23" id="__codelineno-10-23" name="__codelineno-10-23"></a>
</span><span id="__span-10-24"><a href="#__codelineno-10-24" id="__codelineno-10-24" name="__codelineno-10-24"></a><span class="w">    </span><span class="c1">// 2. Validate PCR measurements against known good values</span>
</span><span id="__span-10-25"><a href="#__codelineno-10-25" id="__codelineno-10-25" name="__codelineno-10-25"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">validatePCRMeasurements</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">PCRMeasurements</span><span class="p">);</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-26"><a href="#__codelineno-10-26" id="__codelineno-10-26" name="__codelineno-10-26"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">"invalid PCR measurements: %w"</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
</span><span id="__span-10-27"><a href="#__codelineno-10-27" id="__codelineno-10-27" name="__codelineno-10-27"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-10-28"><a href="#__codelineno-10-28" id="__codelineno-10-28" name="__codelineno-10-28"></a>
</span><span id="__span-10-29"><a href="#__codelineno-10-29" id="__codelineno-10-29" name="__codelineno-10-29"></a><span class="w">    </span><span class="c1">// 3. Check certificate chain</span>
</span><span id="__span-10-30"><a href="#__codelineno-10-30" id="__codelineno-10-30" name="__codelineno-10-30"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">validateCertificateChain</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">Certificate</span><span class="p">);</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-31"><a href="#__codelineno-10-31" id="__codelineno-10-31" name="__codelineno-10-31"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">"invalid certificate chain: %w"</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="p">)</span>
</span><span id="__span-10-32"><a href="#__codelineno-10-32" id="__codelineno-10-32" name="__codelineno-10-32"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-10-33"><a href="#__codelineno-10-33" id="__codelineno-10-33" name="__codelineno-10-33"></a>
</span><span id="__span-10-34"><a href="#__codelineno-10-34" id="__codelineno-10-34" name="__codelineno-10-34"></a><span class="w">    </span><span class="c1">// 4. Calculate trust score</span>
</span><span id="__span-10-35"><a href="#__codelineno-10-35" id="__codelineno-10-35" name="__codelineno-10-35"></a><span class="w">    </span><span class="nx">trustScore</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">a</span><span class="p">.</span><span class="nx">calculateDeviceTrustScore</span><span class="p">(</span><span class="nx">req</span><span class="p">)</span>
</span><span id="__span-10-36"><a href="#__codelineno-10-36" id="__codelineno-10-36" name="__codelineno-10-36"></a>
</span><span id="__span-10-37"><a href="#__codelineno-10-37" id="__codelineno-10-37" name="__codelineno-10-37"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="o">&amp;</span><span class="nx">AttestationResult</span><span class="p">{</span>
</span><span id="__span-10-38"><a href="#__codelineno-10-38" id="__codelineno-10-38" name="__codelineno-10-38"></a><span class="w">        </span><span class="nx">DeviceID</span><span class="p">:</span><span class="w">    </span><span class="nx">req</span><span class="p">.</span><span class="nx">DeviceID</span><span class="p">,</span>
</span><span id="__span-10-39"><a href="#__codelineno-10-39" id="__codelineno-10-39" name="__codelineno-10-39"></a><span class="w">        </span><span class="nx">Verified</span><span class="p">:</span><span class="w">    </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-10-40"><a href="#__codelineno-10-40" id="__codelineno-10-40" name="__codelineno-10-40"></a><span class="w">        </span><span class="nx">TrustScore</span><span class="p">:</span><span class="w">  </span><span class="nx">trustScore</span><span class="p">,</span>
</span><span id="__span-10-41"><a href="#__codelineno-10-41" id="__codelineno-10-41" name="__codelineno-10-41"></a><span class="w">        </span><span class="nx">ValidUntil</span><span class="p">:</span><span class="w">  </span><span class="nx">time</span><span class="p">.</span><span class="nx">Now</span><span class="p">().</span><span class="nx">Add</span><span class="p">(</span><span class="mi">24</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Hour</span><span class="p">),</span>
</span><span id="__span-10-42"><a href="#__codelineno-10-42" id="__codelineno-10-42" name="__codelineno-10-42"></a><span class="w">        </span><span class="nx">Attestation</span><span class="p">:</span><span class="w"> </span><span class="nx">req</span><span class="p">,</span>
</span><span id="__span-10-43"><a href="#__codelineno-10-43" id="__codelineno-10-43" name="__codelineno-10-43"></a><span class="w">    </span><span class="p">},</span><span class="w"> </span><span class="kc">nil</span>
</span><span id="__span-10-44"><a href="#__codelineno-10-44" id="__codelineno-10-44" name="__codelineno-10-44"></a><span class="p">}</span>
</span></code></pre></div> <h4 id="mobile-device-attestation">Mobile Device Attestation<a class="headerlink" href="#mobile-device-attestation" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-11-1"><a href="#__codelineno-11-1" id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="c1">// iOS DeviceCheck and Android SafetyNet integration</span>
</span><span id="__span-11-2"><a href="#__codelineno-11-2" id="__codelineno-11-2" name="__codelineno-11-2"></a><span class="kd">type</span><span class="w"> </span><span class="nx">MobileAttestationRequest</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-3"><a href="#__codelineno-11-3" id="__codelineno-11-3" name="__codelineno-11-3"></a><span class="w">    </span><span class="nx">DeviceID</span><span class="w">          </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"device_id"`</span>
</span><span id="__span-11-4"><a href="#__codelineno-11-4" id="__codelineno-11-4" name="__codelineno-11-4"></a><span class="w">    </span><span class="nx">Platform</span><span class="w">          </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"platform"`</span><span class="w">           </span><span class="c1">// ios, android</span>
</span><span id="__span-11-5"><a href="#__codelineno-11-5" id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="w">    </span><span class="nx">AttestationToken</span><span class="w">  </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"attestation_token"`</span><span class="w">   </span><span class="c1">// Platform-specific token</span>
</span><span id="__span-11-6"><a href="#__codelineno-11-6" id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="w">    </span><span class="nx">AppBundleID</span><span class="w">       </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"app_bundle_id"`</span><span class="w">      </span><span class="c1">// App identifier</span>
</span><span id="__span-11-7"><a href="#__codelineno-11-7" id="__codelineno-11-7" name="__codelineno-11-7"></a><span class="w">    </span><span class="nx">AppVersion</span><span class="w">        </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"app_version"`</span><span class="w">        </span><span class="c1">// App version</span>
</span><span id="__span-11-8"><a href="#__codelineno-11-8" id="__codelineno-11-8" name="__codelineno-11-8"></a><span class="w">    </span><span class="nx">DeviceModel</span><span class="w">       </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"device_model"`</span><span class="w">       </span><span class="c1">// Device model</span>
</span><span id="__span-11-9"><a href="#__codelineno-11-9" id="__codelineno-11-9" name="__codelineno-11-9"></a><span class="w">    </span><span class="nx">OSVersion</span><span class="w">         </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"os_version"`</span><span class="w">         </span><span class="c1">// OS version</span>
</span><span id="__span-11-10"><a href="#__codelineno-11-10" id="__codelineno-11-10" name="__codelineno-11-10"></a><span class="w">    </span><span class="nx">JailbrokenRooted</span><span class="w">  </span><span class="kt">bool</span><span class="w">   </span><span class="s">`json:"jailbroken_rooted"`</span><span class="w">  </span><span class="c1">// Security status</span>
</span><span id="__span-11-11"><a href="#__codelineno-11-11" id="__codelineno-11-11" name="__codelineno-11-11"></a><span class="p">}</span>
</span></code></pre></div> <h3 id="trust-level-assessment">Trust Level Assessment<a class="headerlink" href="#trust-level-assessment" title="Permanent link">¬∂</a></h3> <h4 id="device-trust-factors">Device Trust Factors<a class="headerlink" href="#device-trust-factors" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-12-1"><a href="#__codelineno-12-1" id="__codelineno-12-1" name="__codelineno-12-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">DeviceTrustFactors</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-2"><a href="#__codelineno-12-2" id="__codelineno-12-2" name="__codelineno-12-2"></a><span class="w">    </span><span class="c1">// Hardware Security</span>
</span><span id="__span-12-3"><a href="#__codelineno-12-3" id="__codelineno-12-3" name="__codelineno-12-3"></a><span class="w">    </span><span class="nx">TPMPresent</span><span class="w">        </span><span class="kt">bool</span><span class="w">    </span><span class="s">`json:"tpm_present"`</span>
</span><span id="__span-12-4"><a href="#__codelineno-12-4" id="__codelineno-12-4" name="__codelineno-12-4"></a><span class="w">    </span><span class="nx">SecureBootEnabled</span><span class="w"> </span><span class="kt">bool</span><span class="w">    </span><span class="s">`json:"secure_boot_enabled"`</span>
</span><span id="__span-12-5"><a href="#__codelineno-12-5" id="__codelineno-12-5" name="__codelineno-12-5"></a><span class="w">    </span><span class="nx">HardwareIntegrity</span><span class="w"> </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"hardware_integrity"`</span><span class="w">    </span><span class="c1">// 0.0 - 1.0</span>
</span><span id="__span-12-6"><a href="#__codelineno-12-6" id="__codelineno-12-6" name="__codelineno-12-6"></a>
</span><span id="__span-12-7"><a href="#__codelineno-12-7" id="__codelineno-12-7" name="__codelineno-12-7"></a><span class="w">    </span><span class="c1">// Software Security</span>
</span><span id="__span-12-8"><a href="#__codelineno-12-8" id="__codelineno-12-8" name="__codelineno-12-8"></a><span class="w">    </span><span class="nx">OSVersion</span><span class="w">         </span><span class="kt">string</span><span class="w">  </span><span class="s">`json:"os_version"`</span>
</span><span id="__span-12-9"><a href="#__codelineno-12-9" id="__codelineno-12-9" name="__codelineno-12-9"></a><span class="w">    </span><span class="nx">SecurityPatches</span><span class="w">   </span><span class="kt">bool</span><span class="w">    </span><span class="s">`json:"security_patches"`</span>
</span><span id="__span-12-10"><a href="#__codelineno-12-10" id="__codelineno-12-10" name="__codelineno-12-10"></a><span class="w">    </span><span class="nx">AntivirusActive</span><span class="w">   </span><span class="kt">bool</span><span class="w">    </span><span class="s">`json:"antivirus_active"`</span>
</span><span id="__span-12-11"><a href="#__codelineno-12-11" id="__codelineno-12-11" name="__codelineno-12-11"></a><span class="w">    </span><span class="nx">SoftwareIntegrity</span><span class="w"> </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"software_integrity"`</span><span class="w">    </span><span class="c1">// 0.0 - 1.0</span>
</span><span id="__span-12-12"><a href="#__codelineno-12-12" id="__codelineno-12-12" name="__codelineno-12-12"></a>
</span><span id="__span-12-13"><a href="#__codelineno-12-13" id="__codelineno-12-13" name="__codelineno-12-13"></a><span class="w">    </span><span class="c1">// Behavioral Factors</span>
</span><span id="__span-12-14"><a href="#__codelineno-12-14" id="__codelineno-12-14" name="__codelineno-12-14"></a><span class="w">    </span><span class="nx">UsagePattern</span><span class="w">      </span><span class="kt">string</span><span class="w">  </span><span class="s">`json:"usage_pattern"`</span><span class="w">         </span><span class="c1">// normal, suspicious, unknown</span>
</span><span id="__span-12-15"><a href="#__codelineno-12-15" id="__codelineno-12-15" name="__codelineno-12-15"></a><span class="w">    </span><span class="nx">LocationPattern</span><span class="w">   </span><span class="kt">string</span><span class="w">  </span><span class="s">`json:"location_pattern"`</span><span class="w">      </span><span class="c1">// consistent, variable, anomalous</span>
</span><span id="__span-12-16"><a href="#__codelineno-12-16" id="__codelineno-12-16" name="__codelineno-12-16"></a><span class="w">    </span><span class="nx">AccessPattern</span><span class="w">     </span><span class="kt">string</span><span class="w">  </span><span class="s">`json:"access_pattern"`</span><span class="w">        </span><span class="c1">// regular, irregular, unusual</span>
</span><span id="__span-12-17"><a href="#__codelineno-12-17" id="__codelineno-12-17" name="__codelineno-12-17"></a>
</span><span id="__span-12-18"><a href="#__codelineno-12-18" id="__codelineno-12-18" name="__codelineno-12-18"></a><span class="w">    </span><span class="c1">// Risk Factors</span>
</span><span id="__span-12-19"><a href="#__codelineno-12-19" id="__codelineno-12-19" name="__codelineno-12-19"></a><span class="w">    </span><span class="nx">CompromiseHistory</span><span class="w"> </span><span class="kt">bool</span><span class="w">    </span><span class="s">`json:"compromise_history"`</span>
</span><span id="__span-12-20"><a href="#__codelineno-12-20" id="__codelineno-12-20" name="__codelineno-12-20"></a><span class="w">    </span><span class="nx">PolicyCompliance</span><span class="w">  </span><span class="kt">bool</span><span class="w">    </span><span class="s">`json:"policy_compliance"`</span>
</span><span id="__span-12-21"><a href="#__codelineno-12-21" id="__codelineno-12-21" name="__codelineno-12-21"></a><span class="w">    </span><span class="nx">LastVerification</span><span class="w">  </span><span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="w"> </span><span class="s">`json:"last_verification"`</span>
</span><span id="__span-12-22"><a href="#__codelineno-12-22" id="__codelineno-12-22" name="__codelineno-12-22"></a><span class="p">}</span>
</span></code></pre></div> <h2 id="security-monitoring-and-auditing">üîç Security Monitoring and Auditing<a class="headerlink" href="#security-monitoring-and-auditing" title="Permanent link">¬∂</a></h2> <h3 id="security-events">Security Events<a class="headerlink" href="#security-events" title="Permanent link">¬∂</a></h3> <h4 id="event-types">Event Types<a class="headerlink" href="#event-types" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-13-1"><a href="#__codelineno-13-1" id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="kt">string</span>
</span><span id="__span-13-2"><a href="#__codelineno-13-2" id="__codelineno-13-2" name="__codelineno-13-2"></a>
</span><span id="__span-13-3"><a href="#__codelineno-13-3" id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="kd">const</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-13-4"><a href="#__codelineno-13-4" id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="w">    </span><span class="c1">// Authentication Events</span>
</span><span id="__span-13-5"><a href="#__codelineno-13-5" id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="w">    </span><span class="nx">EventLoginSuccess</span><span class="w">        </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"auth.login.success"</span>
</span><span id="__span-13-6"><a href="#__codelineno-13-6" id="__codelineno-13-6" name="__codelineno-13-6"></a><span class="w">    </span><span class="nx">EventLoginFailure</span><span class="w">        </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"auth.login.failure"</span>
</span><span id="__span-13-7"><a href="#__codelineno-13-7" id="__codelineno-13-7" name="__codelineno-13-7"></a><span class="w">    </span><span class="nx">EventPasswordChange</span><span class="w">      </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"auth.password.change"</span>
</span><span id="__span-13-8"><a href="#__codelineno-13-8" id="__codelineno-13-8" name="__codelineno-13-8"></a><span class="w">    </span><span class="nx">EventTokenRefresh</span><span class="w">        </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"auth.token.refresh"</span>
</span><span id="__span-13-9"><a href="#__codelineno-13-9" id="__codelineno-13-9" name="__codelineno-13-9"></a><span class="w">    </span><span class="nx">EventLogout</span><span class="w">              </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"auth.logout"</span>
</span><span id="__span-13-10"><a href="#__codelineno-13-10" id="__codelineno-13-10" name="__codelineno-13-10"></a>
</span><span id="__span-13-11"><a href="#__codelineno-13-11" id="__codelineno-13-11" name="__codelineno-13-11"></a><span class="w">    </span><span class="c1">// Authorization Events</span>
</span><span id="__span-13-12"><a href="#__codelineno-13-12" id="__codelineno-13-12" name="__codelineno-13-12"></a><span class="w">    </span><span class="nx">EventAccessGranted</span><span class="w">       </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"authz.access.granted"</span>
</span><span id="__span-13-13"><a href="#__codelineno-13-13" id="__codelineno-13-13" name="__codelineno-13-13"></a><span class="w">    </span><span class="nx">EventAccessDenied</span><span class="w">        </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"authz.access.denied"</span>
</span><span id="__span-13-14"><a href="#__codelineno-13-14" id="__codelineno-13-14" name="__codelineno-13-14"></a><span class="w">    </span><span class="nx">EventPrivilegeEscalation</span><span class="w"> </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"authz.privilege.escalation"</span>
</span><span id="__span-13-15"><a href="#__codelineno-13-15" id="__codelineno-13-15" name="__codelineno-13-15"></a><span class="w">    </span><span class="nx">EventRoleChange</span><span class="w">          </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"authz.role.change"</span>
</span><span id="__span-13-16"><a href="#__codelineno-13-16" id="__codelineno-13-16" name="__codelineno-13-16"></a>
</span><span id="__span-13-17"><a href="#__codelineno-13-17" id="__codelineno-13-17" name="__codelineno-13-17"></a><span class="w">    </span><span class="c1">// Device Events</span>
</span><span id="__span-13-18"><a href="#__codelineno-13-18" id="__codelineno-13-18" name="__codelineno-13-18"></a><span class="w">    </span><span class="nx">EventDeviceRegistered</span><span class="w">    </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"device.registered"</span>
</span><span id="__span-13-19"><a href="#__codelineno-13-19" id="__codelineno-13-19" name="__codelineno-13-19"></a><span class="w">    </span><span class="nx">EventDeviceAttested</span><span class="w">      </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"device.attested"</span>
</span><span id="__span-13-20"><a href="#__codelineno-13-20" id="__codelineno-13-20" name="__codelineno-13-20"></a><span class="w">    </span><span class="nx">EventDeviceCompromised</span><span class="w">   </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"device.compromised"</span>
</span><span id="__span-13-21"><a href="#__codelineno-13-21" id="__codelineno-13-21" name="__codelineno-13-21"></a><span class="w">    </span><span class="nx">EventDeviceRevoked</span><span class="w">       </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"device.revoked"</span>
</span><span id="__span-13-22"><a href="#__codelineno-13-22" id="__codelineno-13-22" name="__codelineno-13-22"></a>
</span><span id="__span-13-23"><a href="#__codelineno-13-23" id="__codelineno-13-23" name="__codelineno-13-23"></a><span class="w">    </span><span class="c1">// Security Events</span>
</span><span id="__span-13-24"><a href="#__codelineno-13-24" id="__codelineno-13-24" name="__codelineno-13-24"></a><span class="w">    </span><span class="nx">EventSuspiciousActivity</span><span class="w">  </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"security.suspicious.activity"</span>
</span><span id="__span-13-25"><a href="#__codelineno-13-25" id="__codelineno-13-25" name="__codelineno-13-25"></a><span class="w">    </span><span class="nx">EventBruteForceAttempt</span><span class="w">   </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"security.brute.force"</span>
</span><span id="__span-13-26"><a href="#__codelineno-13-26" id="__codelineno-13-26" name="__codelineno-13-26"></a><span class="w">    </span><span class="nx">EventAnomalousAccess</span><span class="w">     </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"security.anomalous.access"</span>
</span><span id="__span-13-27"><a href="#__codelineno-13-27" id="__codelineno-13-27" name="__codelineno-13-27"></a><span class="w">    </span><span class="nx">EventSecurityPolicyViolation</span><span class="w"> </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">"security.policy.violation"</span>
</span><span id="__span-13-28"><a href="#__codelineno-13-28" id="__codelineno-13-28" name="__codelineno-13-28"></a><span class="p">)</span>
</span></code></pre></div> <h4 id="security-event-structure">Security Event Structure<a class="headerlink" href="#security-event-structure" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-14-1"><a href="#__codelineno-14-1" id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">SecurityEvent</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-2"><a href="#__codelineno-14-2" id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="w">    </span><span class="nx">ID</span><span class="w">          </span><span class="kt">string</span><span class="w">                 </span><span class="s">`json:"id"`</span>
</span><span id="__span-14-3"><a href="#__codelineno-14-3" id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="w">    </span><span class="nx">Type</span><span class="w">        </span><span class="nx">SecurityEventType</span><span class="w">      </span><span class="s">`json:"type"`</span>
</span><span id="__span-14-4"><a href="#__codelineno-14-4" id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="w">    </span><span class="nx">Timestamp</span><span class="w">   </span><span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="w">             </span><span class="s">`json:"timestamp"`</span>
</span><span id="__span-14-5"><a href="#__codelineno-14-5" id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="w">    </span><span class="nx">UserID</span><span class="w">      </span><span class="kt">string</span><span class="w">                </span><span class="s">`json:"user_id,omitempty"`</span>
</span><span id="__span-14-6"><a href="#__codelineno-14-6" id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="w">    </span><span class="nx">DeviceID</span><span class="w">    </span><span class="kt">string</span><span class="w">                </span><span class="s">`json:"device_id,omitempty"`</span>
</span><span id="__span-14-7"><a href="#__codelineno-14-7" id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="w">    </span><span class="nx">SessionID</span><span class="w">   </span><span class="kt">string</span><span class="w">                </span><span class="s">`json:"session_id,omitempty"`</span>
</span><span id="__span-14-8"><a href="#__codelineno-14-8" id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="w">    </span><span class="nx">Resource</span><span class="w">    </span><span class="kt">string</span><span class="w">                </span><span class="s">`json:"resource,omitempty"`</span>
</span><span id="__span-14-9"><a href="#__codelineno-14-9" id="__codelineno-14-9" name="__codelineno-14-9"></a><span class="w">    </span><span class="nx">Action</span><span class="w">      </span><span class="kt">string</span><span class="w">                </span><span class="s">`json:"action,omitempty"`</span>
</span><span id="__span-14-10"><a href="#__codelineno-14-10" id="__codelineno-14-10" name="__codelineno-14-10"></a><span class="w">    </span><span class="nx">Result</span><span class="w">      </span><span class="kt">string</span><span class="w">                </span><span class="s">`json:"result"`</span><span class="w">              </span><span class="c1">// success, failure, denied</span>
</span><span id="__span-14-11"><a href="#__codelineno-14-11" id="__codelineno-14-11" name="__codelineno-14-11"></a><span class="w">    </span><span class="nx">Severity</span><span class="w">    </span><span class="kt">string</span><span class="w">                </span><span class="s">`json:"severity"`</span><span class="w">            </span><span class="c1">// low, medium, high, critical</span>
</span><span id="__span-14-12"><a href="#__codelineno-14-12" id="__codelineno-14-12" name="__codelineno-14-12"></a><span class="w">    </span><span class="nx">Source</span><span class="w">      </span><span class="nx">EventSource</span><span class="w">           </span><span class="s">`json:"source"`</span>
</span><span id="__span-14-13"><a href="#__codelineno-14-13" id="__codelineno-14-13" name="__codelineno-14-13"></a><span class="w">    </span><span class="nx">Details</span><span class="w">     </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}</span><span class="w"> </span><span class="s">`json:"details"`</span>
</span><span id="__span-14-14"><a href="#__codelineno-14-14" id="__codelineno-14-14" name="__codelineno-14-14"></a><span class="w">    </span><span class="nx">Risk</span><span class="w">        </span><span class="nx">RiskAssessment</span><span class="w">        </span><span class="s">`json:"risk"`</span>
</span><span id="__span-14-15"><a href="#__codelineno-14-15" id="__codelineno-14-15" name="__codelineno-14-15"></a><span class="w">    </span><span class="nx">Response</span><span class="w">    </span><span class="nx">ResponseAction</span><span class="w">        </span><span class="s">`json:"response,omitempty"`</span>
</span><span id="__span-14-16"><a href="#__codelineno-14-16" id="__codelineno-14-16" name="__codelineno-14-16"></a><span class="p">}</span>
</span><span id="__span-14-17"><a href="#__codelineno-14-17" id="__codelineno-14-17" name="__codelineno-14-17"></a>
</span><span id="__span-14-18"><a href="#__codelineno-14-18" id="__codelineno-14-18" name="__codelineno-14-18"></a><span class="kd">type</span><span class="w"> </span><span class="nx">EventSource</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-19"><a href="#__codelineno-14-19" id="__codelineno-14-19" name="__codelineno-14-19"></a><span class="w">    </span><span class="nx">IPAddress</span><span class="w">   </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"ip_address"`</span>
</span><span id="__span-14-20"><a href="#__codelineno-14-20" id="__codelineno-14-20" name="__codelineno-14-20"></a><span class="w">    </span><span class="nx">UserAgent</span><span class="w">   </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"user_agent"`</span>
</span><span id="__span-14-21"><a href="#__codelineno-14-21" id="__codelineno-14-21" name="__codelineno-14-21"></a><span class="w">    </span><span class="nx">Location</span><span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"location"`</span>
</span><span id="__span-14-22"><a href="#__codelineno-14-22" id="__codelineno-14-22" name="__codelineno-14-22"></a><span class="w">    </span><span class="nx">Service</span><span class="w">     </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"service"`</span>
</span><span id="__span-14-23"><a href="#__codelineno-14-23" id="__codelineno-14-23" name="__codelineno-14-23"></a><span class="w">    </span><span class="nx">Component</span><span class="w">   </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"component"`</span>
</span><span id="__span-14-24"><a href="#__codelineno-14-24" id="__codelineno-14-24" name="__codelineno-14-24"></a><span class="p">}</span>
</span><span id="__span-14-25"><a href="#__codelineno-14-25" id="__codelineno-14-25" name="__codelineno-14-25"></a>
</span><span id="__span-14-26"><a href="#__codelineno-14-26" id="__codelineno-14-26" name="__codelineno-14-26"></a><span class="kd">type</span><span class="w"> </span><span class="nx">RiskAssessment</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-27"><a href="#__codelineno-14-27" id="__codelineno-14-27" name="__codelineno-14-27"></a><span class="w">    </span><span class="nx">Score</span><span class="w">       </span><span class="kt">float64</span><span class="w">           </span><span class="s">`json:"score"`</span><span class="w">        </span><span class="c1">// 0.0 - 1.0</span>
</span><span id="__span-14-28"><a href="#__codelineno-14-28" id="__codelineno-14-28" name="__codelineno-14-28"></a><span class="w">    </span><span class="nx">Factors</span><span class="w">     </span><span class="p">[]</span><span class="kt">string</span><span class="w">          </span><span class="s">`json:"factors"`</span>
</span><span id="__span-14-29"><a href="#__codelineno-14-29" id="__codelineno-14-29" name="__codelineno-14-29"></a><span class="w">    </span><span class="nx">Confidence</span><span class="w">  </span><span class="kt">float64</span><span class="w">           </span><span class="s">`json:"confidence"`</span><span class="w">   </span><span class="c1">// 0.0 - 1.0</span>
</span><span id="__span-14-30"><a href="#__codelineno-14-30" id="__codelineno-14-30" name="__codelineno-14-30"></a><span class="w">    </span><span class="nx">Context</span><span class="w">     </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"context"`</span>
</span><span id="__span-14-31"><a href="#__codelineno-14-31" id="__codelineno-14-31" name="__codelineno-14-31"></a><span class="p">}</span>
</span></code></pre></div> <h3 id="real-time-monitoring">Real-time Monitoring<a class="headerlink" href="#real-time-monitoring" title="Permanent link">¬∂</a></h3> <h4 id="anomaly-detection">Anomaly Detection<a class="headerlink" href="#anomaly-detection" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-15-1"><a href="#__codelineno-15-1" id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">AnomalyDetector</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-2"><a href="#__codelineno-15-2" id="__codelineno-15-2" name="__codelineno-15-2"></a><span class="w">    </span><span class="nx">UserBehaviorModels</span><span class="w">    </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="o">*</span><span class="nx">BehaviorModel</span><span class="w"> </span><span class="s">`json:"user_behavior_models"`</span>
</span><span id="__span-15-3"><a href="#__codelineno-15-3" id="__codelineno-15-3" name="__codelineno-15-3"></a><span class="w">    </span><span class="nx">DeviceBehaviorModels</span><span class="w">  </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="o">*</span><span class="nx">BehaviorModel</span><span class="w"> </span><span class="s">`json:"device_behavior_models"`</span>
</span><span id="__span-15-4"><a href="#__codelineno-15-4" id="__codelineno-15-4" name="__codelineno-15-4"></a><span class="w">    </span><span class="nx">NetworkBehaviorModel</span><span class="w">  </span><span class="o">*</span><span class="nx">BehaviorModel</span><span class="w">            </span><span class="s">`json:"network_behavior_model"`</span>
</span><span id="__span-15-5"><a href="#__codelineno-15-5" id="__codelineno-15-5" name="__codelineno-15-5"></a><span class="w">    </span><span class="nx">ThresholdConfig</span><span class="w">       </span><span class="o">*</span><span class="nx">ThresholdConfig</span><span class="w">          </span><span class="s">`json:"threshold_config"`</span>
</span><span id="__span-15-6"><a href="#__codelineno-15-6" id="__codelineno-15-6" name="__codelineno-15-6"></a><span class="p">}</span>
</span><span id="__span-15-7"><a href="#__codelineno-15-7" id="__codelineno-15-7" name="__codelineno-15-7"></a>
</span><span id="__span-15-8"><a href="#__codelineno-15-8" id="__codelineno-15-8" name="__codelineno-15-8"></a><span class="kd">type</span><span class="w"> </span><span class="nx">BehaviorModel</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-9"><a href="#__codelineno-15-9" id="__codelineno-15-9" name="__codelineno-15-9"></a><span class="w">    </span><span class="nx">ID</span><span class="w">                </span><span class="kt">string</span><span class="w">                 </span><span class="s">`json:"id"`</span>
</span><span id="__span-15-10"><a href="#__codelineno-15-10" id="__codelineno-15-10" name="__codelineno-15-10"></a><span class="w">    </span><span class="nx">Type</span><span class="w">              </span><span class="kt">string</span><span class="w">                 </span><span class="s">`json:"type"`</span><span class="w">      </span><span class="c1">// user, device, network</span>
</span><span id="__span-15-11"><a href="#__codelineno-15-11" id="__codelineno-15-11" name="__codelineno-15-11"></a><span class="w">    </span><span class="nx">Features</span><span class="w">          </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">float64</span><span class="w">     </span><span class="s">`json:"features"`</span>
</span><span id="__span-15-12"><a href="#__codelineno-15-12" id="__codelineno-15-12" name="__codelineno-15-12"></a><span class="w">    </span><span class="nx">Baseline</span><span class="w">          </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">Statistics</span><span class="w">  </span><span class="s">`json:"baseline"`</span>
</span><span id="__span-15-13"><a href="#__codelineno-15-13" id="__codelineno-15-13" name="__codelineno-15-13"></a><span class="w">    </span><span class="nx">LastUpdated</span><span class="w">       </span><span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="w">             </span><span class="s">`json:"last_updated"`</span>
</span><span id="__span-15-14"><a href="#__codelineno-15-14" id="__codelineno-15-14" name="__codelineno-15-14"></a><span class="w">    </span><span class="nx">ConfidenceLevel</span><span class="w">   </span><span class="kt">float64</span><span class="w">               </span><span class="s">`json:"confidence_level"`</span>
</span><span id="__span-15-15"><a href="#__codelineno-15-15" id="__codelineno-15-15" name="__codelineno-15-15"></a><span class="p">}</span>
</span><span id="__span-15-16"><a href="#__codelineno-15-16" id="__codelineno-15-16" name="__codelineno-15-16"></a>
</span><span id="__span-15-17"><a href="#__codelineno-15-17" id="__codelineno-15-17" name="__codelineno-15-17"></a><span class="kd">type</span><span class="w"> </span><span class="nx">Statistics</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-18"><a href="#__codelineno-15-18" id="__codelineno-15-18" name="__codelineno-15-18"></a><span class="w">    </span><span class="nx">Mean</span><span class="w">              </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"mean"`</span>
</span><span id="__span-15-19"><a href="#__codelineno-15-19" id="__codelineno-15-19" name="__codelineno-15-19"></a><span class="w">    </span><span class="nx">StdDev</span><span class="w">            </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"std_dev"`</span>
</span><span id="__span-15-20"><a href="#__codelineno-15-20" id="__codelineno-15-20" name="__codelineno-15-20"></a><span class="w">    </span><span class="nx">Min</span><span class="w">               </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"min"`</span>
</span><span id="__span-15-21"><a href="#__codelineno-15-21" id="__codelineno-15-21" name="__codelineno-15-21"></a><span class="w">    </span><span class="nx">Max</span><span class="w">               </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"max"`</span>
</span><span id="__span-15-22"><a href="#__codelineno-15-22" id="__codelineno-15-22" name="__codelineno-15-22"></a><span class="w">    </span><span class="nx">Percentile95</span><span class="w">      </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"percentile_95"`</span>
</span><span id="__span-15-23"><a href="#__codelineno-15-23" id="__codelineno-15-23" name="__codelineno-15-23"></a><span class="w">    </span><span class="nx">SampleCount</span><span class="w">       </span><span class="kt">int64</span><span class="w">   </span><span class="s">`json:"sample_count"`</span>
</span><span id="__span-15-24"><a href="#__codelineno-15-24" id="__codelineno-15-24" name="__codelineno-15-24"></a><span class="p">}</span>
</span><span id="__span-15-25"><a href="#__codelineno-15-25" id="__codelineno-15-25" name="__codelineno-15-25"></a>
</span><span id="__span-15-26"><a href="#__codelineno-15-26" id="__codelineno-15-26" name="__codelineno-15-26"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">ad</span><span class="w"> </span><span class="o">*</span><span class="nx">AnomalyDetector</span><span class="p">)</span><span class="w"> </span><span class="nx">DetectAnomalies</span><span class="p">(</span><span class="nx">event</span><span class="w"> </span><span class="o">*</span><span class="nx">SecurityEvent</span><span class="p">)</span><span class="w"> </span><span class="p">[]</span><span class="nx">Anomaly</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-27"><a href="#__codelineno-15-27" id="__codelineno-15-27" name="__codelineno-15-27"></a><span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="nx">anomalies</span><span class="w"> </span><span class="p">[]</span><span class="nx">Anomaly</span>
</span><span id="__span-15-28"><a href="#__codelineno-15-28" id="__codelineno-15-28" name="__codelineno-15-28"></a>
</span><span id="__span-15-29"><a href="#__codelineno-15-29" id="__codelineno-15-29" name="__codelineno-15-29"></a><span class="w">    </span><span class="c1">// Check user behavior anomalies</span>
</span><span id="__span-15-30"><a href="#__codelineno-15-30" id="__codelineno-15-30" name="__codelineno-15-30"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">model</span><span class="p">,</span><span class="w"> </span><span class="nx">exists</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">ad</span><span class="p">.</span><span class="nx">UserBehaviorModels</span><span class="p">[</span><span class="nx">event</span><span class="p">.</span><span class="nx">UserID</span><span class="p">];</span><span class="w"> </span><span class="nx">exists</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-31"><a href="#__codelineno-15-31" id="__codelineno-15-31" name="__codelineno-15-31"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">anomaly</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">ad</span><span class="p">.</span><span class="nx">checkUserBehavior</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="nx">model</span><span class="p">);</span><span class="w"> </span><span class="nx">anomaly</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-32"><a href="#__codelineno-15-32" id="__codelineno-15-32" name="__codelineno-15-32"></a><span class="w">            </span><span class="nx">anomalies</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">anomalies</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="nx">anomaly</span><span class="p">)</span>
</span><span id="__span-15-33"><a href="#__codelineno-15-33" id="__codelineno-15-33" name="__codelineno-15-33"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-15-34"><a href="#__codelineno-15-34" id="__codelineno-15-34" name="__codelineno-15-34"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-15-35"><a href="#__codelineno-15-35" id="__codelineno-15-35" name="__codelineno-15-35"></a>
</span><span id="__span-15-36"><a href="#__codelineno-15-36" id="__codelineno-15-36" name="__codelineno-15-36"></a><span class="w">    </span><span class="c1">// Check device behavior anomalies</span>
</span><span id="__span-15-37"><a href="#__codelineno-15-37" id="__codelineno-15-37" name="__codelineno-15-37"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">model</span><span class="p">,</span><span class="w"> </span><span class="nx">exists</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">ad</span><span class="p">.</span><span class="nx">DeviceBehaviorModels</span><span class="p">[</span><span class="nx">event</span><span class="p">.</span><span class="nx">DeviceID</span><span class="p">];</span><span class="w"> </span><span class="nx">exists</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-38"><a href="#__codelineno-15-38" id="__codelineno-15-38" name="__codelineno-15-38"></a><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">anomaly</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">ad</span><span class="p">.</span><span class="nx">checkDeviceBehavior</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="nx">model</span><span class="p">);</span><span class="w"> </span><span class="nx">anomaly</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-39"><a href="#__codelineno-15-39" id="__codelineno-15-39" name="__codelineno-15-39"></a><span class="w">            </span><span class="nx">anomalies</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">anomalies</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="nx">anomaly</span><span class="p">)</span>
</span><span id="__span-15-40"><a href="#__codelineno-15-40" id="__codelineno-15-40" name="__codelineno-15-40"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-15-41"><a href="#__codelineno-15-41" id="__codelineno-15-41" name="__codelineno-15-41"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-15-42"><a href="#__codelineno-15-42" id="__codelineno-15-42" name="__codelineno-15-42"></a>
</span><span id="__span-15-43"><a href="#__codelineno-15-43" id="__codelineno-15-43" name="__codelineno-15-43"></a><span class="w">    </span><span class="c1">// Check network behavior anomalies</span>
</span><span id="__span-15-44"><a href="#__codelineno-15-44" id="__codelineno-15-44" name="__codelineno-15-44"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">anomaly</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">ad</span><span class="p">.</span><span class="nx">checkNetworkBehavior</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span><span class="w"> </span><span class="nx">ad</span><span class="p">.</span><span class="nx">NetworkBehaviorModel</span><span class="p">);</span><span class="w"> </span><span class="nx">anomaly</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-45"><a href="#__codelineno-15-45" id="__codelineno-15-45" name="__codelineno-15-45"></a><span class="w">        </span><span class="nx">anomalies</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">anomalies</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="nx">anomaly</span><span class="p">)</span>
</span><span id="__span-15-46"><a href="#__codelineno-15-46" id="__codelineno-15-46" name="__codelineno-15-46"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-15-47"><a href="#__codelineno-15-47" id="__codelineno-15-47" name="__codelineno-15-47"></a>
</span><span id="__span-15-48"><a href="#__codelineno-15-48" id="__codelineno-15-48" name="__codelineno-15-48"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">anomalies</span>
</span><span id="__span-15-49"><a href="#__codelineno-15-49" id="__codelineno-15-49" name="__codelineno-15-49"></a><span class="p">}</span>
</span></code></pre></div> <h4 id="alert-management">Alert Management<a class="headerlink" href="#alert-management" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-16-1"><a href="#__codelineno-16-1" id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">AlertManager</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-2"><a href="#__codelineno-16-2" id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="w">    </span><span class="nx">Rules</span><span class="w">        </span><span class="p">[]</span><span class="nx">AlertRule</span><span class="w">      </span><span class="s">`json:"rules"`</span>
</span><span id="__span-16-3"><a href="#__codelineno-16-3" id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="w">    </span><span class="nx">Channels</span><span class="w">     </span><span class="p">[]</span><span class="nx">AlertChannel</span><span class="w">   </span><span class="s">`json:"channels"`</span>
</span><span id="__span-16-4"><a href="#__codelineno-16-4" id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="w">    </span><span class="nx">Escalation</span><span class="w">   </span><span class="nx">EscalationPolicy</span><span class="w"> </span><span class="s">`json:"escalation"`</span>
</span><span id="__span-16-5"><a href="#__codelineno-16-5" id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="w">    </span><span class="nx">Suppressions</span><span class="w"> </span><span class="p">[]</span><span class="nx">Suppression</span><span class="w">    </span><span class="s">`json:"suppressions"`</span>
</span><span id="__span-16-6"><a href="#__codelineno-16-6" id="__codelineno-16-6" name="__codelineno-16-6"></a><span class="p">}</span>
</span><span id="__span-16-7"><a href="#__codelineno-16-7" id="__codelineno-16-7" name="__codelineno-16-7"></a>
</span><span id="__span-16-8"><a href="#__codelineno-16-8" id="__codelineno-16-8" name="__codelineno-16-8"></a><span class="kd">type</span><span class="w"> </span><span class="nx">AlertRule</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-9"><a href="#__codelineno-16-9" id="__codelineno-16-9" name="__codelineno-16-9"></a><span class="w">    </span><span class="nx">ID</span><span class="w">          </span><span class="kt">string</span><span class="w">            </span><span class="s">`json:"id"`</span>
</span><span id="__span-16-10"><a href="#__codelineno-16-10" id="__codelineno-16-10" name="__codelineno-16-10"></a><span class="w">    </span><span class="nx">Name</span><span class="w">        </span><span class="kt">string</span><span class="w">            </span><span class="s">`json:"name"`</span>
</span><span id="__span-16-11"><a href="#__codelineno-16-11" id="__codelineno-16-11" name="__codelineno-16-11"></a><span class="w">    </span><span class="nx">Description</span><span class="w"> </span><span class="kt">string</span><span class="w">            </span><span class="s">`json:"description"`</span>
</span><span id="__span-16-12"><a href="#__codelineno-16-12" id="__codelineno-16-12" name="__codelineno-16-12"></a><span class="w">    </span><span class="nx">Condition</span><span class="w">   </span><span class="nx">AlertCondition</span><span class="w">    </span><span class="s">`json:"condition"`</span>
</span><span id="__span-16-13"><a href="#__codelineno-16-13" id="__codelineno-16-13" name="__codelineno-16-13"></a><span class="w">    </span><span class="nx">Severity</span><span class="w">    </span><span class="kt">string</span><span class="w">            </span><span class="s">`json:"severity"`</span>
</span><span id="__span-16-14"><a href="#__codelineno-16-14" id="__codelineno-16-14" name="__codelineno-16-14"></a><span class="w">    </span><span class="nx">Enabled</span><span class="w">     </span><span class="kt">bool</span><span class="w">              </span><span class="s">`json:"enabled"`</span>
</span><span id="__span-16-15"><a href="#__codelineno-16-15" id="__codelineno-16-15" name="__codelineno-16-15"></a><span class="w">    </span><span class="nx">Throttle</span><span class="w">    </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w">     </span><span class="s">`json:"throttle"`</span>
</span><span id="__span-16-16"><a href="#__codelineno-16-16" id="__codelineno-16-16" name="__codelineno-16-16"></a><span class="w">    </span><span class="nx">Actions</span><span class="w">     </span><span class="p">[]</span><span class="nx">AlertAction</span><span class="w">     </span><span class="s">`json:"actions"`</span>
</span><span id="__span-16-17"><a href="#__codelineno-16-17" id="__codelineno-16-17" name="__codelineno-16-17"></a><span class="p">}</span>
</span><span id="__span-16-18"><a href="#__codelineno-16-18" id="__codelineno-16-18" name="__codelineno-16-18"></a>
</span><span id="__span-16-19"><a href="#__codelineno-16-19" id="__codelineno-16-19" name="__codelineno-16-19"></a><span class="kd">type</span><span class="w"> </span><span class="nx">AlertCondition</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-20"><a href="#__codelineno-16-20" id="__codelineno-16-20" name="__codelineno-16-20"></a><span class="w">    </span><span class="nx">EventType</span><span class="w">     </span><span class="nx">SecurityEventType</span><span class="w">     </span><span class="s">`json:"event_type"`</span>
</span><span id="__span-16-21"><a href="#__codelineno-16-21" id="__codelineno-16-21" name="__codelineno-16-21"></a><span class="w">    </span><span class="nx">Threshold</span><span class="w">     </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">float64</span><span class="w">    </span><span class="s">`json:"threshold"`</span>
</span><span id="__span-16-22"><a href="#__codelineno-16-22" id="__codelineno-16-22" name="__codelineno-16-22"></a><span class="w">    </span><span class="nx">TimeWindow</span><span class="w">    </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w">         </span><span class="s">`json:"time_window"`</span>
</span><span id="__span-16-23"><a href="#__codelineno-16-23" id="__codelineno-16-23" name="__codelineno-16-23"></a><span class="w">    </span><span class="nx">Aggregation</span><span class="w">   </span><span class="kt">string</span><span class="w">                </span><span class="s">`json:"aggregation"`</span><span class="w">  </span><span class="c1">// count, rate, sum, avg</span>
</span><span id="__span-16-24"><a href="#__codelineno-16-24" id="__codelineno-16-24" name="__codelineno-16-24"></a><span class="w">    </span><span class="nx">Filters</span><span class="w">       </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="w">     </span><span class="s">`json:"filters"`</span>
</span><span id="__span-16-25"><a href="#__codelineno-16-25" id="__codelineno-16-25" name="__codelineno-16-25"></a><span class="p">}</span>
</span></code></pre></div> <h3 id="audit-trail">Audit Trail<a class="headerlink" href="#audit-trail" title="Permanent link">¬∂</a></h3> <h4 id="comprehensive-logging">Comprehensive Logging<a class="headerlink" href="#comprehensive-logging" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-17-1"><a href="#__codelineno-17-1" id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">AuditLog</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-2"><a href="#__codelineno-17-2" id="__codelineno-17-2" name="__codelineno-17-2"></a><span class="w">    </span><span class="nx">ID</span><span class="w">            </span><span class="kt">string</span><span class="w">                 </span><span class="s">`json:"id"`</span>
</span><span id="__span-17-3"><a href="#__codelineno-17-3" id="__codelineno-17-3" name="__codelineno-17-3"></a><span class="w">    </span><span class="nx">Timestamp</span><span class="w">     </span><span class="nx">time</span><span class="p">.</span><span class="nx">Time</span><span class="w">             </span><span class="s">`json:"timestamp"`</span>
</span><span id="__span-17-4"><a href="#__codelineno-17-4" id="__codelineno-17-4" name="__codelineno-17-4"></a><span class="w">    </span><span class="nx">EventType</span><span class="w">     </span><span class="kt">string</span><span class="w">                </span><span class="s">`json:"event_type"`</span>
</span><span id="__span-17-5"><a href="#__codelineno-17-5" id="__codelineno-17-5" name="__codelineno-17-5"></a><span class="w">    </span><span class="nx">Actor</span><span class="w">         </span><span class="nx">AuditActor</span><span class="w">            </span><span class="s">`json:"actor"`</span>
</span><span id="__span-17-6"><a href="#__codelineno-17-6" id="__codelineno-17-6" name="__codelineno-17-6"></a><span class="w">    </span><span class="nx">Target</span><span class="w">        </span><span class="nx">AuditTarget</span><span class="w">           </span><span class="s">`json:"target"`</span>
</span><span id="__span-17-7"><a href="#__codelineno-17-7" id="__codelineno-17-7" name="__codelineno-17-7"></a><span class="w">    </span><span class="nx">Action</span><span class="w">        </span><span class="nx">AuditAction</span><span class="w">           </span><span class="s">`json:"action"`</span>
</span><span id="__span-17-8"><a href="#__codelineno-17-8" id="__codelineno-17-8" name="__codelineno-17-8"></a><span class="w">    </span><span class="nx">Result</span><span class="w">        </span><span class="nx">AuditResult</span><span class="w">           </span><span class="s">`json:"result"`</span>
</span><span id="__span-17-9"><a href="#__codelineno-17-9" id="__codelineno-17-9" name="__codelineno-17-9"></a><span class="w">    </span><span class="nx">Context</span><span class="w">       </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}</span><span class="w"> </span><span class="s">`json:"context"`</span>
</span><span id="__span-17-10"><a href="#__codelineno-17-10" id="__codelineno-17-10" name="__codelineno-17-10"></a><span class="w">    </span><span class="nx">Metadata</span><span class="w">      </span><span class="nx">AuditMetadata</span><span class="w">         </span><span class="s">`json:"metadata"`</span>
</span><span id="__span-17-11"><a href="#__codelineno-17-11" id="__codelineno-17-11" name="__codelineno-17-11"></a><span class="w">    </span><span class="nx">Signature</span><span class="w">     </span><span class="kt">string</span><span class="w">                </span><span class="s">`json:"signature"`</span><span class="w">     </span><span class="c1">// Tamper protection</span>
</span><span id="__span-17-12"><a href="#__codelineno-17-12" id="__codelineno-17-12" name="__codelineno-17-12"></a><span class="p">}</span>
</span><span id="__span-17-13"><a href="#__codelineno-17-13" id="__codelineno-17-13" name="__codelineno-17-13"></a>
</span><span id="__span-17-14"><a href="#__codelineno-17-14" id="__codelineno-17-14" name="__codelineno-17-14"></a><span class="kd">type</span><span class="w"> </span><span class="nx">AuditActor</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-15"><a href="#__codelineno-17-15" id="__codelineno-17-15" name="__codelineno-17-15"></a><span class="w">    </span><span class="nx">Type</span><span class="w">      </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"type"`</span><span class="w">       </span><span class="c1">// user, service, system</span>
</span><span id="__span-17-16"><a href="#__codelineno-17-16" id="__codelineno-17-16" name="__codelineno-17-16"></a><span class="w">    </span><span class="nx">ID</span><span class="w">        </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"id"`</span>
</span><span id="__span-17-17"><a href="#__codelineno-17-17" id="__codelineno-17-17" name="__codelineno-17-17"></a><span class="w">    </span><span class="nx">Name</span><span class="w">      </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"name"`</span>
</span><span id="__span-17-18"><a href="#__codelineno-17-18" id="__codelineno-17-18" name="__codelineno-17-18"></a><span class="w">    </span><span class="nx">IP</span><span class="w">        </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"ip"`</span>
</span><span id="__span-17-19"><a href="#__codelineno-17-19" id="__codelineno-17-19" name="__codelineno-17-19"></a><span class="w">    </span><span class="nx">UserAgent</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"user_agent"`</span>
</span><span id="__span-17-20"><a href="#__codelineno-17-20" id="__codelineno-17-20" name="__codelineno-17-20"></a><span class="w">    </span><span class="nx">Session</span><span class="w">   </span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"session"`</span>
</span><span id="__span-17-21"><a href="#__codelineno-17-21" id="__codelineno-17-21" name="__codelineno-17-21"></a><span class="p">}</span>
</span><span id="__span-17-22"><a href="#__codelineno-17-22" id="__codelineno-17-22" name="__codelineno-17-22"></a>
</span><span id="__span-17-23"><a href="#__codelineno-17-23" id="__codelineno-17-23" name="__codelineno-17-23"></a><span class="kd">type</span><span class="w"> </span><span class="nx">AuditTarget</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-24"><a href="#__codelineno-17-24" id="__codelineno-17-24" name="__codelineno-17-24"></a><span class="w">    </span><span class="nx">Type</span><span class="w">       </span><span class="kt">string</span><span class="w">                 </span><span class="s">`json:"type"`</span><span class="w">        </span><span class="c1">// user, device, policy, system</span>
</span><span id="__span-17-25"><a href="#__codelineno-17-25" id="__codelineno-17-25" name="__codelineno-17-25"></a><span class="w">    </span><span class="nx">ID</span><span class="w">         </span><span class="kt">string</span><span class="w">                 </span><span class="s">`json:"id"`</span>
</span><span id="__span-17-26"><a href="#__codelineno-17-26" id="__codelineno-17-26" name="__codelineno-17-26"></a><span class="w">    </span><span class="nx">Name</span><span class="w">       </span><span class="kt">string</span><span class="w">                 </span><span class="s">`json:"name"`</span>
</span><span id="__span-17-27"><a href="#__codelineno-17-27" id="__codelineno-17-27" name="__codelineno-17-27"></a><span class="w">    </span><span class="nx">Properties</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}</span><span class="w"> </span><span class="s">`json:"properties"`</span>
</span><span id="__span-17-28"><a href="#__codelineno-17-28" id="__codelineno-17-28" name="__codelineno-17-28"></a><span class="p">}</span>
</span><span id="__span-17-29"><a href="#__codelineno-17-29" id="__codelineno-17-29" name="__codelineno-17-29"></a>
</span><span id="__span-17-30"><a href="#__codelineno-17-30" id="__codelineno-17-30" name="__codelineno-17-30"></a><span class="kd">type</span><span class="w"> </span><span class="nx">AuditAction</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-31"><a href="#__codelineno-17-31" id="__codelineno-17-31" name="__codelineno-17-31"></a><span class="w">    </span><span class="nx">Type</span><span class="w">        </span><span class="kt">string</span><span class="w">                 </span><span class="s">`json:"type"`</span><span class="w">         </span><span class="c1">// create, read, update, delete, execute</span>
</span><span id="__span-17-32"><a href="#__codelineno-17-32" id="__codelineno-17-32" name="__codelineno-17-32"></a><span class="w">    </span><span class="nx">Resource</span><span class="w">    </span><span class="kt">string</span><span class="w">                 </span><span class="s">`json:"resource"`</span>
</span><span id="__span-17-33"><a href="#__codelineno-17-33" id="__codelineno-17-33" name="__codelineno-17-33"></a><span class="w">    </span><span class="nx">Method</span><span class="w">      </span><span class="kt">string</span><span class="w">                 </span><span class="s">`json:"method"`</span><span class="w">       </span><span class="c1">// API method or function</span>
</span><span id="__span-17-34"><a href="#__codelineno-17-34" id="__codelineno-17-34" name="__codelineno-17-34"></a><span class="w">    </span><span class="nx">Parameters</span><span class="w">  </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}</span><span class="w"> </span><span class="s">`json:"parameters"`</span>
</span><span id="__span-17-35"><a href="#__codelineno-17-35" id="__codelineno-17-35" name="__codelineno-17-35"></a><span class="p">}</span>
</span><span id="__span-17-36"><a href="#__codelineno-17-36" id="__codelineno-17-36" name="__codelineno-17-36"></a>
</span><span id="__span-17-37"><a href="#__codelineno-17-37" id="__codelineno-17-37" name="__codelineno-17-37"></a><span class="kd">type</span><span class="w"> </span><span class="nx">AuditResult</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-38"><a href="#__codelineno-17-38" id="__codelineno-17-38" name="__codelineno-17-38"></a><span class="w">    </span><span class="nx">Status</span><span class="w">      </span><span class="kt">string</span><span class="w">                 </span><span class="s">`json:"status"`</span><span class="w">       </span><span class="c1">// success, failure, denied</span>
</span><span id="__span-17-39"><a href="#__codelineno-17-39" id="__codelineno-17-39" name="__codelineno-17-39"></a><span class="w">    </span><span class="nx">StatusCode</span><span class="w">  </span><span class="kt">int</span><span class="w">                    </span><span class="s">`json:"status_code"`</span>
</span><span id="__span-17-40"><a href="#__codelineno-17-40" id="__codelineno-17-40" name="__codelineno-17-40"></a><span class="w">    </span><span class="nx">Message</span><span class="w">     </span><span class="kt">string</span><span class="w">                 </span><span class="s">`json:"message"`</span>
</span><span id="__span-17-41"><a href="#__codelineno-17-41" id="__codelineno-17-41" name="__codelineno-17-41"></a><span class="w">    </span><span class="nx">Duration</span><span class="w">    </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w">          </span><span class="s">`json:"duration"`</span>
</span><span id="__span-17-42"><a href="#__codelineno-17-42" id="__codelineno-17-42" name="__codelineno-17-42"></a><span class="w">    </span><span class="nx">Changes</span><span class="w">     </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}</span><span class="w"> </span><span class="s">`json:"changes"`</span><span class="w">      </span><span class="c1">// What was changed</span>
</span><span id="__span-17-43"><a href="#__codelineno-17-43" id="__codelineno-17-43" name="__codelineno-17-43"></a><span class="w">    </span><span class="nx">Error</span><span class="w">       </span><span class="kt">string</span><span class="w">                 </span><span class="s">`json:"error,omitempty"`</span>
</span><span id="__span-17-44"><a href="#__codelineno-17-44" id="__codelineno-17-44" name="__codelineno-17-44"></a><span class="p">}</span>
</span></code></pre></div> <h4 id="tamper-evident-logging">Tamper-Evident Logging<a class="headerlink" href="#tamper-evident-logging" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-18-1"><a href="#__codelineno-18-1" id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">TamperEvidenceManager</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-2"><a href="#__codelineno-18-2" id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="w">    </span><span class="nx">HashChain</span><span class="w">    </span><span class="p">[]</span><span class="kt">string</span><span class="w">    </span><span class="s">`json:"hash_chain"`</span>
</span><span id="__span-18-3"><a href="#__codelineno-18-3" id="__codelineno-18-3" name="__codelineno-18-3"></a><span class="w">    </span><span class="nx">MerkleTree</span><span class="w">   </span><span class="o">*</span><span class="nx">MerkleTree</span><span class="w"> </span><span class="s">`json:"merkle_tree"`</span>
</span><span id="__span-18-4"><a href="#__codelineno-18-4" id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="w">    </span><span class="nx">DigitalSign</span><span class="w">  </span><span class="o">*</span><span class="nx">RSAPrivKey</span><span class="w"> </span><span class="s">`json:"digital_sign"`</span>
</span><span id="__span-18-5"><a href="#__codelineno-18-5" id="__codelineno-18-5" name="__codelineno-18-5"></a><span class="w">    </span><span class="nx">TimestampCA</span><span class="w">  </span><span class="kt">string</span><span class="w">      </span><span class="s">`json:"timestamp_ca"`</span>
</span><span id="__span-18-6"><a href="#__codelineno-18-6" id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="p">}</span>
</span><span id="__span-18-7"><a href="#__codelineno-18-7" id="__codelineno-18-7" name="__codelineno-18-7"></a>
</span><span id="__span-18-8"><a href="#__codelineno-18-8" id="__codelineno-18-8" name="__codelineno-18-8"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">tem</span><span class="w"> </span><span class="o">*</span><span class="nx">TamperEvidenceManager</span><span class="p">)</span><span class="w"> </span><span class="nx">CreateTamperProof</span><span class="p">(</span><span class="nx">log</span><span class="w"> </span><span class="o">*</span><span class="nx">AuditLog</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-9"><a href="#__codelineno-18-9" id="__codelineno-18-9" name="__codelineno-18-9"></a><span class="w">    </span><span class="c1">// 1. Calculate hash of log entry</span>
</span><span id="__span-18-10"><a href="#__codelineno-18-10" id="__codelineno-18-10" name="__codelineno-18-10"></a><span class="w">    </span><span class="nx">logHash</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">sha256</span><span class="p">.</span><span class="nx">Sum256</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">log</span><span class="p">.</span><span class="nx">String</span><span class="p">()))</span>
</span><span id="__span-18-11"><a href="#__codelineno-18-11" id="__codelineno-18-11" name="__codelineno-18-11"></a>
</span><span id="__span-18-12"><a href="#__codelineno-18-12" id="__codelineno-18-12" name="__codelineno-18-12"></a><span class="w">    </span><span class="c1">// 2. Chain with previous hash</span>
</span><span id="__span-18-13"><a href="#__codelineno-18-13" id="__codelineno-18-13" name="__codelineno-18-13"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="nx">tem</span><span class="p">.</span><span class="nx">HashChain</span><span class="p">)</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-14"><a href="#__codelineno-18-14" id="__codelineno-18-14" name="__codelineno-18-14"></a><span class="w">        </span><span class="nx">prevHash</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">tem</span><span class="p">.</span><span class="nx">HashChain</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="nx">tem</span><span class="p">.</span><span class="nx">HashChain</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-18-15"><a href="#__codelineno-18-15" id="__codelineno-18-15" name="__codelineno-18-15"></a><span class="w">        </span><span class="nx">chainInput</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">"%s%x"</span><span class="p">,</span><span class="w"> </span><span class="nx">prevHash</span><span class="p">,</span><span class="w"> </span><span class="nx">logHash</span><span class="p">)</span>
</span><span id="__span-18-16"><a href="#__codelineno-18-16" id="__codelineno-18-16" name="__codelineno-18-16"></a><span class="w">        </span><span class="nx">chainHash</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">sha256</span><span class="p">.</span><span class="nx">Sum256</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">chainInput</span><span class="p">))</span>
</span><span id="__span-18-17"><a href="#__codelineno-18-17" id="__codelineno-18-17" name="__codelineno-18-17"></a><span class="w">        </span><span class="nx">tem</span><span class="p">.</span><span class="nx">HashChain</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">tem</span><span class="p">.</span><span class="nx">HashChain</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">"%x"</span><span class="p">,</span><span class="w"> </span><span class="nx">chainHash</span><span class="p">))</span>
</span><span id="__span-18-18"><a href="#__codelineno-18-18" id="__codelineno-18-18" name="__codelineno-18-18"></a><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-19"><a href="#__codelineno-18-19" id="__codelineno-18-19" name="__codelineno-18-19"></a><span class="w">        </span><span class="nx">tem</span><span class="p">.</span><span class="nx">HashChain</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">append</span><span class="p">(</span><span class="nx">tem</span><span class="p">.</span><span class="nx">HashChain</span><span class="p">,</span><span class="w"> </span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">"%x"</span><span class="p">,</span><span class="w"> </span><span class="nx">logHash</span><span class="p">))</span>
</span><span id="__span-18-20"><a href="#__codelineno-18-20" id="__codelineno-18-20" name="__codelineno-18-20"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-18-21"><a href="#__codelineno-18-21" id="__codelineno-18-21" name="__codelineno-18-21"></a>
</span><span id="__span-18-22"><a href="#__codelineno-18-22" id="__codelineno-18-22" name="__codelineno-18-22"></a><span class="w">    </span><span class="c1">// 3. Add to Merkle tree</span>
</span><span id="__span-18-23"><a href="#__codelineno-18-23" id="__codelineno-18-23" name="__codelineno-18-23"></a><span class="w">    </span><span class="nx">tem</span><span class="p">.</span><span class="nx">MerkleTree</span><span class="p">.</span><span class="nx">AddLeaf</span><span class="p">(</span><span class="nx">logHash</span><span class="p">[:])</span>
</span><span id="__span-18-24"><a href="#__codelineno-18-24" id="__codelineno-18-24" name="__codelineno-18-24"></a>
</span><span id="__span-18-25"><a href="#__codelineno-18-25" id="__codelineno-18-25" name="__codelineno-18-25"></a><span class="w">    </span><span class="c1">// 4. Digital signature</span>
</span><span id="__span-18-26"><a href="#__codelineno-18-26" id="__codelineno-18-26" name="__codelineno-18-26"></a><span class="w">    </span><span class="nx">signature</span><span class="p">,</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nx">rsa</span><span class="p">.</span><span class="nx">SignPKCS1v15</span><span class="p">(</span><span class="nx">rand</span><span class="p">.</span><span class="nx">Reader</span><span class="p">,</span><span class="w"> </span><span class="nx">tem</span><span class="p">.</span><span class="nx">DigitalSign</span><span class="p">,</span><span class="w"> </span><span class="nx">crypto</span><span class="p">.</span><span class="nx">SHA256</span><span class="p">,</span><span class="w"> </span><span class="nx">logHash</span><span class="p">[:])</span>
</span><span id="__span-18-27"><a href="#__codelineno-18-27" id="__codelineno-18-27" name="__codelineno-18-27"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-28"><a href="#__codelineno-18-28" id="__codelineno-18-28" name="__codelineno-18-28"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">err</span>
</span><span id="__span-18-29"><a href="#__codelineno-18-29" id="__codelineno-18-29" name="__codelineno-18-29"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-18-30"><a href="#__codelineno-18-30" id="__codelineno-18-30" name="__codelineno-18-30"></a><span class="w">    </span><span class="nx">log</span><span class="p">.</span><span class="nx">Signature</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">base64</span><span class="p">.</span><span class="nx">StdEncoding</span><span class="p">.</span><span class="nx">EncodeToString</span><span class="p">(</span><span class="nx">signature</span><span class="p">)</span>
</span><span id="__span-18-31"><a href="#__codelineno-18-31" id="__codelineno-18-31" name="__codelineno-18-31"></a>
</span><span id="__span-18-32"><a href="#__codelineno-18-32" id="__codelineno-18-32" name="__codelineno-18-32"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">nil</span>
</span><span id="__span-18-33"><a href="#__codelineno-18-33" id="__codelineno-18-33" name="__codelineno-18-33"></a><span class="p">}</span>
</span></code></pre></div> <h2 id="incident-response">üö® Incident Response<a class="headerlink" href="#incident-response" title="Permanent link">¬∂</a></h2> <h3 id="automated-response-actions">Automated Response Actions<a class="headerlink" href="#automated-response-actions" title="Permanent link">¬∂</a></h3> <h4 id="security-automation">Security Automation<a class="headerlink" href="#security-automation" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-19-1"><a href="#__codelineno-19-1" id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">SecurityAutomation</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-2"><a href="#__codelineno-19-2" id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="w">    </span><span class="nx">TriggerRules</span><span class="w">    </span><span class="p">[]</span><span class="nx">TriggerRule</span><span class="w">     </span><span class="s">`json:"trigger_rules"`</span>
</span><span id="__span-19-3"><a href="#__codelineno-19-3" id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="w">    </span><span class="nx">ResponseActions</span><span class="w"> </span><span class="p">[]</span><span class="nx">ResponseAction</span><span class="w">  </span><span class="s">`json:"response_actions"`</span>
</span><span id="__span-19-4"><a href="#__codelineno-19-4" id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="w">    </span><span class="nx">Playbooks</span><span class="w">      </span><span class="p">[]</span><span class="nx">SecurityPlaybook</span><span class="w"> </span><span class="s">`json:"playbooks"`</span>
</span><span id="__span-19-5"><a href="#__codelineno-19-5" id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="p">}</span>
</span><span id="__span-19-6"><a href="#__codelineno-19-6" id="__codelineno-19-6" name="__codelineno-19-6"></a>
</span><span id="__span-19-7"><a href="#__codelineno-19-7" id="__codelineno-19-7" name="__codelineno-19-7"></a><span class="kd">type</span><span class="w"> </span><span class="nx">TriggerRule</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-8"><a href="#__codelineno-19-8" id="__codelineno-19-8" name="__codelineno-19-8"></a><span class="w">    </span><span class="nx">ID</span><span class="w">          </span><span class="kt">string</span><span class="w">            </span><span class="s">`json:"id"`</span>
</span><span id="__span-19-9"><a href="#__codelineno-19-9" id="__codelineno-19-9" name="__codelineno-19-9"></a><span class="w">    </span><span class="nx">Name</span><span class="w">        </span><span class="kt">string</span><span class="w">            </span><span class="s">`json:"name"`</span>
</span><span id="__span-19-10"><a href="#__codelineno-19-10" id="__codelineno-19-10" name="__codelineno-19-10"></a><span class="w">    </span><span class="nx">EventType</span><span class="w">   </span><span class="nx">SecurityEventType</span><span class="w"> </span><span class="s">`json:"event_type"`</span>
</span><span id="__span-19-11"><a href="#__codelineno-19-11" id="__codelineno-19-11" name="__codelineno-19-11"></a><span class="w">    </span><span class="nx">Conditions</span><span class="w">  </span><span class="p">[]</span><span class="nx">Condition</span><span class="w">       </span><span class="s">`json:"conditions"`</span>
</span><span id="__span-19-12"><a href="#__codelineno-19-12" id="__codelineno-19-12" name="__codelineno-19-12"></a><span class="w">    </span><span class="nx">Severity</span><span class="w">    </span><span class="kt">string</span><span class="w">            </span><span class="s">`json:"severity"`</span>
</span><span id="__span-19-13"><a href="#__codelineno-19-13" id="__codelineno-19-13" name="__codelineno-19-13"></a><span class="w">    </span><span class="nx">Confidence</span><span class="w">  </span><span class="kt">float64</span><span class="w">           </span><span class="s">`json:"confidence"`</span>
</span><span id="__span-19-14"><a href="#__codelineno-19-14" id="__codelineno-19-14" name="__codelineno-19-14"></a><span class="w">    </span><span class="nx">Actions</span><span class="w">     </span><span class="p">[]</span><span class="kt">string</span><span class="w">          </span><span class="s">`json:"actions"`</span><span class="w">     </span><span class="c1">// Action IDs to execute</span>
</span><span id="__span-19-15"><a href="#__codelineno-19-15" id="__codelineno-19-15" name="__codelineno-19-15"></a><span class="p">}</span>
</span><span id="__span-19-16"><a href="#__codelineno-19-16" id="__codelineno-19-16" name="__codelineno-19-16"></a>
</span><span id="__span-19-17"><a href="#__codelineno-19-17" id="__codelineno-19-17" name="__codelineno-19-17"></a><span class="kd">type</span><span class="w"> </span><span class="nx">ResponseAction</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-18"><a href="#__codelineno-19-18" id="__codelineno-19-18" name="__codelineno-19-18"></a><span class="w">    </span><span class="nx">ID</span><span class="w">          </span><span class="kt">string</span><span class="w">                 </span><span class="s">`json:"id"`</span>
</span><span id="__span-19-19"><a href="#__codelineno-19-19" id="__codelineno-19-19" name="__codelineno-19-19"></a><span class="w">    </span><span class="nx">Type</span><span class="w">        </span><span class="kt">string</span><span class="w">                 </span><span class="s">`json:"type"`</span><span class="w">        </span><span class="c1">// block, quarantine, notify, escalate</span>
</span><span id="__span-19-20"><a href="#__codelineno-19-20" id="__codelineno-19-20" name="__codelineno-19-20"></a><span class="w">    </span><span class="nx">Parameters</span><span class="w">  </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}</span><span class="w"> </span><span class="s">`json:"parameters"`</span>
</span><span id="__span-19-21"><a href="#__codelineno-19-21" id="__codelineno-19-21" name="__codelineno-19-21"></a><span class="w">    </span><span class="nx">AutoExecute</span><span class="w"> </span><span class="kt">bool</span><span class="w">                   </span><span class="s">`json:"auto_execute"`</span>
</span><span id="__span-19-22"><a href="#__codelineno-19-22" id="__codelineno-19-22" name="__codelineno-19-22"></a><span class="w">    </span><span class="nx">RequireApproval</span><span class="w"> </span><span class="kt">bool</span><span class="w">               </span><span class="s">`json:"require_approval"`</span>
</span><span id="__span-19-23"><a href="#__codelineno-19-23" id="__codelineno-19-23" name="__codelineno-19-23"></a><span class="w">    </span><span class="nx">Timeout</span><span class="w">     </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w">          </span><span class="s">`json:"timeout"`</span>
</span><span id="__span-19-24"><a href="#__codelineno-19-24" id="__codelineno-19-24" name="__codelineno-19-24"></a><span class="p">}</span>
</span><span id="__span-19-25"><a href="#__codelineno-19-25" id="__codelineno-19-25" name="__codelineno-19-25"></a>
</span><span id="__span-19-26"><a href="#__codelineno-19-26" id="__codelineno-19-26" name="__codelineno-19-26"></a><span class="kd">var</span><span class="w"> </span><span class="nx">DefaultResponseActions</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[]</span><span class="nx">ResponseAction</span><span class="p">{</span>
</span><span id="__span-19-27"><a href="#__codelineno-19-27" id="__codelineno-19-27" name="__codelineno-19-27"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-19-28"><a href="#__codelineno-19-28" id="__codelineno-19-28" name="__codelineno-19-28"></a><span class="w">        </span><span class="nx">ID</span><span class="p">:</span><span class="w">   </span><span class="s">"block_user"</span><span class="p">,</span>
</span><span id="__span-19-29"><a href="#__codelineno-19-29" id="__codelineno-19-29" name="__codelineno-19-29"></a><span class="w">        </span><span class="nx">Type</span><span class="p">:</span><span class="w"> </span><span class="s">"block"</span><span class="p">,</span>
</span><span id="__span-19-30"><a href="#__codelineno-19-30" id="__codelineno-19-30" name="__codelineno-19-30"></a><span class="w">        </span><span class="nx">Parameters</span><span class="p">:</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}{</span>
</span><span id="__span-19-31"><a href="#__codelineno-19-31" id="__codelineno-19-31" name="__codelineno-19-31"></a><span class="w">            </span><span class="s">"target_type"</span><span class="p">:</span><span class="w"> </span><span class="s">"user"</span><span class="p">,</span>
</span><span id="__span-19-32"><a href="#__codelineno-19-32" id="__codelineno-19-32" name="__codelineno-19-32"></a><span class="w">            </span><span class="s">"duration"</span><span class="p">:</span><span class="w">    </span><span class="s">"1h"</span><span class="p">,</span>
</span><span id="__span-19-33"><a href="#__codelineno-19-33" id="__codelineno-19-33" name="__codelineno-19-33"></a><span class="w">            </span><span class="s">"reason"</span><span class="p">:</span><span class="w">      </span><span class="s">"Suspicious activity detected"</span><span class="p">,</span>
</span><span id="__span-19-34"><a href="#__codelineno-19-34" id="__codelineno-19-34" name="__codelineno-19-34"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-19-35"><a href="#__codelineno-19-35" id="__codelineno-19-35" name="__codelineno-19-35"></a><span class="w">        </span><span class="nx">AutoExecute</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-19-36"><a href="#__codelineno-19-36" id="__codelineno-19-36" name="__codelineno-19-36"></a><span class="w">        </span><span class="nx">Timeout</span><span class="p">:</span><span class="w">     </span><span class="mi">5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Minute</span><span class="p">,</span>
</span><span id="__span-19-37"><a href="#__codelineno-19-37" id="__codelineno-19-37" name="__codelineno-19-37"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-19-38"><a href="#__codelineno-19-38" id="__codelineno-19-38" name="__codelineno-19-38"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-19-39"><a href="#__codelineno-19-39" id="__codelineno-19-39" name="__codelineno-19-39"></a><span class="w">        </span><span class="nx">ID</span><span class="p">:</span><span class="w">   </span><span class="s">"quarantine_device"</span><span class="p">,</span>
</span><span id="__span-19-40"><a href="#__codelineno-19-40" id="__codelineno-19-40" name="__codelineno-19-40"></a><span class="w">        </span><span class="nx">Type</span><span class="p">:</span><span class="w"> </span><span class="s">"quarantine"</span><span class="p">,</span>
</span><span id="__span-19-41"><a href="#__codelineno-19-41" id="__codelineno-19-41" name="__codelineno-19-41"></a><span class="w">        </span><span class="nx">Parameters</span><span class="p">:</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}{</span>
</span><span id="__span-19-42"><a href="#__codelineno-19-42" id="__codelineno-19-42" name="__codelineno-19-42"></a><span class="w">            </span><span class="s">"target_type"</span><span class="p">:</span><span class="w">    </span><span class="s">"device"</span><span class="p">,</span>
</span><span id="__span-19-43"><a href="#__codelineno-19-43" id="__codelineno-19-43" name="__codelineno-19-43"></a><span class="w">            </span><span class="s">"network_access"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-19-44"><a href="#__codelineno-19-44" id="__codelineno-19-44" name="__codelineno-19-44"></a><span class="w">            </span><span class="s">"reason"</span><span class="p">:</span><span class="w">         </span><span class="s">"Device compromise suspected"</span><span class="p">,</span>
</span><span id="__span-19-45"><a href="#__codelineno-19-45" id="__codelineno-19-45" name="__codelineno-19-45"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-19-46"><a href="#__codelineno-19-46" id="__codelineno-19-46" name="__codelineno-19-46"></a><span class="w">        </span><span class="nx">AutoExecute</span><span class="p">:</span><span class="w">     </span><span class="kc">false</span><span class="p">,</span>
</span><span id="__span-19-47"><a href="#__codelineno-19-47" id="__codelineno-19-47" name="__codelineno-19-47"></a><span class="w">        </span><span class="nx">RequireApproval</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-19-48"><a href="#__codelineno-19-48" id="__codelineno-19-48" name="__codelineno-19-48"></a><span class="w">        </span><span class="nx">Timeout</span><span class="p">:</span><span class="w">         </span><span class="mi">15</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Minute</span><span class="p">,</span>
</span><span id="__span-19-49"><a href="#__codelineno-19-49" id="__codelineno-19-49" name="__codelineno-19-49"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-19-50"><a href="#__codelineno-19-50" id="__codelineno-19-50" name="__codelineno-19-50"></a><span class="p">}</span>
</span></code></pre></div> <h3 id="security-playbooks">Security Playbooks<a class="headerlink" href="#security-playbooks" title="Permanent link">¬∂</a></h3> <h4 id="incident-response-workflow">Incident Response Workflow<a class="headerlink" href="#incident-response-workflow" title="Permanent link">¬∂</a></h4> <div class="language-yaml highlight"><pre><span></span><code><span id="__span-20-1"><a href="#__codelineno-20-1" id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="c1"># security-playbooks/credential-compromise.yml</span>
</span><span id="__span-20-2"><a href="#__codelineno-20-2" id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="nt">playbook</span><span class="p">:</span>
</span><span id="__span-20-3"><a href="#__codelineno-20-3" id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">"Credential</span><span class="nv"> </span><span class="s">Compromise</span><span class="nv"> </span><span class="s">Response"</span>
</span><span id="__span-20-4"><a href="#__codelineno-20-4" id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="w">  </span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">"1.0"</span>
</span><span id="__span-20-5"><a href="#__codelineno-20-5" id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="w">  </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">"Automated</span><span class="nv"> </span><span class="s">response</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">credential</span><span class="nv"> </span><span class="s">compromise"</span>
</span><span id="__span-20-6"><a href="#__codelineno-20-6" id="__codelineno-20-6" name="__codelineno-20-6"></a>
</span><span id="__span-20-7"><a href="#__codelineno-20-7" id="__codelineno-20-7" name="__codelineno-20-7"></a><span class="w">  </span><span class="nt">triggers</span><span class="p">:</span>
</span><span id="__span-20-8"><a href="#__codelineno-20-8" id="__codelineno-20-8" name="__codelineno-20-8"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">event_type</span><span class="p">:</span><span class="w"> </span><span class="s">"auth.login.failure"</span>
</span><span id="__span-20-9"><a href="#__codelineno-20-9" id="__codelineno-20-9" name="__codelineno-20-9"></a><span class="w">      </span><span class="nt">threshold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</span><span id="__span-20-10"><a href="#__codelineno-20-10" id="__codelineno-20-10" name="__codelineno-20-10"></a><span class="w">      </span><span class="nt">time_window</span><span class="p">:</span><span class="w"> </span><span class="s">"5m"</span>
</span><span id="__span-20-11"><a href="#__codelineno-20-11" id="__codelineno-20-11" name="__codelineno-20-11"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">event_type</span><span class="p">:</span><span class="w"> </span><span class="s">"auth.login.success"</span>
</span><span id="__span-20-12"><a href="#__codelineno-20-12" id="__codelineno-20-12" name="__codelineno-20-12"></a><span class="w">      </span><span class="nt">anomaly_score</span><span class="p">:</span><span class="w"> </span><span class="s">"&gt;</span><span class="nv"> </span><span class="s">0.8"</span>
</span><span id="__span-20-13"><a href="#__codelineno-20-13" id="__codelineno-20-13" name="__codelineno-20-13"></a>
</span><span id="__span-20-14"><a href="#__codelineno-20-14" id="__codelineno-20-14" name="__codelineno-20-14"></a><span class="w">  </span><span class="nt">steps</span><span class="p">:</span>
</span><span id="__span-20-15"><a href="#__codelineno-20-15" id="__codelineno-20-15" name="__codelineno-20-15"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">"immediate_containment"</span>
</span><span id="__span-20-16"><a href="#__codelineno-20-16" id="__codelineno-20-16" name="__codelineno-20-16"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">"parallel"</span>
</span><span id="__span-20-17"><a href="#__codelineno-20-17" id="__codelineno-20-17" name="__codelineno-20-17"></a><span class="w">      </span><span class="nt">actions</span><span class="p">:</span>
</span><span id="__span-20-18"><a href="#__codelineno-20-18" id="__codelineno-20-18" name="__codelineno-20-18"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="s">"block_user"</span>
</span><span id="__span-20-19"><a href="#__codelineno-20-19" id="__codelineno-20-19" name="__codelineno-20-19"></a><span class="w">          </span><span class="nt">parameters</span><span class="p">:</span>
</span><span id="__span-20-20"><a href="#__codelineno-20-20" id="__codelineno-20-20" name="__codelineno-20-20"></a><span class="w">            </span><span class="nt">user_id</span><span class="p">:</span><span class="w"> </span><span class="s">"${event.user_id}"</span>
</span><span id="__span-20-21"><a href="#__codelineno-20-21" id="__codelineno-20-21" name="__codelineno-20-21"></a><span class="w">            </span><span class="nt">duration</span><span class="p">:</span><span class="w"> </span><span class="s">"1h"</span>
</span><span id="__span-20-22"><a href="#__codelineno-20-22" id="__codelineno-20-22" name="__codelineno-20-22"></a><span class="w">            </span><span class="nt">reason</span><span class="p">:</span><span class="w"> </span><span class="s">"Credential</span><span class="nv"> </span><span class="s">compromise</span><span class="nv"> </span><span class="s">suspected"</span>
</span><span id="__span-20-23"><a href="#__codelineno-20-23" id="__codelineno-20-23" name="__codelineno-20-23"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="s">"revoke_tokens"</span>
</span><span id="__span-20-24"><a href="#__codelineno-20-24" id="__codelineno-20-24" name="__codelineno-20-24"></a><span class="w">          </span><span class="nt">parameters</span><span class="p">:</span>
</span><span id="__span-20-25"><a href="#__codelineno-20-25" id="__codelineno-20-25" name="__codelineno-20-25"></a><span class="w">            </span><span class="nt">user_id</span><span class="p">:</span><span class="w"> </span><span class="s">"${event.user_id}"</span>
</span><span id="__span-20-26"><a href="#__codelineno-20-26" id="__codelineno-20-26" name="__codelineno-20-26"></a><span class="w">            </span><span class="nt">scope</span><span class="p">:</span><span class="w"> </span><span class="s">"all"</span>
</span><span id="__span-20-27"><a href="#__codelineno-20-27" id="__codelineno-20-27" name="__codelineno-20-27"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="s">"notify_security_team"</span>
</span><span id="__span-20-28"><a href="#__codelineno-20-28" id="__codelineno-20-28" name="__codelineno-20-28"></a><span class="w">          </span><span class="nt">parameters</span><span class="p">:</span>
</span><span id="__span-20-29"><a href="#__codelineno-20-29" id="__codelineno-20-29" name="__codelineno-20-29"></a><span class="w">            </span><span class="nt">severity</span><span class="p">:</span><span class="w"> </span><span class="s">"high"</span>
</span><span id="__span-20-30"><a href="#__codelineno-20-30" id="__codelineno-20-30" name="__codelineno-20-30"></a><span class="w">            </span><span class="nt">message</span><span class="p">:</span><span class="w"> </span><span class="s">"Credential</span><span class="nv"> </span><span class="s">compromise</span><span class="nv"> </span><span class="s">detected</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">user</span><span class="nv"> </span><span class="s">${event.user_id}"</span>
</span><span id="__span-20-31"><a href="#__codelineno-20-31" id="__codelineno-20-31" name="__codelineno-20-31"></a>
</span><span id="__span-20-32"><a href="#__codelineno-20-32" id="__codelineno-20-32" name="__codelineno-20-32"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">"investigation"</span>
</span><span id="__span-20-33"><a href="#__codelineno-20-33" id="__codelineno-20-33" name="__codelineno-20-33"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">"sequential"</span>
</span><span id="__span-20-34"><a href="#__codelineno-20-34" id="__codelineno-20-34" name="__codelineno-20-34"></a><span class="w">      </span><span class="nt">actions</span><span class="p">:</span>
</span><span id="__span-20-35"><a href="#__codelineno-20-35" id="__codelineno-20-35" name="__codelineno-20-35"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="s">"collect_evidence"</span>
</span><span id="__span-20-36"><a href="#__codelineno-20-36" id="__codelineno-20-36" name="__codelineno-20-36"></a><span class="w">          </span><span class="nt">parameters</span><span class="p">:</span>
</span><span id="__span-20-37"><a href="#__codelineno-20-37" id="__codelineno-20-37" name="__codelineno-20-37"></a><span class="w">            </span><span class="nt">user_id</span><span class="p">:</span><span class="w"> </span><span class="s">"${event.user_id}"</span>
</span><span id="__span-20-38"><a href="#__codelineno-20-38" id="__codelineno-20-38" name="__codelineno-20-38"></a><span class="w">            </span><span class="nt">time_range</span><span class="p">:</span><span class="w"> </span><span class="s">"24h"</span>
</span><span id="__span-20-39"><a href="#__codelineno-20-39" id="__codelineno-20-39" name="__codelineno-20-39"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="s">"analyze_behavior"</span>
</span><span id="__span-20-40"><a href="#__codelineno-20-40" id="__codelineno-20-40" name="__codelineno-20-40"></a><span class="w">          </span><span class="nt">parameters</span><span class="p">:</span>
</span><span id="__span-20-41"><a href="#__codelineno-20-41" id="__codelineno-20-41" name="__codelineno-20-41"></a><span class="w">            </span><span class="nt">user_id</span><span class="p">:</span><span class="w"> </span><span class="s">"${event.user_id}"</span>
</span><span id="__span-20-42"><a href="#__codelineno-20-42" id="__codelineno-20-42" name="__codelineno-20-42"></a><span class="w">            </span><span class="nt">comparison_period</span><span class="p">:</span><span class="w"> </span><span class="s">"30d"</span>
</span><span id="__span-20-43"><a href="#__codelineno-20-43" id="__codelineno-20-43" name="__codelineno-20-43"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="s">"check_related_accounts"</span>
</span><span id="__span-20-44"><a href="#__codelineno-20-44" id="__codelineno-20-44" name="__codelineno-20-44"></a><span class="w">          </span><span class="nt">parameters</span><span class="p">:</span>
</span><span id="__span-20-45"><a href="#__codelineno-20-45" id="__codelineno-20-45" name="__codelineno-20-45"></a><span class="w">            </span><span class="nt">user_id</span><span class="p">:</span><span class="w"> </span><span class="s">"${event.user_id}"</span>
</span><span id="__span-20-46"><a href="#__codelineno-20-46" id="__codelineno-20-46" name="__codelineno-20-46"></a><span class="w">            </span><span class="nt">relationship_types</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">"same_department"</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">"shared_devices"</span><span class="p p-Indicator">]</span>
</span><span id="__span-20-47"><a href="#__codelineno-20-47" id="__codelineno-20-47" name="__codelineno-20-47"></a>
</span><span id="__span-20-48"><a href="#__codelineno-20-48" id="__codelineno-20-48" name="__codelineno-20-48"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">"recovery"</span>
</span><span id="__span-20-49"><a href="#__codelineno-20-49" id="__codelineno-20-49" name="__codelineno-20-49"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">"manual_approval"</span>
</span><span id="__span-20-50"><a href="#__codelineno-20-50" id="__codelineno-20-50" name="__codelineno-20-50"></a><span class="w">      </span><span class="nt">actions</span><span class="p">:</span>
</span><span id="__span-20-51"><a href="#__codelineno-20-51" id="__codelineno-20-51" name="__codelineno-20-51"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="s">"force_password_reset"</span>
</span><span id="__span-20-52"><a href="#__codelineno-20-52" id="__codelineno-20-52" name="__codelineno-20-52"></a><span class="w">          </span><span class="nt">parameters</span><span class="p">:</span>
</span><span id="__span-20-53"><a href="#__codelineno-20-53" id="__codelineno-20-53" name="__codelineno-20-53"></a><span class="w">            </span><span class="nt">user_id</span><span class="p">:</span><span class="w"> </span><span class="s">"${event.user_id}"</span>
</span><span id="__span-20-54"><a href="#__codelineno-20-54" id="__codelineno-20-54" name="__codelineno-20-54"></a><span class="w">            </span><span class="nt">require_mfa</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-20-55"><a href="#__codelineno-20-55" id="__codelineno-20-55" name="__codelineno-20-55"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="s">"revoke_device_certificates"</span>
</span><span id="__span-20-56"><a href="#__codelineno-20-56" id="__codelineno-20-56" name="__codelineno-20-56"></a><span class="w">          </span><span class="nt">parameters</span><span class="p">:</span>
</span><span id="__span-20-57"><a href="#__codelineno-20-57" id="__codelineno-20-57" name="__codelineno-20-57"></a><span class="w">            </span><span class="nt">user_id</span><span class="p">:</span><span class="w"> </span><span class="s">"${event.user_id}"</span>
</span><span id="__span-20-58"><a href="#__codelineno-20-58" id="__codelineno-20-58" name="__codelineno-20-58"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">action</span><span class="p">:</span><span class="w"> </span><span class="s">"schedule_security_training"</span>
</span><span id="__span-20-59"><a href="#__codelineno-20-59" id="__codelineno-20-59" name="__codelineno-20-59"></a><span class="w">          </span><span class="nt">parameters</span><span class="p">:</span>
</span><span id="__span-20-60"><a href="#__codelineno-20-60" id="__codelineno-20-60" name="__codelineno-20-60"></a><span class="w">            </span><span class="nt">user_id</span><span class="p">:</span><span class="w"> </span><span class="s">"${event.user_id}"</span>
</span><span id="__span-20-61"><a href="#__codelineno-20-61" id="__codelineno-20-61" name="__codelineno-20-61"></a><span class="w">            </span><span class="nt">training_type</span><span class="p">:</span><span class="w"> </span><span class="s">"credential_security"</span>
</span></code></pre></div> <h2 id="security-configuration">üîß Security Configuration<a class="headerlink" href="#security-configuration" title="Permanent link">¬∂</a></h2> <h3 id="security-headers">Security Headers<a class="headerlink" href="#security-headers" title="Permanent link">¬∂</a></h3> <h4 id="http-security-headers">HTTP Security Headers<a class="headerlink" href="#http-security-headers" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-21-1"><a href="#__codelineno-21-1" id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">SecurityHeadersMiddleware</span><span class="p">()</span><span class="w"> </span><span class="nx">fiber</span><span class="p">.</span><span class="nx">Handler</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-2"><a href="#__codelineno-21-2" id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kd">func</span><span class="p">(</span><span class="nx">c</span><span class="w"> </span><span class="o">*</span><span class="nx">fiber</span><span class="p">.</span><span class="nx">Ctx</span><span class="p">)</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-3"><a href="#__codelineno-21-3" id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="w">        </span><span class="c1">// Prevent MIME sniffing</span>
</span><span id="__span-21-4"><a href="#__codelineno-21-4" id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="w">        </span><span class="nx">c</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s">"X-Content-Type-Options"</span><span class="p">,</span><span class="w"> </span><span class="s">"nosniff"</span><span class="p">)</span>
</span><span id="__span-21-5"><a href="#__codelineno-21-5" id="__codelineno-21-5" name="__codelineno-21-5"></a>
</span><span id="__span-21-6"><a href="#__codelineno-21-6" id="__codelineno-21-6" name="__codelineno-21-6"></a><span class="w">        </span><span class="c1">// Prevent clickjacking</span>
</span><span id="__span-21-7"><a href="#__codelineno-21-7" id="__codelineno-21-7" name="__codelineno-21-7"></a><span class="w">        </span><span class="nx">c</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s">"X-Frame-Options"</span><span class="p">,</span><span class="w"> </span><span class="s">"DENY"</span><span class="p">)</span>
</span><span id="__span-21-8"><a href="#__codelineno-21-8" id="__codelineno-21-8" name="__codelineno-21-8"></a>
</span><span id="__span-21-9"><a href="#__codelineno-21-9" id="__codelineno-21-9" name="__codelineno-21-9"></a><span class="w">        </span><span class="c1">// XSS protection</span>
</span><span id="__span-21-10"><a href="#__codelineno-21-10" id="__codelineno-21-10" name="__codelineno-21-10"></a><span class="w">        </span><span class="nx">c</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s">"X-XSS-Protection"</span><span class="p">,</span><span class="w"> </span><span class="s">"1; mode=block"</span><span class="p">)</span>
</span><span id="__span-21-11"><a href="#__codelineno-21-11" id="__codelineno-21-11" name="__codelineno-21-11"></a>
</span><span id="__span-21-12"><a href="#__codelineno-21-12" id="__codelineno-21-12" name="__codelineno-21-12"></a><span class="w">        </span><span class="c1">// HSTS</span>
</span><span id="__span-21-13"><a href="#__codelineno-21-13" id="__codelineno-21-13" name="__codelineno-21-13"></a><span class="w">        </span><span class="nx">c</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s">"Strict-Transport-Security"</span><span class="p">,</span><span class="w"> </span><span class="s">"max-age=31536000; includeSubDomains; preload"</span><span class="p">)</span>
</span><span id="__span-21-14"><a href="#__codelineno-21-14" id="__codelineno-21-14" name="__codelineno-21-14"></a>
</span><span id="__span-21-15"><a href="#__codelineno-21-15" id="__codelineno-21-15" name="__codelineno-21-15"></a><span class="w">        </span><span class="c1">// CSP</span>
</span><span id="__span-21-16"><a href="#__codelineno-21-16" id="__codelineno-21-16" name="__codelineno-21-16"></a><span class="w">        </span><span class="nx">csp</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="s">"default-src 'self'; "</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-21-17"><a href="#__codelineno-21-17" id="__codelineno-21-17" name="__codelineno-21-17"></a><span class="w">               </span><span class="s">"script-src 'self' 'unsafe-inline'; "</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-21-18"><a href="#__codelineno-21-18" id="__codelineno-21-18" name="__codelineno-21-18"></a><span class="w">               </span><span class="s">"style-src 'self' 'unsafe-inline'; "</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-21-19"><a href="#__codelineno-21-19" id="__codelineno-21-19" name="__codelineno-21-19"></a><span class="w">               </span><span class="s">"img-src 'self' data: https:; "</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-21-20"><a href="#__codelineno-21-20" id="__codelineno-21-20" name="__codelineno-21-20"></a><span class="w">               </span><span class="s">"font-src 'self'; "</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-21-21"><a href="#__codelineno-21-21" id="__codelineno-21-21" name="__codelineno-21-21"></a><span class="w">               </span><span class="s">"connect-src 'self' wss: https:; "</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-21-22"><a href="#__codelineno-21-22" id="__codelineno-21-22" name="__codelineno-21-22"></a><span class="w">               </span><span class="s">"frame-ancestors 'none'; "</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-21-23"><a href="#__codelineno-21-23" id="__codelineno-21-23" name="__codelineno-21-23"></a><span class="w">               </span><span class="s">"base-uri 'self'; "</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-21-24"><a href="#__codelineno-21-24" id="__codelineno-21-24" name="__codelineno-21-24"></a><span class="w">               </span><span class="s">"object-src 'none'"</span>
</span><span id="__span-21-25"><a href="#__codelineno-21-25" id="__codelineno-21-25" name="__codelineno-21-25"></a><span class="w">        </span><span class="nx">c</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s">"Content-Security-Policy"</span><span class="p">,</span><span class="w"> </span><span class="nx">csp</span><span class="p">)</span>
</span><span id="__span-21-26"><a href="#__codelineno-21-26" id="__codelineno-21-26" name="__codelineno-21-26"></a>
</span><span id="__span-21-27"><a href="#__codelineno-21-27" id="__codelineno-21-27" name="__codelineno-21-27"></a><span class="w">        </span><span class="c1">// Referrer policy</span>
</span><span id="__span-21-28"><a href="#__codelineno-21-28" id="__codelineno-21-28" name="__codelineno-21-28"></a><span class="w">        </span><span class="nx">c</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s">"Referrer-Policy"</span><span class="p">,</span><span class="w"> </span><span class="s">"strict-origin-when-cross-origin"</span><span class="p">)</span>
</span><span id="__span-21-29"><a href="#__codelineno-21-29" id="__codelineno-21-29" name="__codelineno-21-29"></a>
</span><span id="__span-21-30"><a href="#__codelineno-21-30" id="__codelineno-21-30" name="__codelineno-21-30"></a><span class="w">        </span><span class="c1">// Feature policy</span>
</span><span id="__span-21-31"><a href="#__codelineno-21-31" id="__codelineno-21-31" name="__codelineno-21-31"></a><span class="w">        </span><span class="nx">c</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s">"Feature-Policy"</span><span class="p">,</span><span class="w"> </span><span class="s">"geolocation 'none'; microphone 'none'; camera 'none'"</span><span class="p">)</span>
</span><span id="__span-21-32"><a href="#__codelineno-21-32" id="__codelineno-21-32" name="__codelineno-21-32"></a>
</span><span id="__span-21-33"><a href="#__codelineno-21-33" id="__codelineno-21-33" name="__codelineno-21-33"></a><span class="w">        </span><span class="c1">// Permissions policy</span>
</span><span id="__span-21-34"><a href="#__codelineno-21-34" id="__codelineno-21-34" name="__codelineno-21-34"></a><span class="w">        </span><span class="nx">c</span><span class="p">.</span><span class="nx">Set</span><span class="p">(</span><span class="s">"Permissions-Policy"</span><span class="p">,</span><span class="w"> </span><span class="s">"geolocation=(), microphone=(), camera=()"</span><span class="p">)</span>
</span><span id="__span-21-35"><a href="#__codelineno-21-35" id="__codelineno-21-35" name="__codelineno-21-35"></a>
</span><span id="__span-21-36"><a href="#__codelineno-21-36" id="__codelineno-21-36" name="__codelineno-21-36"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="nx">c</span><span class="p">.</span><span class="nx">Next</span><span class="p">()</span>
</span><span id="__span-21-37"><a href="#__codelineno-21-37" id="__codelineno-21-37" name="__codelineno-21-37"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-21-38"><a href="#__codelineno-21-38" id="__codelineno-21-38" name="__codelineno-21-38"></a><span class="p">}</span>
</span></code></pre></div> <h3 id="rate-limiting">Rate Limiting<a class="headerlink" href="#rate-limiting" title="Permanent link">¬∂</a></h3> <h4 id="advanced-rate-limiting">Advanced Rate Limiting<a class="headerlink" href="#advanced-rate-limiting" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-22-1"><a href="#__codelineno-22-1" id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">RateLimiter</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-2"><a href="#__codelineno-22-2" id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="w">    </span><span class="nx">Redis</span><span class="w">     </span><span class="o">*</span><span class="nx">redis</span><span class="p">.</span><span class="nx">Client</span>
</span><span id="__span-22-3"><a href="#__codelineno-22-3" id="__codelineno-22-3" name="__codelineno-22-3"></a><span class="w">    </span><span class="nx">Rules</span><span class="w">     </span><span class="p">[]</span><span class="nx">RateLimitRule</span>
</span><span id="__span-22-4"><a href="#__codelineno-22-4" id="__codelineno-22-4" name="__codelineno-22-4"></a><span class="w">    </span><span class="nx">Whitelist</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span>
</span><span id="__span-22-5"><a href="#__codelineno-22-5" id="__codelineno-22-5" name="__codelineno-22-5"></a><span class="w">    </span><span class="nx">Blacklist</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span>
</span><span id="__span-22-6"><a href="#__codelineno-22-6" id="__codelineno-22-6" name="__codelineno-22-6"></a><span class="p">}</span>
</span><span id="__span-22-7"><a href="#__codelineno-22-7" id="__codelineno-22-7" name="__codelineno-22-7"></a>
</span><span id="__span-22-8"><a href="#__codelineno-22-8" id="__codelineno-22-8" name="__codelineno-22-8"></a><span class="kd">type</span><span class="w"> </span><span class="nx">RateLimitRule</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-9"><a href="#__codelineno-22-9" id="__codelineno-22-9" name="__codelineno-22-9"></a><span class="w">    </span><span class="nx">ID</span><span class="w">          </span><span class="kt">string</span><span class="w">        </span><span class="s">`json:"id"`</span>
</span><span id="__span-22-10"><a href="#__codelineno-22-10" id="__codelineno-22-10" name="__codelineno-22-10"></a><span class="w">    </span><span class="nx">Path</span><span class="w">        </span><span class="kt">string</span><span class="w">        </span><span class="s">`json:"path"`</span>
</span><span id="__span-22-11"><a href="#__codelineno-22-11" id="__codelineno-22-11" name="__codelineno-22-11"></a><span class="w">    </span><span class="nx">Method</span><span class="w">      </span><span class="kt">string</span><span class="w">        </span><span class="s">`json:"method"`</span>
</span><span id="__span-22-12"><a href="#__codelineno-22-12" id="__codelineno-22-12" name="__codelineno-22-12"></a><span class="w">    </span><span class="nx">Limit</span><span class="w">       </span><span class="kt">int</span><span class="w">           </span><span class="s">`json:"limit"`</span>
</span><span id="__span-22-13"><a href="#__codelineno-22-13" id="__codelineno-22-13" name="__codelineno-22-13"></a><span class="w">    </span><span class="nx">Window</span><span class="w">      </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w"> </span><span class="s">`json:"window"`</span>
</span><span id="__span-22-14"><a href="#__codelineno-22-14" id="__codelineno-22-14" name="__codelineno-22-14"></a><span class="w">    </span><span class="nx">Burst</span><span class="w">       </span><span class="kt">int</span><span class="w">           </span><span class="s">`json:"burst"`</span>
</span><span id="__span-22-15"><a href="#__codelineno-22-15" id="__codelineno-22-15" name="__codelineno-22-15"></a><span class="w">    </span><span class="nx">PerUser</span><span class="w">     </span><span class="kt">bool</span><span class="w">          </span><span class="s">`json:"per_user"`</span>
</span><span id="__span-22-16"><a href="#__codelineno-22-16" id="__codelineno-22-16" name="__codelineno-22-16"></a><span class="w">    </span><span class="nx">PerIP</span><span class="w">       </span><span class="kt">bool</span><span class="w">          </span><span class="s">`json:"per_ip"`</span>
</span><span id="__span-22-17"><a href="#__codelineno-22-17" id="__codelineno-22-17" name="__codelineno-22-17"></a><span class="w">    </span><span class="nx">PerDevice</span><span class="w">   </span><span class="kt">bool</span><span class="w">          </span><span class="s">`json:"per_device"`</span>
</span><span id="__span-22-18"><a href="#__codelineno-22-18" id="__codelineno-22-18" name="__codelineno-22-18"></a><span class="p">}</span>
</span><span id="__span-22-19"><a href="#__codelineno-22-19" id="__codelineno-22-19" name="__codelineno-22-19"></a>
</span><span id="__span-22-20"><a href="#__codelineno-22-20" id="__codelineno-22-20" name="__codelineno-22-20"></a><span class="kd">var</span><span class="w"> </span><span class="nx">DefaultRateLimitRules</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[]</span><span class="nx">RateLimitRule</span><span class="p">{</span>
</span><span id="__span-22-21"><a href="#__codelineno-22-21" id="__codelineno-22-21" name="__codelineno-22-21"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-22-22"><a href="#__codelineno-22-22" id="__codelineno-22-22" name="__codelineno-22-22"></a><span class="w">        </span><span class="nx">ID</span><span class="p">:</span><span class="w">     </span><span class="s">"auth_login"</span><span class="p">,</span>
</span><span id="__span-22-23"><a href="#__codelineno-22-23" id="__codelineno-22-23" name="__codelineno-22-23"></a><span class="w">        </span><span class="nx">Path</span><span class="p">:</span><span class="w">   </span><span class="s">"/api/auth/login"</span><span class="p">,</span>
</span><span id="__span-22-24"><a href="#__codelineno-22-24" id="__codelineno-22-24" name="__codelineno-22-24"></a><span class="w">        </span><span class="nx">Method</span><span class="p">:</span><span class="w"> </span><span class="s">"POST"</span><span class="p">,</span>
</span><span id="__span-22-25"><a href="#__codelineno-22-25" id="__codelineno-22-25" name="__codelineno-22-25"></a><span class="w">        </span><span class="nx">Limit</span><span class="p">:</span><span class="w">  </span><span class="mi">5</span><span class="p">,</span>
</span><span id="__span-22-26"><a href="#__codelineno-22-26" id="__codelineno-22-26" name="__codelineno-22-26"></a><span class="w">        </span><span class="nx">Window</span><span class="p">:</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Minute</span><span class="p">,</span>
</span><span id="__span-22-27"><a href="#__codelineno-22-27" id="__codelineno-22-27" name="__codelineno-22-27"></a><span class="w">        </span><span class="nx">Burst</span><span class="p">:</span><span class="w">  </span><span class="mi">2</span><span class="p">,</span>
</span><span id="__span-22-28"><a href="#__codelineno-22-28" id="__codelineno-22-28" name="__codelineno-22-28"></a><span class="w">        </span><span class="nx">PerIP</span><span class="p">:</span><span class="w">  </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-22-29"><a href="#__codelineno-22-29" id="__codelineno-22-29" name="__codelineno-22-29"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-22-30"><a href="#__codelineno-22-30" id="__codelineno-22-30" name="__codelineno-22-30"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-22-31"><a href="#__codelineno-22-31" id="__codelineno-22-31" name="__codelineno-22-31"></a><span class="w">        </span><span class="nx">ID</span><span class="p">:</span><span class="w">     </span><span class="s">"auth_general"</span><span class="p">,</span>
</span><span id="__span-22-32"><a href="#__codelineno-22-32" id="__codelineno-22-32" name="__codelineno-22-32"></a><span class="w">        </span><span class="nx">Path</span><span class="p">:</span><span class="w">   </span><span class="s">"/api/auth/*"</span><span class="p">,</span>
</span><span id="__span-22-33"><a href="#__codelineno-22-33" id="__codelineno-22-33" name="__codelineno-22-33"></a><span class="w">        </span><span class="nx">Method</span><span class="p">:</span><span class="w"> </span><span class="s">"*"</span><span class="p">,</span>
</span><span id="__span-22-34"><a href="#__codelineno-22-34" id="__codelineno-22-34" name="__codelineno-22-34"></a><span class="w">        </span><span class="nx">Limit</span><span class="p">:</span><span class="w">  </span><span class="mi">100</span><span class="p">,</span>
</span><span id="__span-22-35"><a href="#__codelineno-22-35" id="__codelineno-22-35" name="__codelineno-22-35"></a><span class="w">        </span><span class="nx">Window</span><span class="p">:</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Minute</span><span class="p">,</span>
</span><span id="__span-22-36"><a href="#__codelineno-22-36" id="__codelineno-22-36" name="__codelineno-22-36"></a><span class="w">        </span><span class="nx">PerUser</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-22-37"><a href="#__codelineno-22-37" id="__codelineno-22-37" name="__codelineno-22-37"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-22-38"><a href="#__codelineno-22-38" id="__codelineno-22-38" name="__codelineno-22-38"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-22-39"><a href="#__codelineno-22-39" id="__codelineno-22-39" name="__codelineno-22-39"></a><span class="w">        </span><span class="nx">ID</span><span class="p">:</span><span class="w">     </span><span class="s">"api_general"</span><span class="p">,</span>
</span><span id="__span-22-40"><a href="#__codelineno-22-40" id="__codelineno-22-40" name="__codelineno-22-40"></a><span class="w">        </span><span class="nx">Path</span><span class="p">:</span><span class="w">   </span><span class="s">"/api/*"</span><span class="p">,</span>
</span><span id="__span-22-41"><a href="#__codelineno-22-41" id="__codelineno-22-41" name="__codelineno-22-41"></a><span class="w">        </span><span class="nx">Method</span><span class="p">:</span><span class="w"> </span><span class="s">"*"</span><span class="p">,</span>
</span><span id="__span-22-42"><a href="#__codelineno-22-42" id="__codelineno-22-42" name="__codelineno-22-42"></a><span class="w">        </span><span class="nx">Limit</span><span class="p">:</span><span class="w">  </span><span class="mi">1000</span><span class="p">,</span>
</span><span id="__span-22-43"><a href="#__codelineno-22-43" id="__codelineno-22-43" name="__codelineno-22-43"></a><span class="w">        </span><span class="nx">Window</span><span class="p">:</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Minute</span><span class="p">,</span>
</span><span id="__span-22-44"><a href="#__codelineno-22-44" id="__codelineno-22-44" name="__codelineno-22-44"></a><span class="w">        </span><span class="nx">PerUser</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-22-45"><a href="#__codelineno-22-45" id="__codelineno-22-45" name="__codelineno-22-45"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-22-46"><a href="#__codelineno-22-46" id="__codelineno-22-46" name="__codelineno-22-46"></a><span class="p">}</span>
</span></code></pre></div> <h3 id="input-validation">Input Validation<a class="headerlink" href="#input-validation" title="Permanent link">¬∂</a></h3> <h4 id="comprehensive-input-validation">Comprehensive Input Validation<a class="headerlink" href="#comprehensive-input-validation" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-23-1"><a href="#__codelineno-23-1" id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">InputValidator</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-2"><a href="#__codelineno-23-2" id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="w">    </span><span class="nx">Rules</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">ValidationRule</span><span class="w"> </span><span class="s">`json:"rules"`</span>
</span><span id="__span-23-3"><a href="#__codelineno-23-3" id="__codelineno-23-3" name="__codelineno-23-3"></a><span class="p">}</span>
</span><span id="__span-23-4"><a href="#__codelineno-23-4" id="__codelineno-23-4" name="__codelineno-23-4"></a>
</span><span id="__span-23-5"><a href="#__codelineno-23-5" id="__codelineno-23-5" name="__codelineno-23-5"></a><span class="kd">type</span><span class="w"> </span><span class="nx">ValidationRule</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-6"><a href="#__codelineno-23-6" id="__codelineno-23-6" name="__codelineno-23-6"></a><span class="w">    </span><span class="nx">Required</span><span class="w">     </span><span class="kt">bool</span><span class="w">              </span><span class="s">`json:"required"`</span>
</span><span id="__span-23-7"><a href="#__codelineno-23-7" id="__codelineno-23-7" name="__codelineno-23-7"></a><span class="w">    </span><span class="nx">Type</span><span class="w">         </span><span class="kt">string</span><span class="w">            </span><span class="s">`json:"type"`</span><span class="w">         </span><span class="c1">// string, int, email, uuid, etc.</span>
</span><span id="__span-23-8"><a href="#__codelineno-23-8" id="__codelineno-23-8" name="__codelineno-23-8"></a><span class="w">    </span><span class="nx">MinLength</span><span class="w">    </span><span class="kt">int</span><span class="w">               </span><span class="s">`json:"min_length"`</span>
</span><span id="__span-23-9"><a href="#__codelineno-23-9" id="__codelineno-23-9" name="__codelineno-23-9"></a><span class="w">    </span><span class="nx">MaxLength</span><span class="w">    </span><span class="kt">int</span><span class="w">               </span><span class="s">`json:"max_length"`</span>
</span><span id="__span-23-10"><a href="#__codelineno-23-10" id="__codelineno-23-10" name="__codelineno-23-10"></a><span class="w">    </span><span class="nx">Pattern</span><span class="w">      </span><span class="kt">string</span><span class="w">            </span><span class="s">`json:"pattern"`</span><span class="w">      </span><span class="c1">// Regex pattern</span>
</span><span id="__span-23-11"><a href="#__codelineno-23-11" id="__codelineno-23-11" name="__codelineno-23-11"></a><span class="w">    </span><span class="nx">Whitelist</span><span class="w">    </span><span class="p">[]</span><span class="kt">string</span><span class="w">          </span><span class="s">`json:"whitelist"`</span>
</span><span id="__span-23-12"><a href="#__codelineno-23-12" id="__codelineno-23-12" name="__codelineno-23-12"></a><span class="w">    </span><span class="nx">Blacklist</span><span class="w">    </span><span class="p">[]</span><span class="kt">string</span><span class="w">          </span><span class="s">`json:"blacklist"`</span>
</span><span id="__span-23-13"><a href="#__codelineno-23-13" id="__codelineno-23-13" name="__codelineno-23-13"></a><span class="w">    </span><span class="nx">Sanitize</span><span class="w">     </span><span class="kt">bool</span><span class="w">              </span><span class="s">`json:"sanitize"`</span>
</span><span id="__span-23-14"><a href="#__codelineno-23-14" id="__codelineno-23-14" name="__codelineno-23-14"></a><span class="w">    </span><span class="nx">CustomRules</span><span class="w">  </span><span class="p">[]</span><span class="kt">string</span><span class="w">          </span><span class="s">`json:"custom_rules"`</span>
</span><span id="__span-23-15"><a href="#__codelineno-23-15" id="__codelineno-23-15" name="__codelineno-23-15"></a><span class="p">}</span>
</span><span id="__span-23-16"><a href="#__codelineno-23-16" id="__codelineno-23-16" name="__codelineno-23-16"></a>
</span><span id="__span-23-17"><a href="#__codelineno-23-17" id="__codelineno-23-17" name="__codelineno-23-17"></a><span class="kd">var</span><span class="w"> </span><span class="nx">InputValidationRules</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">ValidationRule</span><span class="p">{</span>
</span><span id="__span-23-18"><a href="#__codelineno-23-18" id="__codelineno-23-18" name="__codelineno-23-18"></a><span class="w">    </span><span class="s">"username"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-19"><a href="#__codelineno-23-19" id="__codelineno-23-19" name="__codelineno-23-19"></a><span class="w">        </span><span class="nx">Required</span><span class="p">:</span><span class="w">  </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-23-20"><a href="#__codelineno-23-20" id="__codelineno-23-20" name="__codelineno-23-20"></a><span class="w">        </span><span class="nx">Type</span><span class="p">:</span><span class="w">      </span><span class="s">"string"</span><span class="p">,</span>
</span><span id="__span-23-21"><a href="#__codelineno-23-21" id="__codelineno-23-21" name="__codelineno-23-21"></a><span class="w">        </span><span class="nx">MinLength</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
</span><span id="__span-23-22"><a href="#__codelineno-23-22" id="__codelineno-23-22" name="__codelineno-23-22"></a><span class="w">        </span><span class="nx">MaxLength</span><span class="p">:</span><span class="w"> </span><span class="mi">32</span><span class="p">,</span>
</span><span id="__span-23-23"><a href="#__codelineno-23-23" id="__codelineno-23-23" name="__codelineno-23-23"></a><span class="w">        </span><span class="nx">Pattern</span><span class="p">:</span><span class="w">   </span><span class="s">"^[a-zA-Z0-9_-]+$"</span><span class="p">,</span>
</span><span id="__span-23-24"><a href="#__codelineno-23-24" id="__codelineno-23-24" name="__codelineno-23-24"></a><span class="w">        </span><span class="nx">Sanitize</span><span class="p">:</span><span class="w">  </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-23-25"><a href="#__codelineno-23-25" id="__codelineno-23-25" name="__codelineno-23-25"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-23-26"><a href="#__codelineno-23-26" id="__codelineno-23-26" name="__codelineno-23-26"></a><span class="w">    </span><span class="s">"password"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-27"><a href="#__codelineno-23-27" id="__codelineno-23-27" name="__codelineno-23-27"></a><span class="w">        </span><span class="nx">Required</span><span class="p">:</span><span class="w">  </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-23-28"><a href="#__codelineno-23-28" id="__codelineno-23-28" name="__codelineno-23-28"></a><span class="w">        </span><span class="nx">Type</span><span class="p">:</span><span class="w">      </span><span class="s">"string"</span><span class="p">,</span>
</span><span id="__span-23-29"><a href="#__codelineno-23-29" id="__codelineno-23-29" name="__codelineno-23-29"></a><span class="w">        </span><span class="nx">MinLength</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span>
</span><span id="__span-23-30"><a href="#__codelineno-23-30" id="__codelineno-23-30" name="__codelineno-23-30"></a><span class="w">        </span><span class="nx">MaxLength</span><span class="p">:</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span>
</span><span id="__span-23-31"><a href="#__codelineno-23-31" id="__codelineno-23-31" name="__codelineno-23-31"></a><span class="w">        </span><span class="nx">CustomRules</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">{</span><span class="s">"password_complexity"</span><span class="p">,</span><span class="w"> </span><span class="s">"password_history"</span><span class="p">},</span>
</span><span id="__span-23-32"><a href="#__codelineno-23-32" id="__codelineno-23-32" name="__codelineno-23-32"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-23-33"><a href="#__codelineno-23-33" id="__codelineno-23-33" name="__codelineno-23-33"></a><span class="w">    </span><span class="s">"email"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-34"><a href="#__codelineno-23-34" id="__codelineno-23-34" name="__codelineno-23-34"></a><span class="w">        </span><span class="nx">Required</span><span class="p">:</span><span class="w">  </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-23-35"><a href="#__codelineno-23-35" id="__codelineno-23-35" name="__codelineno-23-35"></a><span class="w">        </span><span class="nx">Type</span><span class="p">:</span><span class="w">      </span><span class="s">"email"</span><span class="p">,</span>
</span><span id="__span-23-36"><a href="#__codelineno-23-36" id="__codelineno-23-36" name="__codelineno-23-36"></a><span class="w">        </span><span class="nx">MaxLength</span><span class="p">:</span><span class="w"> </span><span class="mi">254</span><span class="p">,</span>
</span><span id="__span-23-37"><a href="#__codelineno-23-37" id="__codelineno-23-37" name="__codelineno-23-37"></a><span class="w">        </span><span class="nx">Sanitize</span><span class="p">:</span><span class="w">  </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-23-38"><a href="#__codelineno-23-38" id="__codelineno-23-38" name="__codelineno-23-38"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-23-39"><a href="#__codelineno-23-39" id="__codelineno-23-39" name="__codelineno-23-39"></a><span class="w">    </span><span class="s">"device_id"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-40"><a href="#__codelineno-23-40" id="__codelineno-23-40" name="__codelineno-23-40"></a><span class="w">        </span><span class="nx">Required</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-23-41"><a href="#__codelineno-23-41" id="__codelineno-23-41" name="__codelineno-23-41"></a><span class="w">        </span><span class="nx">Type</span><span class="p">:</span><span class="w">     </span><span class="s">"uuid"</span><span class="p">,</span>
</span><span id="__span-23-42"><a href="#__codelineno-23-42" id="__codelineno-23-42" name="__codelineno-23-42"></a><span class="w">        </span><span class="nx">Pattern</span><span class="p">:</span><span class="w">  </span><span class="s">"^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$"</span><span class="p">,</span>
</span><span id="__span-23-43"><a href="#__codelineno-23-43" id="__codelineno-23-43" name="__codelineno-23-43"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-23-44"><a href="#__codelineno-23-44" id="__codelineno-23-44" name="__codelineno-23-44"></a><span class="p">}</span>
</span></code></pre></div> <h2 id="security-compliance">üìã Security Compliance<a class="headerlink" href="#security-compliance" title="Permanent link">¬∂</a></h2> <h3 id="compliance-frameworks">Compliance Frameworks<a class="headerlink" href="#compliance-frameworks" title="Permanent link">¬∂</a></h3> <h4 id="implementation-mapping">Implementation Mapping<a class="headerlink" href="#implementation-mapping" title="Permanent link">¬∂</a></h4> <table> <thead> <tr> <th>Control</th> <th>NIST</th> <th>ISO 27001</th> <th>SOC 2</th> <th>Implementation</th> </tr> </thead> <tbody> <tr> <td>Access Control</td> <td>AC-2, AC-3</td> <td>A.9.1, A.9.2</td> <td>CC6.1, CC6.2</td> <td>RBAC + ABAC</td> </tr> <tr> <td>Authentication</td> <td>IA-2, IA-5</td> <td>A.9.4</td> <td>CC6.1</td> <td>MFA + Device Attestation</td> </tr> <tr> <td>Encryption</td> <td>SC-8, SC-13</td> <td>A.10.1</td> <td>CC6.1</td> <td>AES-256-GCM</td> </tr> <tr> <td>Audit Logging</td> <td>AU-2, AU-3</td> <td>A.12.4</td> <td>CC7.1</td> <td>Comprehensive Audit Trail</td> </tr> <tr> <td>Incident Response</td> <td>IR-4, IR-6</td> <td>A.16.1</td> <td>CC7.3</td> <td>Automated + Manual Response</td> </tr> </tbody> </table> <h4 id="gdpr-compliance">GDPR Compliance<a class="headerlink" href="#gdpr-compliance" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-24-1"><a href="#__codelineno-24-1" id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">GDPRCompliance</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-2"><a href="#__codelineno-24-2" id="__codelineno-24-2" name="__codelineno-24-2"></a><span class="w">    </span><span class="nx">DataProcessor</span><span class="w">     </span><span class="o">*</span><span class="nx">DataProcessor</span><span class="w">     </span><span class="s">`json:"data_processor"`</span>
</span><span id="__span-24-3"><a href="#__codelineno-24-3" id="__codelineno-24-3" name="__codelineno-24-3"></a><span class="w">    </span><span class="nx">ConsentManager</span><span class="w">    </span><span class="o">*</span><span class="nx">ConsentManager</span><span class="w">    </span><span class="s">`json:"consent_manager"`</span>
</span><span id="__span-24-4"><a href="#__codelineno-24-4" id="__codelineno-24-4" name="__codelineno-24-4"></a><span class="w">    </span><span class="nx">DataRetention</span><span class="w">     </span><span class="o">*</span><span class="nx">RetentionPolicy</span><span class="w">   </span><span class="s">`json:"data_retention"`</span>
</span><span id="__span-24-5"><a href="#__codelineno-24-5" id="__codelineno-24-5" name="__codelineno-24-5"></a><span class="w">    </span><span class="nx">RightToErasure</span><span class="w">    </span><span class="o">*</span><span class="nx">ErasureService</span><span class="w">    </span><span class="s">`json:"right_to_erasure"`</span>
</span><span id="__span-24-6"><a href="#__codelineno-24-6" id="__codelineno-24-6" name="__codelineno-24-6"></a><span class="w">    </span><span class="nx">DataPortability</span><span class="w">   </span><span class="o">*</span><span class="nx">PortabilityService</span><span class="w"> </span><span class="s">`json:"data_portability"`</span>
</span><span id="__span-24-7"><a href="#__codelineno-24-7" id="__codelineno-24-7" name="__codelineno-24-7"></a><span class="w">    </span><span class="nx">PrivacyByDesign</span><span class="w">   </span><span class="o">*</span><span class="nx">PrivacyControls</span><span class="w">   </span><span class="s">`json:"privacy_by_design"`</span>
</span><span id="__span-24-8"><a href="#__codelineno-24-8" id="__codelineno-24-8" name="__codelineno-24-8"></a><span class="p">}</span>
</span><span id="__span-24-9"><a href="#__codelineno-24-9" id="__codelineno-24-9" name="__codelineno-24-9"></a>
</span><span id="__span-24-10"><a href="#__codelineno-24-10" id="__codelineno-24-10" name="__codelineno-24-10"></a><span class="kd">type</span><span class="w"> </span><span class="nx">DataProcessor</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-11"><a href="#__codelineno-24-11" id="__codelineno-24-11" name="__codelineno-24-11"></a><span class="w">    </span><span class="nx">PurposeLimitation</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">][]</span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"purpose_limitation"`</span>
</span><span id="__span-24-12"><a href="#__codelineno-24-12" id="__codelineno-24-12" name="__codelineno-24-12"></a><span class="w">    </span><span class="nx">DataMinimization</span><span class="w">  </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">][]</span><span class="kt">string</span><span class="w"> </span><span class="s">`json:"data_minimization"`</span>
</span><span id="__span-24-13"><a href="#__codelineno-24-13" id="__codelineno-24-13" name="__codelineno-24-13"></a><span class="w">    </span><span class="nx">StorageLimitation</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w"> </span><span class="s">`json:"storage_limitation"`</span>
</span><span id="__span-24-14"><a href="#__codelineno-24-14" id="__codelineno-24-14" name="__codelineno-24-14"></a><span class="w">    </span><span class="nx">ProcessingBasis</span><span class="w">   </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="w">   </span><span class="s">`json:"processing_basis"`</span>
</span><span id="__span-24-15"><a href="#__codelineno-24-15" id="__codelineno-24-15" name="__codelineno-24-15"></a><span class="p">}</span>
</span></code></pre></div> <h3 id="security-metrics">Security Metrics<a class="headerlink" href="#security-metrics" title="Permanent link">¬∂</a></h3> <h4 id="key-performance-indicators">Key Performance Indicators<a class="headerlink" href="#key-performance-indicators" title="Permanent link">¬∂</a></h4> <div class="language-go highlight"><pre><span></span><code><span id="__span-25-1"><a href="#__codelineno-25-1" id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">SecurityMetrics</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-2"><a href="#__codelineno-25-2" id="__codelineno-25-2" name="__codelineno-25-2"></a><span class="w">    </span><span class="nx">AuthenticationMetrics</span><span class="w">   </span><span class="nx">AuthMetrics</span><span class="w">      </span><span class="s">`json:"authentication_metrics"`</span>
</span><span id="__span-25-3"><a href="#__codelineno-25-3" id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="w">    </span><span class="nx">AuthorizationMetrics</span><span class="w">    </span><span class="nx">AuthzMetrics</span><span class="w">     </span><span class="s">`json:"authorization_metrics"`</span>
</span><span id="__span-25-4"><a href="#__codelineno-25-4" id="__codelineno-25-4" name="__codelineno-25-4"></a><span class="w">    </span><span class="nx">IncidentMetrics</span><span class="w">        </span><span class="nx">IncidentMetrics</span><span class="w">   </span><span class="s">`json:"incident_metrics"`</span>
</span><span id="__span-25-5"><a href="#__codelineno-25-5" id="__codelineno-25-5" name="__codelineno-25-5"></a><span class="w">    </span><span class="nx">ComplianceMetrics</span><span class="w">      </span><span class="nx">ComplianceMetrics</span><span class="w"> </span><span class="s">`json:"compliance_metrics"`</span>
</span><span id="__span-25-6"><a href="#__codelineno-25-6" id="__codelineno-25-6" name="__codelineno-25-6"></a><span class="p">}</span>
</span><span id="__span-25-7"><a href="#__codelineno-25-7" id="__codelineno-25-7" name="__codelineno-25-7"></a>
</span><span id="__span-25-8"><a href="#__codelineno-25-8" id="__codelineno-25-8" name="__codelineno-25-8"></a><span class="kd">type</span><span class="w"> </span><span class="nx">AuthMetrics</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-9"><a href="#__codelineno-25-9" id="__codelineno-25-9" name="__codelineno-25-9"></a><span class="w">    </span><span class="nx">LoginSuccessRate</span><span class="w">       </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"login_success_rate"`</span>
</span><span id="__span-25-10"><a href="#__codelineno-25-10" id="__codelineno-25-10" name="__codelineno-25-10"></a><span class="w">    </span><span class="nx">LoginFailureRate</span><span class="w">       </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"login_failure_rate"`</span>
</span><span id="__span-25-11"><a href="#__codelineno-25-11" id="__codelineno-25-11" name="__codelineno-25-11"></a><span class="w">    </span><span class="nx">MFAAdoptionRate</span><span class="w">        </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"mfa_adoption_rate"`</span>
</span><span id="__span-25-12"><a href="#__codelineno-25-12" id="__codelineno-25-12" name="__codelineno-25-12"></a><span class="w">    </span><span class="nx">PasswordStrengthScore</span><span class="w">  </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"password_strength_score"`</span>
</span><span id="__span-25-13"><a href="#__codelineno-25-13" id="__codelineno-25-13" name="__codelineno-25-13"></a><span class="w">    </span><span class="nx">AccountLockoutRate</span><span class="w">     </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"account_lockout_rate"`</span>
</span><span id="__span-25-14"><a href="#__codelineno-25-14" id="__codelineno-25-14" name="__codelineno-25-14"></a><span class="w">    </span><span class="nx">SuspiciousLoginRate</span><span class="w">    </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"suspicious_login_rate"`</span>
</span><span id="__span-25-15"><a href="#__codelineno-25-15" id="__codelineno-25-15" name="__codelineno-25-15"></a><span class="p">}</span>
</span><span id="__span-25-16"><a href="#__codelineno-25-16" id="__codelineno-25-16" name="__codelineno-25-16"></a>
</span><span id="__span-25-17"><a href="#__codelineno-25-17" id="__codelineno-25-17" name="__codelineno-25-17"></a><span class="kd">type</span><span class="w"> </span><span class="nx">AuthzMetrics</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-18"><a href="#__codelineno-25-18" id="__codelineno-25-18" name="__codelineno-25-18"></a><span class="w">    </span><span class="nx">AccessDenialRate</span><span class="w">       </span><span class="kt">float64</span><span class="w"> </span><span class="s">`json:"access_denial_rate"`</span>
</span><span id="__span-25-19"><a href="#__codelineno-25-19" id="__codelineno-25-19" name="__codelineno-25-19"></a><span class="w">    </span><span class="nx">PrivilegeEscalations</span><span class="w">   </span><span class="kt">int64</span><span class="w">   </span><span class="s">`json:"privilege_escalations"`</span>
</span><span id="__span-25-20"><a href="#__codelineno-25-20" id="__codelineno-25-20" name="__codelineno-25-20"></a><span class="w">    </span><span class="nx">PolicyViolations</span><span class="w">       </span><span class="kt">int64</span><span class="w">   </span><span class="s">`json:"policy_violations"`</span>
</span><span id="__span-25-21"><a href="#__codelineno-25-21" id="__codelineno-25-21" name="__codelineno-25-21"></a><span class="w">    </span><span class="nx">UnauthorizedAccess</span><span class="w">     </span><span class="kt">int64</span><span class="w">   </span><span class="s">`json:"unauthorized_access"`</span>
</span><span id="__span-25-22"><a href="#__codelineno-25-22" id="__codelineno-25-22" name="__codelineno-25-22"></a><span class="p">}</span>
</span><span id="__span-25-23"><a href="#__codelineno-25-23" id="__codelineno-25-23" name="__codelineno-25-23"></a>
</span><span id="__span-25-24"><a href="#__codelineno-25-24" id="__codelineno-25-24" name="__codelineno-25-24"></a><span class="kd">type</span><span class="w"> </span><span class="nx">IncidentMetrics</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-25"><a href="#__codelineno-25-25" id="__codelineno-25-25" name="__codelineno-25-25"></a><span class="w">    </span><span class="nx">IncidentCount</span><span class="w">          </span><span class="kt">int64</span><span class="w">         </span><span class="s">`json:"incident_count"`</span>
</span><span id="__span-25-26"><a href="#__codelineno-25-26" id="__codelineno-25-26" name="__codelineno-25-26"></a><span class="w">    </span><span class="nx">MeanTimeToDetection</span><span class="w">    </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w"> </span><span class="s">`json:"mean_time_to_detection"`</span>
</span><span id="__span-25-27"><a href="#__codelineno-25-27" id="__codelineno-25-27" name="__codelineno-25-27"></a><span class="w">    </span><span class="nx">MeanTimeToResponse</span><span class="w">     </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w"> </span><span class="s">`json:"mean_time_to_response"`</span>
</span><span id="__span-25-28"><a href="#__codelineno-25-28" id="__codelineno-25-28" name="__codelineno-25-28"></a><span class="w">    </span><span class="nx">MeanTimeToResolution</span><span class="w">   </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="w"> </span><span class="s">`json:"mean_time_to_resolution"`</span>
</span><span id="__span-25-29"><a href="#__codelineno-25-29" id="__codelineno-25-29" name="__codelineno-25-29"></a><span class="w">    </span><span class="nx">FalsePositiveRate</span><span class="w">      </span><span class="kt">float64</span><span class="w">       </span><span class="s">`json:"false_positive_rate"`</span>
</span><span id="__span-25-30"><a href="#__codelineno-25-30" id="__codelineno-25-30" name="__codelineno-25-30"></a><span class="w">    </span><span class="nx">SecurityEventVolume</span><span class="w">    </span><span class="kt">int64</span><span class="w">         </span><span class="s">`json:"security_event_volume"`</span>
</span><span id="__span-25-31"><a href="#__codelineno-25-31" id="__codelineno-25-31" name="__codelineno-25-31"></a><span class="p">}</span>
</span></code></pre></div> <h2 id="security-configuration-management">üîß Security Configuration Management<a class="headerlink" href="#security-configuration-management" title="Permanent link">¬∂</a></h2> <h3 id="environment-specific-security">Environment-specific Security<a class="headerlink" href="#environment-specific-security" title="Permanent link">¬∂</a></h3> <h4 id="development-security">Development Security<a class="headerlink" href="#development-security" title="Permanent link">¬∂</a></h4> <div class="language-yaml highlight"><pre><span></span><code><span id="__span-26-1"><a href="#__codelineno-26-1" id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="nt">security</span><span class="p">:</span>
</span><span id="__span-26-2"><a href="#__codelineno-26-2" id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="w">  </span><span class="nt">environment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">development</span>
</span><span id="__span-26-3"><a href="#__codelineno-26-3" id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="w">  </span><span class="nt">auth</span><span class="p">:</span>
</span><span id="__span-26-4"><a href="#__codelineno-26-4" id="__codelineno-26-4" name="__codelineno-26-4"></a><span class="w">    </span><span class="nt">jwt_secret</span><span class="p">:</span><span class="w"> </span><span class="s">"development-secret-do-not-use-in-production"</span>
</span><span id="__span-26-5"><a href="#__codelineno-26-5" id="__codelineno-26-5" name="__codelineno-26-5"></a><span class="w">    </span><span class="nt">token_expiration</span><span class="p">:</span><span class="w"> </span><span class="s">"24h"</span>
</span><span id="__span-26-6"><a href="#__codelineno-26-6" id="__codelineno-26-6" name="__codelineno-26-6"></a><span class="w">    </span><span class="nt">mfa_required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-26-7"><a href="#__codelineno-26-7" id="__codelineno-26-7" name="__codelineno-26-7"></a><span class="w">    </span><span class="nt">demo_tokens_enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-26-8"><a href="#__codelineno-26-8" id="__codelineno-26-8" name="__codelineno-26-8"></a>
</span><span id="__span-26-9"><a href="#__codelineno-26-9" id="__codelineno-26-9" name="__codelineno-26-9"></a><span class="w">  </span><span class="nt">encryption</span><span class="p">:</span>
</span><span id="__span-26-10"><a href="#__codelineno-26-10" id="__codelineno-26-10" name="__codelineno-26-10"></a><span class="w">    </span><span class="nt">at_rest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-26-11"><a href="#__codelineno-26-11" id="__codelineno-26-11" name="__codelineno-26-11"></a><span class="w">    </span><span class="nt">in_transit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-26-12"><a href="#__codelineno-26-12" id="__codelineno-26-12" name="__codelineno-26-12"></a><span class="w">    </span><span class="nt">tls_version</span><span class="p">:</span><span class="w"> </span><span class="s">"1.2"</span>
</span><span id="__span-26-13"><a href="#__codelineno-26-13" id="__codelineno-26-13" name="__codelineno-26-13"></a>
</span><span id="__span-26-14"><a href="#__codelineno-26-14" id="__codelineno-26-14" name="__codelineno-26-14"></a><span class="w">  </span><span class="nt">monitoring</span><span class="p">:</span>
</span><span id="__span-26-15"><a href="#__codelineno-26-15" id="__codelineno-26-15" name="__codelineno-26-15"></a><span class="w">    </span><span class="nt">audit_level</span><span class="p">:</span><span class="w"> </span><span class="s">"basic"</span>
</span><span id="__span-26-16"><a href="#__codelineno-26-16" id="__codelineno-26-16" name="__codelineno-26-16"></a><span class="w">    </span><span class="nt">log_level</span><span class="p">:</span><span class="w"> </span><span class="s">"debug"</span>
</span><span id="__span-26-17"><a href="#__codelineno-26-17" id="__codelineno-26-17" name="__codelineno-26-17"></a><span class="w">    </span><span class="nt">retention</span><span class="p">:</span><span class="w"> </span><span class="s">"7d"</span>
</span><span id="__span-26-18"><a href="#__codelineno-26-18" id="__codelineno-26-18" name="__codelineno-26-18"></a>
</span><span id="__span-26-19"><a href="#__codelineno-26-19" id="__codelineno-26-19" name="__codelineno-26-19"></a><span class="w">  </span><span class="nt">rate_limiting</span><span class="p">:</span>
</span><span id="__span-26-20"><a href="#__codelineno-26-20" id="__codelineno-26-20" name="__codelineno-26-20"></a><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-26-21"><a href="#__codelineno-26-21" id="__codelineno-26-21" name="__codelineno-26-21"></a><span class="w">    </span><span class="nt">strict</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span></code></pre></div> <h4 id="production-security">Production Security<a class="headerlink" href="#production-security" title="Permanent link">¬∂</a></h4> <div class="language-yaml highlight"><pre><span></span><code><span id="__span-27-1"><a href="#__codelineno-27-1" id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="nt">security</span><span class="p">:</span>
</span><span id="__span-27-2"><a href="#__codelineno-27-2" id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="w">  </span><span class="nt">environment</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">production</span>
</span><span id="__span-27-3"><a href="#__codelineno-27-3" id="__codelineno-27-3" name="__codelineno-27-3"></a><span class="w">  </span><span class="nt">auth</span><span class="p">:</span>
</span><span id="__span-27-4"><a href="#__codelineno-27-4" id="__codelineno-27-4" name="__codelineno-27-4"></a><span class="w">    </span><span class="nt">jwt_secret</span><span class="p">:</span><span class="w"> </span><span class="s">"${JWT_SECRET_FROM_VAULT}"</span>
</span><span id="__span-27-5"><a href="#__codelineno-27-5" id="__codelineno-27-5" name="__codelineno-27-5"></a><span class="w">    </span><span class="nt">token_expiration</span><span class="p">:</span><span class="w"> </span><span class="s">"1h"</span>
</span><span id="__span-27-6"><a href="#__codelineno-27-6" id="__codelineno-27-6" name="__codelineno-27-6"></a><span class="w">    </span><span class="nt">mfa_required</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-27-7"><a href="#__codelineno-27-7" id="__codelineno-27-7" name="__codelineno-27-7"></a><span class="w">    </span><span class="nt">demo_tokens_enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-27-8"><a href="#__codelineno-27-8" id="__codelineno-27-8" name="__codelineno-27-8"></a><span class="w">    </span><span class="nt">certificate_validation</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">strict</span>
</span><span id="__span-27-9"><a href="#__codelineno-27-9" id="__codelineno-27-9" name="__codelineno-27-9"></a>
</span><span id="__span-27-10"><a href="#__codelineno-27-10" id="__codelineno-27-10" name="__codelineno-27-10"></a><span class="w">  </span><span class="nt">encryption</span><span class="p">:</span>
</span><span id="__span-27-11"><a href="#__codelineno-27-11" id="__codelineno-27-11" name="__codelineno-27-11"></a><span class="w">    </span><span class="nt">at_rest</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-27-12"><a href="#__codelineno-27-12" id="__codelineno-27-12" name="__codelineno-27-12"></a><span class="w">    </span><span class="nt">in_transit</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-27-13"><a href="#__codelineno-27-13" id="__codelineno-27-13" name="__codelineno-27-13"></a><span class="w">    </span><span class="nt">tls_version</span><span class="p">:</span><span class="w"> </span><span class="s">"1.3"</span>
</span><span id="__span-27-14"><a href="#__codelineno-27-14" id="__codelineno-27-14" name="__codelineno-27-14"></a><span class="w">    </span><span class="nt">cipher_suites</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">"TLS_AES_256_GCM_SHA384"</span><span class="p p-Indicator">]</span>
</span><span id="__span-27-15"><a href="#__codelineno-27-15" id="__codelineno-27-15" name="__codelineno-27-15"></a><span class="w">    </span><span class="nt">key_rotation</span><span class="p">:</span><span class="w"> </span><span class="s">"90d"</span>
</span><span id="__span-27-16"><a href="#__codelineno-27-16" id="__codelineno-27-16" name="__codelineno-27-16"></a>
</span><span id="__span-27-17"><a href="#__codelineno-27-17" id="__codelineno-27-17" name="__codelineno-27-17"></a><span class="w">  </span><span class="nt">monitoring</span><span class="p">:</span>
</span><span id="__span-27-18"><a href="#__codelineno-27-18" id="__codelineno-27-18" name="__codelineno-27-18"></a><span class="w">    </span><span class="nt">audit_level</span><span class="p">:</span><span class="w"> </span><span class="s">"comprehensive"</span>
</span><span id="__span-27-19"><a href="#__codelineno-27-19" id="__codelineno-27-19" name="__codelineno-27-19"></a><span class="w">    </span><span class="nt">log_level</span><span class="p">:</span><span class="w"> </span><span class="s">"warn"</span>
</span><span id="__span-27-20"><a href="#__codelineno-27-20" id="__codelineno-27-20" name="__codelineno-27-20"></a><span class="w">    </span><span class="nt">retention</span><span class="p">:</span><span class="w"> </span><span class="s">"7y"</span>
</span><span id="__span-27-21"><a href="#__codelineno-27-21" id="__codelineno-27-21" name="__codelineno-27-21"></a><span class="w">    </span><span class="nt">real_time_alerting</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-27-22"><a href="#__codelineno-27-22" id="__codelineno-27-22" name="__codelineno-27-22"></a>
</span><span id="__span-27-23"><a href="#__codelineno-27-23" id="__codelineno-27-23" name="__codelineno-27-23"></a><span class="w">  </span><span class="nt">rate_limiting</span><span class="p">:</span>
</span><span id="__span-27-24"><a href="#__codelineno-27-24" id="__codelineno-27-24" name="__codelineno-27-24"></a><span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-27-25"><a href="#__codelineno-27-25" id="__codelineno-27-25" name="__codelineno-27-25"></a><span class="w">    </span><span class="nt">strict</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-27-26"><a href="#__codelineno-27-26" id="__codelineno-27-26" name="__codelineno-27-26"></a><span class="w">    </span><span class="nt">adaptive</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span><span id="__span-27-27"><a href="#__codelineno-27-27" id="__codelineno-27-27" name="__codelineno-27-27"></a>
</span><span id="__span-27-28"><a href="#__codelineno-27-28" id="__codelineno-27-28" name="__codelineno-27-28"></a><span class="w">  </span><span class="nt">compliance</span><span class="p">:</span>
</span><span id="__span-27-29"><a href="#__codelineno-27-29" id="__codelineno-27-29" name="__codelineno-27-29"></a><span class="w">    </span><span class="nt">frameworks</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">"NIST"</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">"ISO27001"</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">"SOC2"</span><span class="p p-Indicator">]</span>
</span><span id="__span-27-30"><a href="#__codelineno-27-30" id="__codelineno-27-30" name="__codelineno-27-30"></a><span class="w">    </span><span class="nt">data_retention</span><span class="p">:</span><span class="w"> </span><span class="s">"as_required"</span>
</span><span id="__span-27-31"><a href="#__codelineno-27-31" id="__codelineno-27-31" name="__codelineno-27-31"></a><span class="w">    </span><span class="nt">gdpr_enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</span></code></pre></div> <h2 id="security-documentation-and-training">üìö Security Documentation and Training<a class="headerlink" href="#security-documentation-and-training" title="Permanent link">¬∂</a></h2> <h3 id="security-procedures">Security Procedures<a class="headerlink" href="#security-procedures" title="Permanent link">¬∂</a></h3> <h4 id="security-incident-response-procedures">Security Incident Response Procedures<a class="headerlink" href="#security-incident-response-procedures" title="Permanent link">¬∂</a></h4> <ol> <li><strong>Detection and Analysis</strong> (0-15 minutes)</li> <li>Automated detection triggers alert</li> <li>Security team notified immediately</li> <li>Initial impact assessment performed</li> <li> <p>Incident severity classified</p> </li> <li> <p><strong>Containment</strong> (15-60 minutes)</p> </li> <li>Immediate containment actions executed</li> <li>Affected systems isolated</li> <li>User accounts secured</li> <li> <p>Evidence preservation initiated</p> </li> <li> <p><strong>Investigation</strong> (1-24 hours)</p> </li> <li>Detailed forensic analysis</li> <li>Root cause identification</li> <li>Impact assessment completion</li> <li> <p>Timeline reconstruction</p> </li> <li> <p><strong>Recovery</strong> (Variable)</p> </li> <li>System restoration</li> <li>Security patches applied</li> <li>Configuration hardening</li> <li> <p>Service restoration</p> </li> <li> <p><strong>Post-Incident</strong> (1-7 days)</p> </li> <li>Lessons learned documentation</li> <li>Process improvements</li> <li>Policy updates</li> <li>Training updates</li> </ol> <h3 id="security-training">Security Training<a class="headerlink" href="#security-training" title="Permanent link">¬∂</a></h3> <h4 id="required-training-programs">Required Training Programs<a class="headerlink" href="#required-training-programs" title="Permanent link">¬∂</a></h4> <ul> <li><strong>Security Awareness</strong>: All users (quarterly)</li> <li><strong>Secure Development</strong>: Developers (annually)</li> <li><strong>Incident Response</strong>: Security team (bi-annually)</li> <li><strong>Compliance Training</strong>: Management (annually)</li> <li><strong>Privacy Training</strong>: All staff (annually)</li> </ul> <h3 id="security-references">Security References<a class="headerlink" href="#security-references" title="Permanent link">¬∂</a></h3> <h4 id="external-resources">External Resources<a class="headerlink" href="#external-resources" title="Permanent link">¬∂</a></h4> <ul> <li><a href="https://www.nist.gov/cyberframework">NIST Cybersecurity Framework</a></li> <li><a href="https://owasp.org/www-project-top-ten/">OWASP Top 10</a></li> <li><a href="https://csrc.nist.gov/publications/detail/sp/800-207/final">Zero Trust Architecture (NIST SP 800-207)</a></li> <li><a href="https://www.cisecurity.org/controls/">CIS Controls</a></li> <li><a href="https://www.iso.org/standard/54534.html">ISO 27001:2013</a></li> </ul> <h4 id="internal-documentation">Internal Documentation<a class="headerlink" href="#internal-documentation" title="Permanent link">¬∂</a></h4> <ul> <li><a href="docs/security/policies.md">Security Policies</a></li> <li><a href="docs/security/playbooks/">Incident Response Playbooks</a></li> <li><a href="docs/architecture/security-diagrams.md">Security Architecture Diagrams</a></li> <li><a href="docs/security/threat-model.md">Threat Model</a></li> </ul> <aside class="md-source-file"> <span class="md-source-file__fact"> <span class="md-icon" title="Last update"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2025-06-18T22:59:31+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-06-18</span> </span> <span class="md-source-file__fact"> <span class="md-icon" title="Created"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"></path></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2025-06-18T22:59:31+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2025-06-18</span> </span> </aside> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button class="md-top md-icon" data-md-component="top" hidden="" type="button"> <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"></path></svg> Back to top </button> </main> <footer class="md-footer"> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> <div class="md-copyright__highlight"> Copyright ¬© 2024 Zamaz Development Team </div> </div> <div class="md-social"> <a class="md-social__link" href="https://github.com/zamaz/root-zamaz" rel="noopener" target="_blank" title="github.com"> <svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg> </a> <a class="md-social__link" href="https://hub.docker.com/r/zamaz/root-zamaz" rel="noopener" target="_blank" title="hub.docker.com"> <svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M349.9 236.3h-66.1v-59.4h66.1v59.4zm0-204.3h-66.1v60.7h66.1V32zm78.2 144.8H362v59.4h66.1v-59.4zm-156.3-72.1h-66.1v60.1h66.1v-60.1zm78.1 0h-66.1v60.1h66.1v-60.1zm276.8 100c-14.4-9.7-47.6-13.2-73.1-8.4-3.3-24-16.7-44.9-41.1-63.7l-14-9.3-9.3 14c-18.4 27.8-23.4 73.6-3.7 103.8-8.7 4.7-25.8 11.1-48.4 10.7H2.4c-8.7 50.8 5.8 116.8 44 162.1 37.1 43.9 92.7 66.2 165.4 66.2 157.4 0 273.9-72.5 328.4-204.2 21.4.4 67.6.1 91.3-45.2 1.5-2.5 6.6-13.2 8.5-17.1l-13.3-8.9zm-511.1-27.9h-66v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm78.1 0h-66.1v59.4h66.1v-59.4zm-78.1-72.1h-66.1v60.1h66.1v-60.1z"></path></svg> </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.path", "navigation.top", "navigation.tracking", "search.suggest", "search.highlight", "search.share", "header.autohide", "content.code.copy", "content.code.select", "content.code.annotate", "content.tabs.link", "content.tooltips", "content.action.edit", "content.action.view", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script> <script src="../../assets/javascripts/bundle.d7c377c4.min.js"></script> <script src="../../js/timeago.min.js"></script> <script src="../../js/timeago_mkdocs_material.js"></script> <script src="../../assets/javascripts/mathjax.js"></script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script> <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});})</script></body> </html>