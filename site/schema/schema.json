{"name":"mvp_db","tables":[{"name":"public.user_sessions","type":"BASE TABLE","columns":[{"name":"id","type":"uuid","nullable":false,"default":"gen_random_uuid()"},{"name":"user_id","type":"uuid","nullable":false},{"name":"session_token","type":"varchar(255)","nullable":false},{"name":"expires_at","type":"timestamp with time zone","nullable":false},{"name":"is_active","type":"boolean","nullable":true,"default":"true"},{"name":"device_id","type":"varchar(100)","nullable":true},{"name":"ip_address","type":"varchar(45)","nullable":true},{"name":"user_agent","type":"varchar(500)","nullable":true},{"name":"location","type":"varchar(100)","nullable":true},{"name":"trust_level","type":"integer","nullable":true,"default":"0"},{"name":"created_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"updated_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"deleted_at","type":"timestamp with time zone","nullable":true}],"indexes":[{"name":"user_sessions_pkey","def":"CREATE UNIQUE INDEX user_sessions_pkey ON public.user_sessions USING btree (id)","table":"public.user_sessions","columns":["id"]},{"name":"user_sessions_session_token_key","def":"CREATE UNIQUE INDEX user_sessions_session_token_key ON public.user_sessions USING btree (session_token)","table":"public.user_sessions","columns":["session_token"]},{"name":"idx_user_sessions_token","def":"CREATE INDEX idx_user_sessions_token ON public.user_sessions USING btree (session_token)","table":"public.user_sessions","columns":["session_token"]},{"name":"idx_user_sessions_user_id","def":"CREATE INDEX idx_user_sessions_user_id ON public.user_sessions USING btree (user_id)","table":"public.user_sessions","columns":["user_id"]},{"name":"idx_user_sessions_expires_at","def":"CREATE INDEX idx_user_sessions_expires_at ON public.user_sessions USING btree (expires_at)","table":"public.user_sessions","columns":["expires_at"]},{"name":"idx_user_sessions_session_token","def":"CREATE INDEX idx_user_sessions_session_token ON public.user_sessions USING btree (session_token)","table":"public.user_sessions","columns":["session_token"]},{"name":"idx_user_sessions_user_active","def":"CREATE INDEX idx_user_sessions_user_active ON public.user_sessions USING btree (user_id, is_active) WHERE (is_active = true)","table":"public.user_sessions","columns":["user_id","is_active"]},{"name":"idx_user_sessions_device_user","def":"CREATE INDEX idx_user_sessions_device_user ON public.user_sessions USING btree (device_id, user_id)","table":"public.user_sessions","columns":["device_id","user_id"]},{"name":"idx_user_sessions_ip_created","def":"CREATE INDEX idx_user_sessions_ip_created ON public.user_sessions USING btree (ip_address, created_at DESC)","table":"public.user_sessions","columns":["ip_address","created_at"]},{"name":"idx_user_sessions_token_active","def":"CREATE INDEX idx_user_sessions_token_active ON public.user_sessions USING btree (session_token) WHERE (is_active = true)","table":"public.user_sessions","columns":["session_token"]},{"name":"idx_user_sessions_user_device_active","def":"CREATE INDEX idx_user_sessions_user_device_active ON public.user_sessions USING btree (user_id, device_id, is_active)","table":"public.user_sessions","columns":["user_id","device_id","is_active"]}],"constraints":[{"name":"user_sessions_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.user_sessions","referenced_table":"","columns":["id"]},{"name":"user_sessions_session_token_key","type":"UNIQUE","def":"UNIQUE (session_token)","table":"public.user_sessions","referenced_table":"","columns":["session_token"]}]},{"name":"public.roles","type":"BASE TABLE","columns":[{"name":"id","type":"bigint","nullable":false,"default":"nextval('roles_id_seq'::regclass)"},{"name":"name","type":"varchar(50)","nullable":false},{"name":"description","type":"varchar(200)","nullable":true},{"name":"is_active","type":"boolean","nullable":true,"default":"true"},{"name":"created_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"updated_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"deleted_at","type":"timestamp with time zone","nullable":true}],"indexes":[{"name":"roles_pkey","def":"CREATE UNIQUE INDEX roles_pkey ON public.roles USING btree (id)","table":"public.roles","columns":["id"]},{"name":"roles_name_key","def":"CREATE UNIQUE INDEX roles_name_key ON public.roles USING btree (name)","table":"public.roles","columns":["name"]},{"name":"idx_roles_name","def":"CREATE INDEX idx_roles_name ON public.roles USING btree (name)","table":"public.roles","columns":["name"]},{"name":"idx_roles_name_active","def":"CREATE INDEX idx_roles_name_active ON public.roles USING btree (name) WHERE (is_active = true)","table":"public.roles","columns":["name"]}],"constraints":[{"name":"roles_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.roles","referenced_table":"","columns":["id"]},{"name":"roles_name_key","type":"UNIQUE","def":"UNIQUE (name)","table":"public.roles","referenced_table":"","columns":["name"]}]},{"name":"public.permissions","type":"BASE TABLE","columns":[{"name":"id","type":"bigint","nullable":false,"default":"nextval('permissions_id_seq'::regclass)"},{"name":"name","type":"varchar(100)","nullable":false},{"name":"resource","type":"varchar(50)","nullable":false},{"name":"action","type":"varchar(50)","nullable":false},{"name":"description","type":"varchar(200)","nullable":true},{"name":"is_active","type":"boolean","nullable":true,"default":"true"},{"name":"created_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"updated_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"deleted_at","type":"timestamp with time zone","nullable":true}],"indexes":[{"name":"permissions_pkey","def":"CREATE UNIQUE INDEX permissions_pkey ON public.permissions USING btree (id)","table":"public.permissions","columns":["id"]},{"name":"permissions_name_key","def":"CREATE UNIQUE INDEX permissions_name_key ON public.permissions USING btree (name)","table":"public.permissions","columns":["name"]},{"name":"idx_permissions_resource_action","def":"CREATE INDEX idx_permissions_resource_action ON public.permissions USING btree (resource, action)","table":"public.permissions","columns":["resource","action"]},{"name":"idx_permissions_resource_action_active","def":"CREATE INDEX idx_permissions_resource_action_active ON public.permissions USING btree (resource, action) WHERE (is_active = true)","table":"public.permissions","columns":["resource","action"]},{"name":"idx_permissions_name_active","def":"CREATE INDEX idx_permissions_name_active ON public.permissions USING btree (name) WHERE (is_active = true)","table":"public.permissions","columns":["name"]}],"constraints":[{"name":"permissions_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.permissions","referenced_table":"","columns":["id"]},{"name":"permissions_name_key","type":"UNIQUE","def":"UNIQUE (name)","table":"public.permissions","referenced_table":"","columns":["name"]}]},{"name":"public.user_roles","type":"BASE TABLE","columns":[{"name":"user_id","type":"uuid","nullable":false},{"name":"role_id","type":"bigint","nullable":false}],"indexes":[{"name":"user_roles_pkey","def":"CREATE UNIQUE INDEX user_roles_pkey ON public.user_roles USING btree (user_id, role_id)","table":"public.user_roles","columns":["user_id","role_id"]},{"name":"idx_user_roles_user_id","def":"CREATE INDEX idx_user_roles_user_id ON public.user_roles USING btree (user_id)","table":"public.user_roles","columns":["user_id"]},{"name":"idx_user_roles_role_id","def":"CREATE INDEX idx_user_roles_role_id ON public.user_roles USING btree (role_id)","table":"public.user_roles","columns":["role_id"]},{"name":"idx_user_roles_user_id_opt","def":"CREATE INDEX idx_user_roles_user_id_opt ON public.user_roles USING btree (user_id)","table":"public.user_roles","columns":["user_id"]},{"name":"idx_user_roles_role_id_opt","def":"CREATE INDEX idx_user_roles_role_id_opt ON public.user_roles USING btree (role_id)","table":"public.user_roles","columns":["role_id"]}],"constraints":[{"name":"user_roles_role_id_fkey","type":"FOREIGN KEY","def":"FOREIGN KEY (role_id) REFERENCES roles(id) ON DELETE CASCADE","table":"public.user_roles","referenced_table":"roles","columns":["role_id"],"referenced_columns":["id"]},{"name":"user_roles_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (user_id, role_id)","table":"public.user_roles","referenced_table":"","columns":["user_id","role_id"]}]},{"name":"public.role_permissions","type":"BASE TABLE","columns":[{"name":"role_id","type":"bigint","nullable":false},{"name":"permission_id","type":"bigint","nullable":false}],"indexes":[{"name":"role_permissions_pkey","def":"CREATE UNIQUE INDEX role_permissions_pkey ON public.role_permissions USING btree (role_id, permission_id)","table":"public.role_permissions","columns":["role_id","permission_id"]},{"name":"idx_role_permissions_role_id","def":"CREATE INDEX idx_role_permissions_role_id ON public.role_permissions USING btree (role_id)","table":"public.role_permissions","columns":["role_id"]},{"name":"idx_role_permissions_permission_id","def":"CREATE INDEX idx_role_permissions_permission_id ON public.role_permissions USING btree (permission_id)","table":"public.role_permissions","columns":["permission_id"]},{"name":"idx_role_permissions_role_id_opt","def":"CREATE INDEX idx_role_permissions_role_id_opt ON public.role_permissions USING btree (role_id)","table":"public.role_permissions","columns":["role_id"]},{"name":"idx_role_permissions_permission_id_opt","def":"CREATE INDEX idx_role_permissions_permission_id_opt ON public.role_permissions USING btree (permission_id)","table":"public.role_permissions","columns":["permission_id"]}],"constraints":[{"name":"role_permissions_role_id_fkey","type":"FOREIGN KEY","def":"FOREIGN KEY (role_id) REFERENCES roles(id) ON DELETE CASCADE","table":"public.role_permissions","referenced_table":"roles","columns":["role_id"],"referenced_columns":["id"]},{"name":"role_permissions_permission_id_fkey","type":"FOREIGN KEY","def":"FOREIGN KEY (permission_id) REFERENCES permissions(id) ON DELETE CASCADE","table":"public.role_permissions","referenced_table":"permissions","columns":["permission_id"],"referenced_columns":["id"]},{"name":"role_permissions_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (role_id, permission_id)","table":"public.role_permissions","referenced_table":"","columns":["role_id","permission_id"]}]},{"name":"public.login_attempts","type":"BASE TABLE","columns":[{"name":"id","type":"uuid","nullable":false,"default":"gen_random_uuid()"},{"name":"username","type":"varchar(50)","nullable":false},{"name":"user_id","type":"uuid","nullable":true},{"name":"ip_address","type":"varchar(45)","nullable":false},{"name":"user_agent","type":"varchar(500)","nullable":true},{"name":"success","type":"boolean","nullable":true,"default":"false"},{"name":"failure_reason","type":"varchar(200)","nullable":true},{"name":"is_suspicious","type":"boolean","nullable":true,"default":"false"},{"name":"blocked_by_rate","type":"boolean","nullable":true,"default":"false"},{"name":"request_id","type":"varchar(100)","nullable":true},{"name":"created_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"}],"indexes":[{"name":"login_attempts_pkey","def":"CREATE UNIQUE INDEX login_attempts_pkey ON public.login_attempts USING btree (id)","table":"public.login_attempts","columns":["id"]},{"name":"idx_login_attempts_username","def":"CREATE INDEX idx_login_attempts_username ON public.login_attempts USING btree (username)","table":"public.login_attempts","columns":["username"]},{"name":"idx_login_attempts_user_id","def":"CREATE INDEX idx_login_attempts_user_id ON public.login_attempts USING btree (user_id)","table":"public.login_attempts","columns":["user_id"]},{"name":"idx_login_attempts_ip_address","def":"CREATE INDEX idx_login_attempts_ip_address ON public.login_attempts USING btree (ip_address)","table":"public.login_attempts","columns":["ip_address"]},{"name":"idx_login_attempts_success","def":"CREATE INDEX idx_login_attempts_success ON public.login_attempts USING btree (success)","table":"public.login_attempts","columns":["success"]},{"name":"idx_login_attempts_created_at","def":"CREATE INDEX idx_login_attempts_created_at ON public.login_attempts USING btree (created_at)","table":"public.login_attempts","columns":["created_at"]},{"name":"idx_login_attempts_suspicious","def":"CREATE INDEX idx_login_attempts_suspicious ON public.login_attempts USING btree (is_suspicious)","table":"public.login_attempts","columns":["is_suspicious"]},{"name":"idx_login_attempts_ip_success_time","def":"CREATE INDEX idx_login_attempts_ip_success_time ON public.login_attempts USING btree (ip_address, success, created_at)","table":"public.login_attempts","columns":["ip_address","success","created_at"]},{"name":"idx_login_attempts_username_success_time","def":"CREATE INDEX idx_login_attempts_username_success_time ON public.login_attempts USING btree (username, success, created_at)","table":"public.login_attempts","columns":["username","success","created_at"]},{"name":"idx_login_attempts_username_created","def":"CREATE INDEX idx_login_attempts_username_created ON public.login_attempts USING btree (username, created_at DESC)","table":"public.login_attempts","columns":["username","created_at"]},{"name":"idx_login_attempts_ip_created","def":"CREATE INDEX idx_login_attempts_ip_created ON public.login_attempts USING btree (ip_address, created_at DESC)","table":"public.login_attempts","columns":["ip_address","created_at"]},{"name":"idx_login_attempts_success_created","def":"CREATE INDEX idx_login_attempts_success_created ON public.login_attempts USING btree (success, created_at DESC)","table":"public.login_attempts","columns":["success","created_at"]},{"name":"idx_login_attempts_user_success","def":"CREATE INDEX idx_login_attempts_user_success ON public.login_attempts USING btree (user_id, success, created_at DESC)","table":"public.login_attempts","columns":["user_id","success","created_at"]}],"constraints":[{"name":"login_attempts_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.login_attempts","referenced_table":"","columns":["id"]}]},{"name":"public.audit_logs","type":"BASE TABLE","columns":[{"name":"id","type":"uuid","nullable":false,"default":"gen_random_uuid()"},{"name":"user_id","type":"uuid","nullable":true},{"name":"action","type":"varchar(100)","nullable":false},{"name":"resource","type":"varchar(100)","nullable":true},{"name":"details","type":"jsonb","nullable":true},{"name":"ip_address","type":"varchar(45)","nullable":true},{"name":"user_agent","type":"varchar(500)","nullable":true},{"name":"request_id","type":"varchar(100)","nullable":true},{"name":"success","type":"boolean","nullable":true,"default":"false"},{"name":"error_msg","type":"varchar(500)","nullable":true},{"name":"created_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"compliance_tag","type":"varchar(50)","nullable":true},{"name":"retain_until","type":"timestamp with time zone","nullable":true}],"indexes":[{"name":"audit_logs_pkey","def":"CREATE UNIQUE INDEX audit_logs_pkey ON public.audit_logs USING btree (id)","table":"public.audit_logs","columns":["id"]},{"name":"idx_audit_logs_user_id","def":"CREATE INDEX idx_audit_logs_user_id ON public.audit_logs USING btree (user_id)","table":"public.audit_logs","columns":["user_id"]},{"name":"idx_audit_logs_action","def":"CREATE INDEX idx_audit_logs_action ON public.audit_logs USING btree (action)","table":"public.audit_logs","columns":["action"]},{"name":"idx_audit_logs_created_at","def":"CREATE INDEX idx_audit_logs_created_at ON public.audit_logs USING btree (created_at)","table":"public.audit_logs","columns":["created_at"]},{"name":"idx_audit_logs_user_created","def":"CREATE INDEX idx_audit_logs_user_created ON public.audit_logs USING btree (user_id, created_at DESC)","table":"public.audit_logs","columns":["user_id","created_at"]},{"name":"idx_audit_logs_action_created","def":"CREATE INDEX idx_audit_logs_action_created ON public.audit_logs USING btree (action, created_at DESC)","table":"public.audit_logs","columns":["action","created_at"]},{"name":"idx_audit_logs_success_created","def":"CREATE INDEX idx_audit_logs_success_created ON public.audit_logs USING btree (success, created_at DESC)","table":"public.audit_logs","columns":["success","created_at"]},{"name":"idx_audit_logs_ip_created","def":"CREATE INDEX idx_audit_logs_ip_created ON public.audit_logs USING btree (ip_address, created_at DESC)","table":"public.audit_logs","columns":["ip_address","created_at"]},{"name":"idx_audit_logs_resource_action","def":"CREATE INDEX idx_audit_logs_resource_action ON public.audit_logs USING btree (resource, action)","table":"public.audit_logs","columns":["resource","action"]},{"name":"idx_audit_logs_user_action_time","def":"CREATE INDEX idx_audit_logs_user_action_time ON public.audit_logs USING btree (user_id, action, created_at DESC)","table":"public.audit_logs","columns":["user_id","action","created_at"]}],"constraints":[{"name":"audit_logs_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.audit_logs","referenced_table":"","columns":["id"]}]},{"name":"public.schema_migrations","type":"BASE TABLE","columns":[{"name":"id","type":"text","nullable":false},{"name":"description","type":"text","nullable":false},{"name":"version","type":"bigint","nullable":false},{"name":"executed_at","type":"timestamp with time zone","nullable":false,"default":"CURRENT_TIMESTAMP"},{"name":"checksum","type":"text","nullable":false}],"indexes":[{"name":"schema_migrations_pkey","def":"CREATE UNIQUE INDEX schema_migrations_pkey ON public.schema_migrations USING btree (id)","table":"public.schema_migrations","columns":["id"]},{"name":"idx_schema_migrations_version","def":"CREATE UNIQUE INDEX idx_schema_migrations_version ON public.schema_migrations USING btree (version)","table":"public.schema_migrations","columns":["version"]}],"constraints":[{"name":"schema_migrations_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.schema_migrations","referenced_table":"","columns":["id"]}]},{"name":"public.users","type":"BASE TABLE","columns":[{"name":"id","type":"uuid","nullable":false,"default":"gen_random_uuid()"},{"name":"username","type":"varchar(50)","nullable":false},{"name":"email","type":"varchar(100)","nullable":false},{"name":"password_hash","type":"varchar(255)","nullable":false},{"name":"first_name","type":"varchar(50)","nullable":true},{"name":"last_name","type":"varchar(50)","nullable":true},{"name":"is_active","type":"boolean","nullable":true,"default":"true"},{"name":"is_admin","type":"boolean","nullable":true,"default":"false"},{"name":"failed_login_attempts","type":"integer","nullable":true,"default":"0"},{"name":"last_failed_login_at","type":"timestamp with time zone","nullable":true},{"name":"account_locked_at","type":"timestamp with time zone","nullable":true},{"name":"account_locked_until","type":"timestamp with time zone","nullable":true},{"name":"last_login_at","type":"timestamp with time zone","nullable":true},{"name":"last_login_ip","type":"varchar(45)","nullable":true},{"name":"created_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"updated_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"deleted_at","type":"timestamp with time zone","nullable":true}],"indexes":[{"name":"users_pkey","def":"CREATE UNIQUE INDEX users_pkey ON public.users USING btree (id)","table":"public.users","columns":["id"]},{"name":"users_username_key","def":"CREATE UNIQUE INDEX users_username_key ON public.users USING btree (username)","table":"public.users","columns":["username"]},{"name":"users_email_key","def":"CREATE UNIQUE INDEX users_email_key ON public.users USING btree (email)","table":"public.users","columns":["email"]},{"name":"idx_users_username","def":"CREATE INDEX idx_users_username ON public.users USING btree (username)","table":"public.users","columns":["username"]},{"name":"idx_users_email","def":"CREATE INDEX idx_users_email ON public.users USING btree (email)","table":"public.users","columns":["email"]},{"name":"idx_users_active","def":"CREATE INDEX idx_users_active ON public.users USING btree (is_active)","table":"public.users","columns":["is_active"]},{"name":"idx_users_email_active","def":"CREATE INDEX idx_users_email_active ON public.users USING btree (email) WHERE (is_active = true)","table":"public.users","columns":["email"]},{"name":"idx_users_username_active","def":"CREATE INDEX idx_users_username_active ON public.users USING btree (username) WHERE (is_active = true)","table":"public.users","columns":["username"]},{"name":"idx_users_failed_login_attempts","def":"CREATE INDEX idx_users_failed_login_attempts ON public.users USING btree (failed_login_attempts) WHERE (failed_login_attempts \u003e 0)","table":"public.users","columns":["failed_login_attempts"]},{"name":"idx_users_account_locked","def":"CREATE INDEX idx_users_account_locked ON public.users USING btree (account_locked_until) WHERE (account_locked_until IS NOT NULL)","table":"public.users","columns":["account_locked_until"]},{"name":"idx_users_last_login","def":"CREATE INDEX idx_users_last_login ON public.users USING btree (last_login_at DESC)","table":"public.users","columns":["last_login_at"]},{"name":"idx_users_deleted_at","def":"CREATE INDEX idx_users_deleted_at ON public.users USING btree (deleted_at)","table":"public.users","columns":["deleted_at"]},{"name":"idx_users_account_locked_until","def":"CREATE INDEX idx_users_account_locked_until ON public.users USING btree (account_locked_until)","table":"public.users","columns":["account_locked_until"]}],"constraints":[{"name":"users_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.users","referenced_table":"","columns":["id"]},{"name":"users_username_key","type":"UNIQUE","def":"UNIQUE (username)","table":"public.users","referenced_table":"","columns":["username"]},{"name":"users_email_key","type":"UNIQUE","def":"UNIQUE (email)","table":"public.users","referenced_table":"","columns":["email"]}]},{"name":"public.device_attestations","type":"BASE TABLE","columns":[{"name":"id","type":"uuid","nullable":false,"default":"gen_random_uuid()"},{"name":"user_id","type":"uuid","nullable":false},{"name":"device_id","type":"varchar(255)","nullable":false},{"name":"device_name","type":"varchar(100)","nullable":false},{"name":"platform","type":"varchar(50)","nullable":false},{"name":"spiffe_id","type":"varchar(255)","nullable":true},{"name":"workload_selector","type":"varchar(255)","nullable":true},{"name":"attestation_data","type":"jsonb","nullable":true},{"name":"status","type":"varchar(20)","nullable":true,"default":"'pending'::character varying"},{"name":"trust_level","type":"integer","nullable":true,"default":"0"},{"name":"is_verified","type":"boolean","nullable":true,"default":"false"},{"name":"verified_at","type":"timestamp with time zone","nullable":true},{"name":"expires_at","type":"timestamp with time zone","nullable":true},{"name":"created_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"updated_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"}],"indexes":[{"name":"device_attestations_pkey","def":"CREATE UNIQUE INDEX device_attestations_pkey ON public.device_attestations USING btree (id)","table":"public.device_attestations","columns":["id"]},{"name":"device_attestations_device_id_key","def":"CREATE UNIQUE INDEX device_attestations_device_id_key ON public.device_attestations USING btree (device_id)","table":"public.device_attestations","columns":["device_id"]},{"name":"idx_device_attestations_user_id","def":"CREATE INDEX idx_device_attestations_user_id ON public.device_attestations USING btree (user_id)","table":"public.device_attestations","columns":["user_id"]},{"name":"idx_device_attestations_device_id","def":"CREATE INDEX idx_device_attestations_device_id ON public.device_attestations USING btree (device_id)","table":"public.device_attestations","columns":["device_id"]},{"name":"idx_device_attestations_status","def":"CREATE INDEX idx_device_attestations_status ON public.device_attestations USING btree (status)","table":"public.device_attestations","columns":["status"]},{"name":"idx_device_attestations_user_status","def":"CREATE INDEX idx_device_attestations_user_status ON public.device_attestations USING btree (user_id, is_verified, trust_level)","table":"public.device_attestations","columns":["user_id","is_verified","trust_level"]},{"name":"idx_device_attestations_device_verified","def":"CREATE INDEX idx_device_attestations_device_verified ON public.device_attestations USING btree (device_id, is_verified)","table":"public.device_attestations","columns":["device_id","is_verified"]},{"name":"idx_device_attestations_platform_trust","def":"CREATE INDEX idx_device_attestations_platform_trust ON public.device_attestations USING btree (platform, trust_level)","table":"public.device_attestations","columns":["platform","trust_level"]},{"name":"idx_device_attestations_spiffe_id","def":"CREATE INDEX idx_device_attestations_spiffe_id ON public.device_attestations USING btree (spiffe_id)","table":"public.device_attestations","columns":["spiffe_id"]},{"name":"idx_device_attestations_verified_at","def":"CREATE INDEX idx_device_attestations_verified_at ON public.device_attestations USING btree (verified_at DESC) WHERE (verified_at IS NOT NULL)","table":"public.device_attestations","columns":["verified_at"]}],"constraints":[{"name":"device_attestations_user_id_fkey","type":"FOREIGN KEY","def":"FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE","table":"public.device_attestations","referenced_table":"users","columns":["user_id"],"referenced_columns":["id"]},{"name":"device_attestations_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.device_attestations","referenced_table":"","columns":["id"]},{"name":"device_attestations_device_id_key","type":"UNIQUE","def":"UNIQUE (device_id)","table":"public.device_attestations","referenced_table":"","columns":["device_id"]}]},{"name":"public.compliance_audit_logs","type":"BASE TABLE","columns":[{"name":"id","type":"uuid","nullable":false,"default":"gen_random_uuid()"},{"name":"created_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"updated_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"deleted_at","type":"timestamp with time zone","nullable":true},{"name":"user_id","type":"uuid","nullable":true},{"name":"action","type":"varchar(100)","nullable":false},{"name":"resource","type":"varchar(100)","nullable":true},{"name":"details","type":"jsonb","nullable":true},{"name":"success","type":"boolean","nullable":true,"default":"false"},{"name":"error_msg","type":"varchar(500)","nullable":true},{"name":"ip_address","type":"varchar(45)","nullable":true},{"name":"user_agent","type":"varchar(500)","nullable":true},{"name":"request_id","type":"varchar(100)","nullable":true},{"name":"session_id","type":"varchar(100)","nullable":true},{"name":"tenant_id","type":"varchar(100)","nullable":true},{"name":"compliance_frameworks","type":"varchar(200)","nullable":true},{"name":"data_classification","type":"varchar(50)","nullable":true},{"name":"sensitivity_level","type":"integer","nullable":true,"default":"1"},{"name":"legal_basis","type":"varchar(50)","nullable":true},{"name":"data_subjects","type":"jsonb","nullable":true},{"name":"data_categories","type":"jsonb","nullable":true},{"name":"processing_purpose","type":"varchar(500)","nullable":true},{"name":"geolocation_country","type":"varchar(10)","nullable":true},{"name":"risk_score","type":"integer","nullable":true,"default":"0"},{"name":"controls_applied","type":"jsonb","nullable":true},{"name":"approval_required","type":"boolean","nullable":true,"default":"false"},{"name":"approval_status","type":"varchar(50)","nullable":true},{"name":"review_status","type":"varchar(50)","nullable":true},{"name":"retention_category","type":"varchar(50)","nullable":true},{"name":"business_justification","type":"varchar(1000)","nullable":true},{"name":"retain_until","type":"timestamp with time zone","nullable":true},{"name":"archive_date","type":"timestamp with time zone","nullable":true},{"name":"purge_date","type":"timestamp with time zone","nullable":true},{"name":"archived","type":"boolean","nullable":true,"default":"false"},{"name":"archived_at","type":"timestamp with time zone","nullable":true},{"name":"business_context","type":"jsonb","nullable":true},{"name":"technical_context","type":"jsonb","nullable":true}],"indexes":[{"name":"compliance_audit_logs_pkey","def":"CREATE UNIQUE INDEX compliance_audit_logs_pkey ON public.compliance_audit_logs USING btree (id)","table":"public.compliance_audit_logs","columns":["id"]},{"name":"idx_compliance_audit_logs_user_id","def":"CREATE INDEX idx_compliance_audit_logs_user_id ON public.compliance_audit_logs USING btree (user_id)","table":"public.compliance_audit_logs","columns":["user_id"]},{"name":"idx_compliance_audit_logs_action","def":"CREATE INDEX idx_compliance_audit_logs_action ON public.compliance_audit_logs USING btree (action)","table":"public.compliance_audit_logs","columns":["action"]},{"name":"idx_compliance_audit_logs_created_at","def":"CREATE INDEX idx_compliance_audit_logs_created_at ON public.compliance_audit_logs USING btree (created_at DESC)","table":"public.compliance_audit_logs","columns":["created_at"]},{"name":"idx_compliance_audit_logs_data_classification","def":"CREATE INDEX idx_compliance_audit_logs_data_classification ON public.compliance_audit_logs USING btree (data_classification)","table":"public.compliance_audit_logs","columns":["data_classification"]},{"name":"idx_compliance_audit_logs_sensitivity_level","def":"CREATE INDEX idx_compliance_audit_logs_sensitivity_level ON public.compliance_audit_logs USING btree (sensitivity_level)","table":"public.compliance_audit_logs","columns":["sensitivity_level"]},{"name":"idx_compliance_audit_logs_risk_score","def":"CREATE INDEX idx_compliance_audit_logs_risk_score ON public.compliance_audit_logs USING btree (risk_score)","table":"public.compliance_audit_logs","columns":["risk_score"]},{"name":"idx_compliance_audit_logs_retention_category","def":"CREATE INDEX idx_compliance_audit_logs_retention_category ON public.compliance_audit_logs USING btree (retention_category)","table":"public.compliance_audit_logs","columns":["retention_category"]},{"name":"idx_compliance_audit_logs_archive_date","def":"CREATE INDEX idx_compliance_audit_logs_archive_date ON public.compliance_audit_logs USING btree (archive_date)","table":"public.compliance_audit_logs","columns":["archive_date"]},{"name":"idx_compliance_audit_logs_purge_date","def":"CREATE INDEX idx_compliance_audit_logs_purge_date ON public.compliance_audit_logs USING btree (purge_date)","table":"public.compliance_audit_logs","columns":["purge_date"]},{"name":"idx_compliance_audit_logs_archived","def":"CREATE INDEX idx_compliance_audit_logs_archived ON public.compliance_audit_logs USING btree (archived)","table":"public.compliance_audit_logs","columns":["archived"]},{"name":"idx_compliance_audit_logs_geolocation","def":"CREATE INDEX idx_compliance_audit_logs_geolocation ON public.compliance_audit_logs USING btree (geolocation_country)","table":"public.compliance_audit_logs","columns":["geolocation_country"]},{"name":"idx_compliance_audit_logs_request_id","def":"CREATE INDEX idx_compliance_audit_logs_request_id ON public.compliance_audit_logs USING btree (request_id)","table":"public.compliance_audit_logs","columns":["request_id"]},{"name":"idx_compliance_audit_logs_session_id","def":"CREATE INDEX idx_compliance_audit_logs_session_id ON public.compliance_audit_logs USING btree (session_id)","table":"public.compliance_audit_logs","columns":["session_id"]},{"name":"idx_compliance_audit_logs_tenant_id","def":"CREATE INDEX idx_compliance_audit_logs_tenant_id ON public.compliance_audit_logs USING btree (tenant_id)","table":"public.compliance_audit_logs","columns":["tenant_id"]},{"name":"idx_compliance_audit_logs_user_time","def":"CREATE INDEX idx_compliance_audit_logs_user_time ON public.compliance_audit_logs USING btree (user_id, created_at DESC)","table":"public.compliance_audit_logs","columns":["user_id","created_at"]},{"name":"idx_compliance_audit_logs_classification_risk","def":"CREATE INDEX idx_compliance_audit_logs_classification_risk ON public.compliance_audit_logs USING btree (data_classification, risk_score DESC)","table":"public.compliance_audit_logs","columns":["data_classification","risk_score"]},{"name":"idx_compliance_audit_logs_retention_archive","def":"CREATE INDEX idx_compliance_audit_logs_retention_archive ON public.compliance_audit_logs USING btree (retention_category, archive_date)","table":"public.compliance_audit_logs","columns":["retention_category","archive_date"]}],"constraints":[{"name":"compliance_audit_logs_risk_score_check","type":"CHECK","def":"CHECK (((risk_score \u003e= 0) AND (risk_score \u003c= 100)))","table":"public.compliance_audit_logs","referenced_table":"","columns":["risk_score"]},{"name":"compliance_audit_logs_sensitivity_level_check","type":"CHECK","def":"CHECK (((sensitivity_level \u003e= 1) AND (sensitivity_level \u003c= 5)))","table":"public.compliance_audit_logs","referenced_table":"","columns":["sensitivity_level"]},{"name":"compliance_audit_logs_user_id_fkey","type":"FOREIGN KEY","def":"FOREIGN KEY (user_id) REFERENCES users(id)","table":"public.compliance_audit_logs","referenced_table":"users","columns":["user_id"],"referenced_columns":["id"]},{"name":"compliance_audit_logs_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.compliance_audit_logs","referenced_table":"","columns":["id"]}]},{"name":"public.compliance_violations","type":"BASE TABLE","columns":[{"name":"id","type":"uuid","nullable":false,"default":"gen_random_uuid()"},{"name":"created_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"updated_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"deleted_at","type":"timestamp with time zone","nullable":true},{"name":"audit_log_id","type":"uuid","nullable":false},{"name":"violation_type","type":"varchar(100)","nullable":false},{"name":"framework","type":"varchar(50)","nullable":true},{"name":"severity","type":"integer","nullable":false},{"name":"description","type":"varchar(1000)","nullable":true},{"name":"remediation","type":"varchar(1000)","nullable":true},{"name":"risk_score","type":"integer","nullable":true,"default":"0"},{"name":"status","type":"varchar(50)","nullable":true,"default":"'OPEN'::character varying"},{"name":"assigned_to","type":"varchar(100)","nullable":true},{"name":"resolved_at","type":"timestamp with time zone","nullable":true},{"name":"resolution","type":"varchar(1000)","nullable":true},{"name":"resolution_by","type":"varchar(100)","nullable":true}],"indexes":[{"name":"compliance_violations_pkey","def":"CREATE UNIQUE INDEX compliance_violations_pkey ON public.compliance_violations USING btree (id)","table":"public.compliance_violations","columns":["id"]},{"name":"idx_compliance_violations_audit_log_id","def":"CREATE INDEX idx_compliance_violations_audit_log_id ON public.compliance_violations USING btree (audit_log_id)","table":"public.compliance_violations","columns":["audit_log_id"]},{"name":"idx_compliance_violations_violation_type","def":"CREATE INDEX idx_compliance_violations_violation_type ON public.compliance_violations USING btree (violation_type)","table":"public.compliance_violations","columns":["violation_type"]},{"name":"idx_compliance_violations_framework","def":"CREATE INDEX idx_compliance_violations_framework ON public.compliance_violations USING btree (framework)","table":"public.compliance_violations","columns":["framework"]},{"name":"idx_compliance_violations_severity","def":"CREATE INDEX idx_compliance_violations_severity ON public.compliance_violations USING btree (severity)","table":"public.compliance_violations","columns":["severity"]},{"name":"idx_compliance_violations_status","def":"CREATE INDEX idx_compliance_violations_status ON public.compliance_violations USING btree (status)","table":"public.compliance_violations","columns":["status"]},{"name":"idx_compliance_violations_created_at","def":"CREATE INDEX idx_compliance_violations_created_at ON public.compliance_violations USING btree (created_at DESC)","table":"public.compliance_violations","columns":["created_at"]},{"name":"idx_compliance_violations_assigned_to","def":"CREATE INDEX idx_compliance_violations_assigned_to ON public.compliance_violations USING btree (assigned_to)","table":"public.compliance_violations","columns":["assigned_to"]},{"name":"idx_compliance_violations_resolved_at","def":"CREATE INDEX idx_compliance_violations_resolved_at ON public.compliance_violations USING btree (resolved_at DESC)","table":"public.compliance_violations","columns":["resolved_at"]},{"name":"idx_compliance_violations_framework_severity","def":"CREATE INDEX idx_compliance_violations_framework_severity ON public.compliance_violations USING btree (framework, severity DESC)","table":"public.compliance_violations","columns":["framework","severity"]},{"name":"idx_compliance_violations_status_created","def":"CREATE INDEX idx_compliance_violations_status_created ON public.compliance_violations USING btree (status, created_at DESC)","table":"public.compliance_violations","columns":["status","created_at"]}],"constraints":[{"name":"compliance_violations_risk_score_check","type":"CHECK","def":"CHECK (((risk_score \u003e= 0) AND (risk_score \u003c= 100)))","table":"public.compliance_violations","referenced_table":"","columns":["risk_score"]},{"name":"compliance_violations_severity_check","type":"CHECK","def":"CHECK (((severity \u003e= 1) AND (severity \u003c= 5)))","table":"public.compliance_violations","referenced_table":"","columns":["severity"]},{"name":"compliance_violations_status_check","type":"CHECK","def":"CHECK (((status)::text = ANY ((ARRAY['OPEN'::character varying, 'IN_PROGRESS'::character varying, 'RESOLVED'::character varying, 'ACCEPTED'::character varying])::text[])))","table":"public.compliance_violations","referenced_table":"","columns":["status"]},{"name":"compliance_violations_audit_log_id_fkey","type":"FOREIGN KEY","def":"FOREIGN KEY (audit_log_id) REFERENCES compliance_audit_logs(id) ON DELETE CASCADE","table":"public.compliance_violations","referenced_table":"compliance_audit_logs","columns":["audit_log_id"],"referenced_columns":["id"]},{"name":"compliance_violations_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.compliance_violations","referenced_table":"","columns":["id"]}]},{"name":"public.data_subject_requests","type":"BASE TABLE","columns":[{"name":"id","type":"uuid","nullable":false,"default":"gen_random_uuid()"},{"name":"created_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"updated_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"deleted_at","type":"timestamp with time zone","nullable":true},{"name":"request_type","type":"varchar(50)","nullable":false},{"name":"data_subject","type":"varchar(255)","nullable":false},{"name":"requestor_id","type":"varchar(100)","nullable":true},{"name":"email","type":"varchar(255)","nullable":true},{"name":"phone_number","type":"varchar(50)","nullable":true},{"name":"status","type":"varchar(50)","nullable":true,"default":"'RECEIVED'::character varying"},{"name":"priority","type":"varchar(20)","nullable":true,"default":"'NORMAL'::character varying"},{"name":"assigned_to","type":"varchar(100)","nullable":true},{"name":"due_date","type":"timestamp with time zone","nullable":true},{"name":"completed_at","type":"timestamp with time zone","nullable":true},{"name":"legal_basis","type":"varchar(100)","nullable":true},{"name":"identity_verified","type":"boolean","nullable":true,"default":"false"},{"name":"verification_method","type":"varchar(100)","nullable":true},{"name":"verified_by","type":"varchar(100)","nullable":true},{"name":"verified_at","type":"timestamp with time zone","nullable":true},{"name":"description","type":"varchar(2000)","nullable":true},{"name":"data_categories","type":"jsonb","nullable":true},{"name":"processing_purposes","type":"jsonb","nullable":true},{"name":"response","type":"text","nullable":true},{"name":"response_method","type":"varchar(50)","nullable":true},{"name":"rejection_reason","type":"varchar(1000)","nullable":true},{"name":"compliance_notes","type":"text","nullable":true},{"name":"reviewed_by","type":"varchar(100)","nullable":true},{"name":"reviewed_at","type":"timestamp with time zone","nullable":true}],"indexes":[{"name":"data_subject_requests_pkey","def":"CREATE UNIQUE INDEX data_subject_requests_pkey ON public.data_subject_requests USING btree (id)","table":"public.data_subject_requests","columns":["id"]},{"name":"idx_data_subject_requests_request_type","def":"CREATE INDEX idx_data_subject_requests_request_type ON public.data_subject_requests USING btree (request_type)","table":"public.data_subject_requests","columns":["request_type"]},{"name":"idx_data_subject_requests_data_subject","def":"CREATE INDEX idx_data_subject_requests_data_subject ON public.data_subject_requests USING btree (data_subject)","table":"public.data_subject_requests","columns":["data_subject"]},{"name":"idx_data_subject_requests_status","def":"CREATE INDEX idx_data_subject_requests_status ON public.data_subject_requests USING btree (status)","table":"public.data_subject_requests","columns":["status"]},{"name":"idx_data_subject_requests_priority","def":"CREATE INDEX idx_data_subject_requests_priority ON public.data_subject_requests USING btree (priority)","table":"public.data_subject_requests","columns":["priority"]},{"name":"idx_data_subject_requests_due_date","def":"CREATE INDEX idx_data_subject_requests_due_date ON public.data_subject_requests USING btree (due_date)","table":"public.data_subject_requests","columns":["due_date"]},{"name":"idx_data_subject_requests_created_at","def":"CREATE INDEX idx_data_subject_requests_created_at ON public.data_subject_requests USING btree (created_at DESC)","table":"public.data_subject_requests","columns":["created_at"]},{"name":"idx_data_subject_requests_assigned_to","def":"CREATE INDEX idx_data_subject_requests_assigned_to ON public.data_subject_requests USING btree (assigned_to)","table":"public.data_subject_requests","columns":["assigned_to"]},{"name":"idx_data_subject_requests_completed_at","def":"CREATE INDEX idx_data_subject_requests_completed_at ON public.data_subject_requests USING btree (completed_at DESC)","table":"public.data_subject_requests","columns":["completed_at"]},{"name":"idx_data_subject_requests_type_status","def":"CREATE INDEX idx_data_subject_requests_type_status ON public.data_subject_requests USING btree (request_type, status)","table":"public.data_subject_requests","columns":["request_type","status"]},{"name":"idx_data_subject_requests_status_due","def":"CREATE INDEX idx_data_subject_requests_status_due ON public.data_subject_requests USING btree (status, due_date)","table":"public.data_subject_requests","columns":["status","due_date"]}],"constraints":[{"name":"data_subject_requests_priority_check","type":"CHECK","def":"CHECK (((priority)::text = ANY ((ARRAY['LOW'::character varying, 'NORMAL'::character varying, 'HIGH'::character varying, 'URGENT'::character varying])::text[])))","table":"public.data_subject_requests","referenced_table":"","columns":["priority"]},{"name":"data_subject_requests_request_type_check","type":"CHECK","def":"CHECK (((request_type)::text = ANY ((ARRAY['ACCESS'::character varying, 'RECTIFICATION'::character varying, 'ERASURE'::character varying, 'RESTRICTION'::character varying, 'PORTABILITY'::character varying, 'OBJECTION'::character varying])::text[])))","table":"public.data_subject_requests","referenced_table":"","columns":["request_type"]},{"name":"data_subject_requests_response_method_check","type":"CHECK","def":"CHECK (((response_method)::text = ANY ((ARRAY['EMAIL'::character varying, 'POSTAL'::character varying, 'SECURE_PORTAL'::character varying])::text[])))","table":"public.data_subject_requests","referenced_table":"","columns":["response_method"]},{"name":"data_subject_requests_status_check","type":"CHECK","def":"CHECK (((status)::text = ANY ((ARRAY['RECEIVED'::character varying, 'VERIFIED'::character varying, 'PROCESSING'::character varying, 'COMPLETED'::character varying, 'REJECTED'::character varying])::text[])))","table":"public.data_subject_requests","referenced_table":"","columns":["status"]},{"name":"data_subject_requests_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.data_subject_requests","referenced_table":"","columns":["id"]}]},{"name":"public.consent_records","type":"BASE TABLE","columns":[{"name":"id","type":"uuid","nullable":false,"default":"gen_random_uuid()"},{"name":"created_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"updated_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"deleted_at","type":"timestamp with time zone","nullable":true},{"name":"data_subject","type":"varchar(255)","nullable":false},{"name":"user_id","type":"uuid","nullable":true},{"name":"consent_type","type":"varchar(100)","nullable":false},{"name":"purpose","type":"varchar(500)","nullable":false},{"name":"legal_basis","type":"varchar(100)","nullable":true},{"name":"data_categories","type":"jsonb","nullable":true},{"name":"status","type":"varchar(50)","nullable":false},{"name":"consent_given","type":"boolean","nullable":false},{"name":"consent_date","type":"timestamp with time zone","nullable":false},{"name":"withdrawn_date","type":"timestamp with time zone","nullable":true},{"name":"expiry_date","type":"timestamp with time zone","nullable":true},{"name":"consent_method","type":"varchar(100)","nullable":true},{"name":"consent_text","type":"text","nullable":true},{"name":"consent_version","type":"varchar(20)","nullable":true},{"name":"ip_address","type":"varchar(45)","nullable":true},{"name":"user_agent","type":"varchar(500)","nullable":true},{"name":"consent_proof","type":"jsonb","nullable":true},{"name":"withdrawal_method","type":"varchar(100)","nullable":true},{"name":"withdrawal_reason","type":"varchar(500)","nullable":true}],"indexes":[{"name":"consent_records_pkey","def":"CREATE UNIQUE INDEX consent_records_pkey ON public.consent_records USING btree (id)","table":"public.consent_records","columns":["id"]},{"name":"idx_consent_records_data_subject","def":"CREATE INDEX idx_consent_records_data_subject ON public.consent_records USING btree (data_subject)","table":"public.consent_records","columns":["data_subject"]},{"name":"idx_consent_records_user_id","def":"CREATE INDEX idx_consent_records_user_id ON public.consent_records USING btree (user_id)","table":"public.consent_records","columns":["user_id"]},{"name":"idx_consent_records_consent_type","def":"CREATE INDEX idx_consent_records_consent_type ON public.consent_records USING btree (consent_type)","table":"public.consent_records","columns":["consent_type"]},{"name":"idx_consent_records_status","def":"CREATE INDEX idx_consent_records_status ON public.consent_records USING btree (status)","table":"public.consent_records","columns":["status"]},{"name":"idx_consent_records_consent_given","def":"CREATE INDEX idx_consent_records_consent_given ON public.consent_records USING btree (consent_given)","table":"public.consent_records","columns":["consent_given"]},{"name":"idx_consent_records_consent_date","def":"CREATE INDEX idx_consent_records_consent_date ON public.consent_records USING btree (consent_date DESC)","table":"public.consent_records","columns":["consent_date"]},{"name":"idx_consent_records_withdrawn_date","def":"CREATE INDEX idx_consent_records_withdrawn_date ON public.consent_records USING btree (withdrawn_date DESC)","table":"public.consent_records","columns":["withdrawn_date"]},{"name":"idx_consent_records_expiry_date","def":"CREATE INDEX idx_consent_records_expiry_date ON public.consent_records USING btree (expiry_date)","table":"public.consent_records","columns":["expiry_date"]},{"name":"idx_consent_records_subject_type","def":"CREATE INDEX idx_consent_records_subject_type ON public.consent_records USING btree (data_subject, consent_type)","table":"public.consent_records","columns":["data_subject","consent_type"]},{"name":"idx_consent_records_status_date","def":"CREATE INDEX idx_consent_records_status_date ON public.consent_records USING btree (status, consent_date DESC)","table":"public.consent_records","columns":["status","consent_date"]}],"constraints":[{"name":"consent_records_status_check","type":"CHECK","def":"CHECK (((status)::text = ANY ((ARRAY['GIVEN'::character varying, 'WITHDRAWN'::character varying, 'EXPIRED'::character varying])::text[])))","table":"public.consent_records","referenced_table":"","columns":["status"]},{"name":"consent_records_user_id_fkey","type":"FOREIGN KEY","def":"FOREIGN KEY (user_id) REFERENCES users(id)","table":"public.consent_records","referenced_table":"users","columns":["user_id"],"referenced_columns":["id"]},{"name":"consent_records_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.consent_records","referenced_table":"","columns":["id"]}]},{"name":"public.retention_policies","type":"BASE TABLE","columns":[{"name":"id","type":"bigint","nullable":false,"default":"nextval('retention_policies_id_seq'::regclass)"},{"name":"created_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"updated_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"deleted_at","type":"timestamp with time zone","nullable":true},{"name":"name","type":"varchar(100)","nullable":false},{"name":"description","type":"varchar(500)","nullable":true},{"name":"category","type":"varchar(50)","nullable":false},{"name":"retention_period","type":"integer","nullable":false},{"name":"retention_unit","type":"varchar(10)","nullable":true,"default":"'DAYS'::character varying"},{"name":"archive_period","type":"integer","nullable":true},{"name":"data_classification","type":"varchar(50)","nullable":true},{"name":"compliance_framework","type":"varchar(50)","nullable":true},{"name":"legal_basis","type":"varchar(100)","nullable":true},{"name":"is_active","type":"boolean","nullable":true,"default":"true"},{"name":"effective_date","type":"timestamp with time zone","nullable":false},{"name":"expiry_date","type":"timestamp with time zone","nullable":true},{"name":"approved_by","type":"varchar(100)","nullable":true},{"name":"approved_at","type":"timestamp with time zone","nullable":true},{"name":"review_date","type":"timestamp with time zone","nullable":true},{"name":"reviewed_by","type":"varchar(100)","nullable":true},{"name":"rules","type":"jsonb","nullable":true},{"name":"exceptions","type":"jsonb","nullable":true},{"name":"automation_rules","type":"jsonb","nullable":true}],"indexes":[{"name":"retention_policies_pkey","def":"CREATE UNIQUE INDEX retention_policies_pkey ON public.retention_policies USING btree (id)","table":"public.retention_policies","columns":["id"]},{"name":"retention_policies_name_key","def":"CREATE UNIQUE INDEX retention_policies_name_key ON public.retention_policies USING btree (name)","table":"public.retention_policies","columns":["name"]},{"name":"idx_retention_policies_name","def":"CREATE INDEX idx_retention_policies_name ON public.retention_policies USING btree (name)","table":"public.retention_policies","columns":["name"]},{"name":"idx_retention_policies_category","def":"CREATE INDEX idx_retention_policies_category ON public.retention_policies USING btree (category)","table":"public.retention_policies","columns":["category"]},{"name":"idx_retention_policies_data_classification","def":"CREATE INDEX idx_retention_policies_data_classification ON public.retention_policies USING btree (data_classification)","table":"public.retention_policies","columns":["data_classification"]},{"name":"idx_retention_policies_compliance_framework","def":"CREATE INDEX idx_retention_policies_compliance_framework ON public.retention_policies USING btree (compliance_framework)","table":"public.retention_policies","columns":["compliance_framework"]},{"name":"idx_retention_policies_is_active","def":"CREATE INDEX idx_retention_policies_is_active ON public.retention_policies USING btree (is_active)","table":"public.retention_policies","columns":["is_active"]},{"name":"idx_retention_policies_effective_date","def":"CREATE INDEX idx_retention_policies_effective_date ON public.retention_policies USING btree (effective_date)","table":"public.retention_policies","columns":["effective_date"]},{"name":"idx_retention_policies_review_date","def":"CREATE INDEX idx_retention_policies_review_date ON public.retention_policies USING btree (review_date)","table":"public.retention_policies","columns":["review_date"]}],"constraints":[{"name":"retention_policies_retention_unit_check","type":"CHECK","def":"CHECK (((retention_unit)::text = ANY ((ARRAY['DAYS'::character varying, 'MONTHS'::character varying, 'YEARS'::character varying])::text[])))","table":"public.retention_policies","referenced_table":"","columns":["retention_unit"]},{"name":"retention_policies_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.retention_policies","referenced_table":"","columns":["id"]},{"name":"retention_policies_name_key","type":"UNIQUE","def":"UNIQUE (name)","table":"public.retention_policies","referenced_table":"","columns":["name"]}]},{"name":"public.compliance_reports","type":"BASE TABLE","columns":[{"name":"id","type":"uuid","nullable":false,"default":"gen_random_uuid()"},{"name":"created_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"updated_at","type":"timestamp with time zone","nullable":true,"default":"CURRENT_TIMESTAMP"},{"name":"deleted_at","type":"timestamp with time zone","nullable":true},{"name":"report_type","type":"varchar(100)","nullable":false},{"name":"title","type":"varchar(200)","nullable":false},{"name":"description","type":"varchar(1000)","nullable":true},{"name":"framework","type":"varchar(50)","nullable":true},{"name":"period_start","type":"timestamp with time zone","nullable":false},{"name":"period_end","type":"timestamp with time zone","nullable":false},{"name":"generated_by","type":"varchar(100)","nullable":true},{"name":"generated_at","type":"timestamp with time zone","nullable":false},{"name":"status","type":"varchar(50)","nullable":true,"default":"'DRAFT'::character varying"},{"name":"executive_summary","type":"text","nullable":true},{"name":"findings","type":"jsonb","nullable":true},{"name":"recommendations","type":"jsonb","nullable":true},{"name":"metrics","type":"jsonb","nullable":true},{"name":"version","type":"varchar(20)","nullable":true},{"name":"confidentiality","type":"varchar(50)","nullable":true,"default":"'INTERNAL'::character varying"},{"name":"approved_by","type":"varchar(100)","nullable":true},{"name":"approved_at","type":"timestamp with time zone","nullable":true},{"name":"published_at","type":"timestamp with time zone","nullable":true},{"name":"distribution","type":"jsonb","nullable":true}],"indexes":[{"name":"compliance_reports_pkey","def":"CREATE UNIQUE INDEX compliance_reports_pkey ON public.compliance_reports USING btree (id)","table":"public.compliance_reports","columns":["id"]},{"name":"idx_compliance_reports_report_type","def":"CREATE INDEX idx_compliance_reports_report_type ON public.compliance_reports USING btree (report_type)","table":"public.compliance_reports","columns":["report_type"]},{"name":"idx_compliance_reports_framework","def":"CREATE INDEX idx_compliance_reports_framework ON public.compliance_reports USING btree (framework)","table":"public.compliance_reports","columns":["framework"]},{"name":"idx_compliance_reports_status","def":"CREATE INDEX idx_compliance_reports_status ON public.compliance_reports USING btree (status)","table":"public.compliance_reports","columns":["status"]},{"name":"idx_compliance_reports_period_start","def":"CREATE INDEX idx_compliance_reports_period_start ON public.compliance_reports USING btree (period_start DESC)","table":"public.compliance_reports","columns":["period_start"]},{"name":"idx_compliance_reports_generated_at","def":"CREATE INDEX idx_compliance_reports_generated_at ON public.compliance_reports USING btree (generated_at DESC)","table":"public.compliance_reports","columns":["generated_at"]},{"name":"idx_compliance_reports_generated_by","def":"CREATE INDEX idx_compliance_reports_generated_by ON public.compliance_reports USING btree (generated_by)","table":"public.compliance_reports","columns":["generated_by"]},{"name":"idx_compliance_reports_type_period","def":"CREATE INDEX idx_compliance_reports_type_period ON public.compliance_reports USING btree (report_type, period_start DESC)","table":"public.compliance_reports","columns":["report_type","period_start"]},{"name":"idx_compliance_reports_framework_period","def":"CREATE INDEX idx_compliance_reports_framework_period ON public.compliance_reports USING btree (framework, period_start DESC)","table":"public.compliance_reports","columns":["framework","period_start"]}],"constraints":[{"name":"compliance_reports_status_check","type":"CHECK","def":"CHECK (((status)::text = ANY ((ARRAY['DRAFT'::character varying, 'FINAL'::character varying, 'PUBLISHED'::character varying])::text[])))","table":"public.compliance_reports","referenced_table":"","columns":["status"]},{"name":"compliance_reports_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.compliance_reports","referenced_table":"","columns":["id"]}]},{"name":"public.casbin_rule","type":"BASE TABLE","columns":[{"name":"id","type":"bigint","nullable":false,"default":"nextval('casbin_rule_id_seq'::regclass)"},{"name":"ptype","type":"varchar(100)","nullable":true},{"name":"v0","type":"varchar(100)","nullable":true},{"name":"v1","type":"varchar(100)","nullable":true},{"name":"v2","type":"varchar(100)","nullable":true},{"name":"v3","type":"varchar(100)","nullable":true},{"name":"v4","type":"varchar(100)","nullable":true},{"name":"v5","type":"varchar(100)","nullable":true}],"indexes":[{"name":"casbin_rule_pkey","def":"CREATE UNIQUE INDEX casbin_rule_pkey ON public.casbin_rule USING btree (id)","table":"public.casbin_rule","columns":["id"]},{"name":"idx_casbin_rule","def":"CREATE UNIQUE INDEX idx_casbin_rule ON public.casbin_rule USING btree (ptype, v0, v1, v2, v3, v4, v5)","table":"public.casbin_rule","columns":["ptype","v0","v1","v2","v3","v4","v5"]}],"constraints":[{"name":"casbin_rule_pkey","type":"PRIMARY KEY","def":"PRIMARY KEY (id)","table":"public.casbin_rule","referenced_table":"","columns":["id"]}]}],"relations":[{"table":"public.user_roles","columns":["role_id"],"cardinality":"zero_or_more","parent_table":"public.roles","parent_columns":["id"],"parent_cardinality":"exactly_one","def":"FOREIGN KEY (role_id) REFERENCES roles(id) ON DELETE CASCADE"},{"table":"public.role_permissions","columns":["role_id"],"cardinality":"zero_or_more","parent_table":"public.roles","parent_columns":["id"],"parent_cardinality":"exactly_one","def":"FOREIGN KEY (role_id) REFERENCES roles(id) ON DELETE CASCADE"},{"table":"public.role_permissions","columns":["permission_id"],"cardinality":"zero_or_more","parent_table":"public.permissions","parent_columns":["id"],"parent_cardinality":"exactly_one","def":"FOREIGN KEY (permission_id) REFERENCES permissions(id) ON DELETE CASCADE"},{"table":"public.device_attestations","columns":["user_id"],"cardinality":"zero_or_more","parent_table":"public.users","parent_columns":["id"],"parent_cardinality":"exactly_one","def":"FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE"},{"table":"public.compliance_audit_logs","columns":["user_id"],"cardinality":"zero_or_more","parent_table":"public.users","parent_columns":["id"],"parent_cardinality":"zero_or_one","def":"FOREIGN KEY (user_id) REFERENCES users(id)"},{"table":"public.compliance_violations","columns":["audit_log_id"],"cardinality":"zero_or_more","parent_table":"public.compliance_audit_logs","parent_columns":["id"],"parent_cardinality":"exactly_one","def":"FOREIGN KEY (audit_log_id) REFERENCES compliance_audit_logs(id) ON DELETE CASCADE"},{"table":"public.consent_records","columns":["user_id"],"cardinality":"zero_or_more","parent_table":"public.users","parent_columns":["id"],"parent_cardinality":"zero_or_one","def":"FOREIGN KEY (user_id) REFERENCES users(id)"}],"driver":{"name":"postgres","database_version":"PostgreSQL 15.13 on x86_64-pc-linux-musl, compiled by gcc (Alpine 14.2.0) 14.2.0, 64-bit","meta":{"current_schema":"public","search_paths":["mvp_user","public"],"dict":{"Functions":"Stored procedures and functions"}}}}
