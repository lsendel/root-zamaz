# Claude AI Assistant Context & Approach

> **Last Updated**: 2025-06-20  
> **Project**: Zamaz Zero Trust Platform  
> **Repository**: https://github.com/lsendel/root-zamaz  

## ðŸŽ¯ **Current Project Approach**

### **Documentation Integration Strategy**

**Problem Solved**: Actions can't access database, but we need both manual docs and automated schema docs.

**Solution**: **Hybrid Two-Tier Documentation System**

```
ðŸ“š Tier 1: Manual Documentation (Always Available)
â”œâ”€â”€ docs/manual/           # Hand-written guides, architecture, policies
â”œâ”€â”€ docs/development/      # Dev guides, setup, contributing  
â”œâ”€â”€ docs/security/         # Security policies, threat models
â”œâ”€â”€ docs/architecture/     # System design, zero-trust implementation
â””â”€â”€ docs/api/             # API documentation and guides

ðŸ”„ Tier 2: Automated Schema Documentation (Local Only)
â”œâ”€â”€ docs/schema/          # Generated by tbls when DB available
â”œâ”€â”€ Domain-driven models  # auth-domain.md, security-domain.md
â”œâ”€â”€ Mermaid ERDs         # Database relationship diagrams
â””â”€â”€ Table documentation  # Individual table docs

ðŸ“– Tier 3: Combined Output (Deployment Ready)
â””â”€â”€ docs/combined/       # Merged manual + schema for deployment
```

### **Wiki Integration Safety**

- **Target**: `https://github.com/lsendel/root-zamaz/wiki/Documentation/` (subdirectory only)
- **Safety**: Never affects main wiki root or other sections
- **Scope**: Only Documentation subdirectory is modified
- **Protection**: Main wiki pages preserved

## ðŸ›  **Make Targets Implemented**

### **Core Documentation**
```bash
make docs-manual           # Generate manual docs (always works)
make docs-schema          # Generate schema docs (needs DB)
make docs-schema-optional # Try schema, skip if DB unavailable
make docs-combined        # Merge manual + schema when available
```

### **Wiki Integration**
```bash
make docs-wiki-preview    # Safe preview of what would sync
make docs-wiki-sync-safe  # Sync to /Documentation/ subdirectory only
make docs-deploy          # Complete pipeline: manualâ†’schemaâ†’combinedâ†’wiki
```

### **Legacy Targets (Updated)**
```bash
make docs                 # Now uses hybrid approach
make docs-ci              # CI-friendly (manual only)
make docs-full            # Complete workflow with wiki
```

## ðŸ”§ **Technical Implementation**

### **Key Scripts**
- `scripts/sync-wiki-safe.sh` - Safe wiki sync (subdirectory only)
- `scripts/docs-generate.sh` - Manual documentation generation
- `docs/manual/README.md` - Index of always-available docs

### **Safety Features**
1. **Database Independence**: Manual docs work without DB
2. **Wiki Safety**: Only affects `/Documentation/` subdirectory  
3. **Graceful Degradation**: Schema docs optional, manual docs always work
4. **CI/CD Friendly**: Actions can deploy manual docs, local dev adds schema

### **File Structure**
```
docs/
â”œâ”€â”€ manual/              # Always available content
â”‚   â””â”€â”€ README.md       # Index of manual documentation
â”œâ”€â”€ schema/             # Generated content (DB required)
â”‚   â”œâ”€â”€ README.md       # Schema overview
â”‚   â”œâ”€â”€ *-domain.md    # Domain-driven schema docs
â”‚   â””â”€â”€ *.md           # Individual table docs
â”œâ”€â”€ combined/           # Deployment-ready merged content
â”œâ”€â”€ development/        # Development guides
â”œâ”€â”€ security/          # Security documentation
â”œâ”€â”€ architecture/      # Architecture documentation
â””â”€â”€ api/               # API documentation
```

## ðŸ“‹ **Workflow Best Practices**

### **For Actions/CI**
```bash
make docs-ci              # Generate manual docs only
make docs-deploy          # Deploy what's available (graceful)
```

### **For Local Development**
```bash
make docs                 # Full pipeline with schema if DB available
make docs-schema          # Generate schema docs explicitly
make docs-combined        # Create deployment package
```

### **For Wiki Management**
```bash
make docs-wiki-preview    # Always check what will be synced
export GITHUB_TOKEN=xxx   # Set authentication
make docs-wiki-sync-safe  # Perform safe sync
```

## ðŸš¨ **Critical Safety Rules**

1. **Wiki Scope**: ONLY affect `https://github.com/lsendel/root-zamaz/wiki/Documentation/`
2. **Database Dependency**: Never fail builds due to missing DB
3. **Graceful Degradation**: Always provide useful docs even without schema
4. **Version Control**: All manual docs in git, generated docs optional
5. **URL Verification**: **NEVER ask user to check URLs without verifying them first**
   - Always test URLs before suggesting them to user
   - Verify local servers are actually running before providing links
   - Check API endpoints work before referencing them
   - Test file paths exist before suggesting access methods

## ðŸŽ¯ **Project Context**

### **What This Project Is**
- Zero Trust security platform
- Go backend with PostgreSQL
- React frontend
- Kubernetes deployment
- GitOps workflows
- Comprehensive security scanning

### **Key Technologies**
- **Backend**: Go (Fiber framework)
- **Database**: PostgreSQL with domain-driven design
- **Frontend**: React SPA
- **Deployment**: Kubernetes + Istio service mesh
- **CI/CD**: GitHub Actions with security scanning
- **Documentation**: MkDocs + tbls + Mermaid

### **Security Focus**
- Device attestation and zero trust
- SPIRE integration for identity
- Comprehensive audit logging
- GDPR compliance features
- Threat detection and monitoring

## ðŸ“ˆ **Success Metrics**

- âœ… Actions can deploy documentation without database
- âœ… Local development includes comprehensive schema docs  
- âœ… Wiki integration is safe and scoped
- âœ… Documentation always builds successfully
- âœ… Schema documentation includes Mermaid diagrams
- âœ… Domain-driven organization improves usability

---

**Note for Claude**: This approach balances automation with reliability. Always check this file for context about the documentation strategy and safety requirements. The user values this hybrid approach because it ensures documentation is always available while adding rich schema content when possible.